  `----------------------------------------------------  `User name (OS): Charles Miller  `Date and time: 07/30/13, 13:09:13  `----------------------------------------------------  `Method: Clone_UpdateRecords  `Description  `  ` Parameters  ` ----------------------------------------------------If (False)Mods_2013_07   `r001 `   `Modified by: Charles Miller (7/30/13 13:25:31)  `ARRAY TEXT(clone_TablesWithUniqueKey_atxt;0)  `ARRAY POINTER(clone_UniqueKeys_aptr;0)  `ARRAY POINTER(clone_Array_aptr;0)  `ARRAY POINTER(clone_Table_aPtr;0)Mods_2013_09   `r001 `  Changes in cloning to use arrays whenever possible  `Modified by: Charles Miller (9/10/13 13:04:49)Mods_2013_12   `r002 ` Fix problems in clone with blobs  `Modified by: Charles Miller (12/3/13 17:09:21)End if C_TEXT($1)C_LONGINT($Position_L;$Loop_L)C_POINTER($Table_ptr;$Field_ptr;$Array_ptr)C_BOOLEAN($HasPictureOrBlob_b)$HasPictureOrBlob_b:=FalseIf (Count parameters=2)C_BOOLEAN($2)$HasPictureOrBlob_b:=$2End if $Position_L:=Find in array(clone_TablesWithUniqueKey_atxt;$1)If ($Position_L>0)$Table_ptr:=clone_Table_aPtr{$Position_L}$Field_ptr:=clone_UniqueKeys_aptr{$Position_L}$Array_ptr:=clone_Array_aptr{$Position_L}For ($Loop_L;1;Size of array($Array_ptr->))QUERY($Table_ptr->;$Field_ptr->=$Array_ptr->{$Loop_L})If (Records in selection($Table_ptr->)=0)CREATE RECORD($Table_ptr->)End if If (ut_LoadRecord ($Table_ptr;100))clone_UpdateLocalTable (Table($Table_ptr);$Loop_L)SAVE RECORD($Table_ptr->)UNLOAD RECORD($Table_ptr->)End if End for If ($HasPictureOrBlob_b)ut_GetBlobs (Table($Table_ptr))End if If (Size of array($Array_Ptr->)<SQL_Limit_L) | (Offset_l>=Count_l)Offset_l:=Count_lElse Offset_l:=Offset_l+SQL_Limit_LEnd if End if   `End Clone_UpdateRecords