ÊÊ` ----------------------------------------------------ÊÊ` Method: PERS_GetInfoÊÊ` Description :ÊÊ`ÊÊ` Get info about a person return it in a variable passed as a pointer in pairs of "INFO" ; VarPtr.ÊÊ`ÊÊ` Usage :ÊÊ`ÊÊ` PERS_GetInfo( PID; "EMAIL";->$EmailVar_txt; "EMPLOYER"; ->$EmplVar_txt)ÊÊ` ÊÊ` ParametersÊÊ` $1 : $PersID_LÊÊ` $2 : $Type1_txt ("EMAI:" | "EMPLOYER" | "FIRSTLAST" | "FULLNAME" ÊÊ` $3 : $Var1_ptrÊÊ` $4 : $Type2_txtÊÊ` $5 : $Var2_ptrÊÊ` etc...ÊÊ` ----------------------------------------------------If (False)ÊÊ` ----------------------------------------------------ÊÊ` User name (OS): costasmanousakisÊÊ` User name (4D): DesignerÊÊ` Date and time: 12/05/11, 09:53:37ÊÊ` First ReleaseMods_2011_12 Mods_2012_01 ÊÊ`Modified by: Kenny Yang-(Designer) `01/26/12, 17:11:59   `\ÊÊ`update VdiveMaster for the Flood damage formEnd if C_LONGINT($1;$PersID_L)$PersID_L:=$1C_BOOLEAN($OK_b)$OK_b:=TrueARRAY TEXT($Tasks_atxt;0)ARRAY POINTER($VarPtrs_aptr;0)If (Count parameters>=3)C_TEXT($2)C_POINTER($3)APPEND TO ARRAY($Tasks_atxt;$2)APPEND TO ARRAY($VarPtrs_aptr;$3)End if If (Count parameters>=5)C_TEXT($4)C_POINTER($5)APPEND TO ARRAY($Tasks_atxt;$4)APPEND TO ARRAY($VarPtrs_aptr;$5)End if If (Count parameters>=7)C_TEXT($6)C_POINTER($7)APPEND TO ARRAY($Tasks_atxt;$6)APPEND TO ARRAY($VarPtrs_aptr;$7)End if If (Count parameters>=9)C_TEXT($8)C_POINTER($9)APPEND TO ARRAY($Tasks_atxt;$8)APPEND TO ARRAY($VarPtrs_aptr;$9)End if If (Count parameters>=11)C_TEXT($10)C_POINTER($11)APPEND TO ARRAY($Tasks_atxt;$10)APPEND TO ARRAY($VarPtrs_aptr;$11)End if If (Count parameters>=13)C_TEXT($12)C_POINTER($13)APPEND TO ARRAY($Tasks_atxt;$12)APPEND TO ARRAY($VarPtrs_aptr;$13)End if If (Count parameters>=15)C_TEXT($14)C_POINTER($15)APPEND TO ARRAY($Tasks_atxt;$14)APPEND TO ARRAY($VarPtrs_aptr;$15)End if C_LONGINT($numPairs_L;$Loop_L)$numPairs_L:=(Count parameters-1)/2C_BOOLEAN($PersRO_b)$PersRO_b:=Read only state([Personnel])If (Not($PersRO_b))READ ONLY([Personnel])End if QUERY([Personnel];[Personnel]Person ID=$PersID_L)If (Records in selection([Personnel])=1)C_TEXT($Info_txt)C_POINTER($Var_ptr)C_LONGINT($TxtCount_L;$PtrCount_L)For ($Loop_L;1;$numPairs_L)$TxtCount_L:=(2*$Loop_L-1)$PtrCount_L:=(1+(2*$Loop_L))$Info_txt:=$Tasks_atxt{$Loop_L}$Var_ptr:=$VarPtrs_aptr{$Loop_L}Case of : ($Info_txt="EMAIL")$Var_ptr->:=[Personnel]EmailAddress_s: ($Info_txt="EMPLOYER")$Var_ptr->:=[Personnel]Employer: ($Info_txt="FIRSTLAST")$Var_ptr->:=[Personnel]First Name+" "+[Personnel]Last Name: ($Info_txt="FULLNAME")If ([Personnel]Middle Name#"")$Var_ptr->:=[Personnel]First Name+" "+[Personnel]Middle Name+" "+[Personnel]Last NameElse $Var_ptr->:=[Personnel]First Name+" "+[Personnel]Last NameEnd if If ([Personnel]Suffix#"")$Var_ptr->:=$Var_ptr->+[Personnel]SuffixEnd if : ($Info_txt="PHONE")$Var_ptr->:=[Personnel]Phone_s: ($Info_txt="CELL")$Var_ptr->:=[Personnel]CellPhone_s: ($Info_txt="INITIAL")If ([Personnel]Middle Name#"")$Var_ptr->:=Substring([Personnel]First Name;1;1)+Substring([Personnel]Middle Name;1;1)+Substring([Personnel]Last Name;1;1)Else $Var_ptr->:=Substring([Personnel]First Name;1;1)+Substring([Personnel]Last Name;1;1)End if : ($Info_txt="FILASTNAME")$Var_ptr->:=Substring([Personnel]First Name;1;1)+". "+[Personnel]Last Name: ($Info_txt="LASTNAMEFI")$Var_ptr->:=[Personnel]Last Name+" "+Substring([Personnel]First Name;1;1)+". "End case End for End if If (Not($PersRO_b))READ WRITE([Personnel])End if 