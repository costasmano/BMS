  `Method: INSP_CheckTunnelSpcFreq  `Description  `  ` Parameters  ` ----------------------------------------------------If (False)  ` ----------------------------------------------------  `User name (OS): Costas Manousakis  `User (4D) : Designer  `Date and time: 09/26/13, 16:11:29  ` ----------------------------------------------------  `Created : Mods_2013_09 End if   `C_LONGINT($Numeq4_L;$numLT4_L;$NumOtherEQ4_L;$NumOtherLT4_L)GET AUTOMATIC RELATIONS($one_b;$many_b)SET AUTOMATIC RELATIONS(True;True)ARRAY TEXT($cat_atxt;0)ARRAY LONGINT($countsEq4_aL;0)ARRAY LONGINT($countsLT4_aL;0)C_BOOLEAN($Freq_3_b;$Freq_6_b;$Freq_12_b)$Freq_3_b:=False$Freq_6_b:=False$Freq_12_b:=FalseC_TEXT($Freq_3_txt;$Freq_6_txt;$Freq_12_txt)C_BOOLEAN($elmsftyRO_b)$elmsftyRO_b:=Read only state([ElementsSafety])READ ONLY([ElementsSafety])INSP_LoadElmLabelsforReport ([Inspections]Insp Type)APPEND TO ARRAY($cat_atxt;"STR")APPEND TO ARRAY($cat_atxt;"ROA")APPEND TO ARRAY($cat_atxt;"CEI")APPEND TO ARRAY($cat_atxt;"SUP")APPEND TO ARRAY($cat_atxt;"CRO")APPEND TO ARRAY($cat_atxt;"EGR")APPEND TO ARRAY($cat_atxt;"UTI")ARRAY LONGINT($countsEq4_aL;Size of array($cat_atxt))ARRAY LONGINT($countsLT4_aL;Size of array($cat_atxt))ARRAY LONGINT($elmNo_aL;0)ARRAY STRING(2;$elmRtg_as;0)ARRAY TEXT($elmDesc_atxt;0)C_LONGINT($loop_L)C_LONGINT($loop2_L)For ($loop_L;1;Size of array($cat_atxt))SET QUERY DESTINATION(Into set ;"$ELMEQ4")QUERY SELECTION([ElementsSafety];[ElementDict]Category=$cat_atxt{$loop_L};*)QUERY SELECTION([ElementsSafety]; & ;[ElementsSafety]Rating="4")SET QUERY DESTINATION(Into current selection )SET QUERY DESTINATION(Into set ;"$ELMLT4")QUERY SELECTION([ElementsSafety];[ElementsSafety]Rating="0";*)QUERY SELECTION([ElementsSafety]; | ;[ElementsSafety]Rating="1";*)QUERY SELECTION([ElementsSafety]; | ;[ElementsSafety]Rating="2";*)QUERY SELECTION([ElementsSafety]; | ;[ElementsSafety]Rating="3";*)QUERY SELECTION([ElementsSafety]; & ;[ElementDict]Category=$cat_atxt{$loop_L})SET QUERY DESTINATION(Into current selection )$countsEq4_aL{$loop_L}:=$Numeq4_L$countsLT4_aL{$loop_L}:=$numLT4_L$numLT4_L:=Records in set("$ELMLT4")$Numeq4_L:=Records in set("$ELMEQ4")C_TEXT($catName_txt)$catName_txt:=Get_Description (->◊ALLElmtCatDesc_as;->◊ALLElmtCatCode_as;->$cat_atxt{$loop_L})If ($cat_atxt{$loop_L}="CEI")  `more critical$numLT4_L:=If ($numLT4_L>0)$Freq_3_txt:=String($numLT4_L)+" "+$catName_txt+" Items less than 4"+Char(13)USE SET("$ELMLT4")SELECTION TO ARRAY([ElementsSafety]ElementNo;$elmNo_aL;[ElementsSafety]Rating;$elmRtg_as;[ElementsSafety]Description;$elmDesc_atxt)For ($loop2_L;1;Size of array($elmNo_aL))$Freq_3_txt:=$Freq_3_txt+"  -  "+Get_Description (->INSP_NewElementLabels_atxt;->INSP_NewElementNumbers_ai;->$elmNo_aL{$loop2_L})$Freq_3_txt:=$Freq_3_txt+" "+$elmDesc_atxt{$loop2_L}+" : "+$elmRtg_as{$loop2_L}+Char(13)End for $Freq_3_b:=TrueEnd if If ($Numeq4_L>0)$Freq_6_txt:=$Freq_6_txt+String($Numeq4_L)+" "+$catName_txt+" Items Equal to 4"+Char(13)USE SET("$ELMEQ4")SELECTION TO ARRAY([ElementsSafety]ElementNo;$elmNo_aL;[ElementsSafety]Rating;$elmRtg_as;[ElementsSafety]Description;$elmDesc_atxt)For ($loop2_L;1;Size of array($elmNo_aL))$Freq_6_txt:=$Freq_6_txt+"  -  "+Get_Description (->INSP_NewElementLabels_atxt;->INSP_NewElementNumbers_ai;->$elmNo_aL{$loop2_L})$Freq_6_txt:=$Freq_6_txt+" "+$elmDesc_atxt{$loop2_L}+" : "+$elmRtg_as{$loop2_L}+Char(13)End for $Freq_6_b:=TrueEnd if Else If ($numLT4_L>0)$Freq_6_txt:=String($numLT4_L)+" "+$catName_txt+" Items less than 4"USE SET("$ELMLT4")SELECTION TO ARRAY([ElementsSafety]ElementNo;$elmNo_aL;[ElementsSafety]Rating;$elmRtg_as;[ElementsSafety]Description;$elmDesc_atxt)For ($loop2_L;1;Size of array($elmNo_aL))$Freq_6_txt:=$Freq_6_txt+"  -  "+Get_Description (->INSP_NewElementLabels_atxt;->INSP_NewElementNumbers_ai;->$elmNo_aL{$loop2_L})$Freq_6_txt:=$Freq_6_txt+" "+$elmDesc_atxt{$loop2_L}+" : "+$elmRtg_as{$loop2_L}+Char(13)End for $Freq_6_b:=TrueEnd if If ($Numeq4_L>0)$Freq_12_txt:=$Freq_6_txt+String($Numeq4_L)+" "+$catName_txt+" Items Equal to 4"+Char(13)USE SET("$ELMEQ4")SELECTION TO ARRAY([ElementsSafety]ElementNo;$elmNo_aL;[ElementsSafety]Rating;$elmRtg_as;[ElementsSafety]Description;$elmDesc_atxt)For ($loop2_L;1;Size of array($elmNo_aL))$Freq_12_txt:=$Freq_12_txt+"  -  "+Get_Description (->INSP_NewElementLabels_atxt;->INSP_NewElementNumbers_ai;->$elmNo_aL{$loop2_L})$Freq_12_txt:=$Freq_12_txt+" "+$elmDesc_atxt{$loop2_L}+" : "+$elmRtg_as{$loop2_L}+Char(13)End for $Freq_12_b:=TrueEnd if End if CLEAR SET("$ELMLT4")CLEAR SET("$ELMEQ4")End for   ```  NOW WHAT?????  `load tunnelinfo record  `get frequencies for special inspections  `  `[TunnelInfo]SpecialInsp1Freq_i  `  `[TunnelInfo]SpecialInsp2Freq_i  `  `[TunnelInfo]SpecialInsp3Freq_i  `if we need a 3 mo $Freq_3_b=true is there a spec w / 3 mon?  `  `yes ->ok  `  `no -> need to add one  `if we need a 6 mo $Freq_3_b=true is there a spec w / 6 mon?  `  `yes ->ok  `  `no -> need to add one  `if we need a 12 mo $Freq_3_b=true is there a spec w / 12 mon?  `  `yes ->ok  `  `no -> need to add oneSET AUTOMATIC RELATIONS($one_b;$many_b)If (Not($elmsftyRO_b))READ WRITE([ElementsSafety])End if CLEAR LIST($ElementsList_L;*)  `End INSP_CheckTunnelSpcFreq