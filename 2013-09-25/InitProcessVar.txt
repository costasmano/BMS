If (False)  `GP: InitProcessVar  `Copyright © 1995-1996,  Albert S. Leung, All Rights Reserved.  `Initialize process variables for the MHD BMS applicationMods_2004_CM11   ` Modified by: costasmanousakis-(Designer)-(2/7/2006 11:46:14)Mods_2006_CM03   ` Modified by: costasmanousakis-(Designer)-(12/12/2006 12:01:09)Mods_2006_CM07   ` Modified by: costasmanousakis-(Designer)-(3/28/2007 15:54:24)Mods_2007_CM07   ` Modified by: costasmanousakis-(Designer)-(9/30/08 14:58:02)Mods_2008_CM_5404   ` ("DESIGNMODS")  `  `Use ◊aFeatDescr,... global vars for aFeatDescr_,IDaFeatDescr_,BINaFeatDescr_ process vars  ` Modified by: costasmanousakis-(Designer)-(10/1/08 09:18:11)Mods_2008_CM_5404   ` ("DESIGNMODS")  `Changed size of aItem31 to A(2)Mods_2009_03   `CJM  r001   `03/06/09, 12:53:13`Upgrade from open form window to open windowMods_2013_05   `r001 ` Add Compiler_NewInspReports so it is only called once at process launch  `Modified by: Charles Miller (5/2/13 15:49:11)Mods_2013_09   `r001 `   `Modified by: Charles Miller (9/18/13 11:00:52)  `Add fields to [TunnelInspection] to track   `Structural Collision Damage  `[TunnelInspection]StructuralCollisionValue_s  `[TunnelInspection]StructuralCollisionComments_txt  `Roadway collision damage  `[TunnelInspection]RoadwayCollisionValue_s  `[TunnelInspection]RoadwayCollisionComments_txtEnd if Compiler_NewInspReports Compiler_FieldVariables ut_InitFieldArray $v_startMili_L:=MillisecondsC_STRING(255;MainTitle)  `What is the main window title?C_STRING(5;CurInsp)  `Who is doing the inspection?C_POINTER(pFile)  `The table that is currentC_STRING(255;DefInLay)C_STRING(255;DefOutLay)C_LONGINT($v_startMili_L;$v_Part1_L;$v_Part2_L;$v_Part3_L;$v_Part4_L;$v_Part5_L;$v_Part6_L;$v_Part7_L)ARRAY INTEGER(aInspLevelCod_;0)ARRAY INTEGER(aMonthI;0)ARRAY STRING(5;BINa7FCodes_;0)ARRAY STRING(5;BINaFeatCodes_;0)ARRAY STRING(5;IDa7FCodes_;0)ARRAY STRING(5;IDaFeatCodes_;0)ARRAY STRING(5;a7FCodes_;0)ARRAY STRING(3;aCulInspC_;0)ARRAY STRING(20;aCulvertI_;0)ARRAY STRING(25;aItem107Des;0)ARRAY STRING(1;aItem107;0)ARRAY STRING(1;aItem108c;0)ARRAY STRING(26;aItem108cD;0)ARRAY STRING(2;aItem31;0)ARRAY STRING(40;aItem43bDes;0)ARRAY STRING(40;aItem44bDes;0)ARRAY STRING(2;aItem43b;0)ARRAY STRING(2;aItem44b;0)ARRAY STRING(19;aItem31Des;0)ARRAY STRING(1;aItem102;0)ARRAY STRING(28;aItem102Des;0)ARRAY STRING(23;aItem26Des;0)ARRAY STRING(2;aItem26;0)ARRAY STRING(5;aFeatCodes_;0)ARRAY STRING(2;aFndCode_;0)ARRAY STRING(60;aFndtion_;0)ARRAY STRING(3;aInspCod_;0)ARRAY STRING(5;aInspLevel_;0)ARRAY STRING(5;aInspRcod_;0)ARRAY STRING(45;aInspRdes_;0)ARRAY STRING(20;aInspType_;0)ARRAY STRING(1;aIntegralC_;0)ARRAY STRING(40;aIntegralD_;0)ARRAY STRING(3;aIt8BrCatCode_;0)ARRAY STRING(3;aIt8OwnerCode_;0)ARRAY STRING(1;aItem100_;0)ARRAY STRING(50;aItem100d_;0)ARRAY STRING(1;aItem101_;0)ARRAY STRING(50;aItem101d_;0)ARRAY STRING(1;aItem111_;0)ARRAY STRING(50;aItem111d_;0)ARRAY STRING(1;aItem20_;0)ARRAY STRING(65;aItem20des_;0)ARRAY STRING(1;aItem33_;0)ARRAY STRING(42;aItem33des_;0)ARRAY STRING(1;aItem37_;0)ARRAY STRING(60;aItem37des_;0)ARRAY STRING(1;aItem38_;0)ARRAY STRING(40;aItem38des_;0)ARRAY STRING(2;aItem21;0)ARRAY STRING(2;aItem22;0)ARRAY STRING(27;aItem21Des;0)ARRAY STRING(27;aItem22Des;0)ARRAY STRING(1;aItem43a;0)ARRAY STRING(1;aItem44a;0)ARRAY STRING(30;aItem43aDes;0)ARRAY STRING(30;aItem44aDes;0)ARRAY STRING(1;aItem108b;0)ARRAY STRING(26;aItem108bD;0)ARRAY STRING(10;aMonths;0)ARRAY STRING(1;aItem41;0)ARRAY STRING(20;aPostStat_;0)ARRAY STRING(6;aPostStatC_;0)ARRAY STRING(32;aItem41Des;0)ARRAY STRING(50;aIRatMethD_;0)ARRAY STRING(50;aORatMethD_;0)ARRAY STRING(1;aIRatMeth_;0)ARRAY STRING(1;aORatMeth_;0)ARRAY STRING(1;aItem42a;0)ARRAY STRING(1;aItem42b;0)ARRAY STRING(15;aItem42bDes;0)ARRAY STRING(24;aItem42aDes;0)ARRAY STRING(30;aItem64aDes;0)ARRAY STRING(30;aItem66aDes;0)ARRAY STRING(1;aItem64a;0)ARRAY STRING(1;aItem66a;0)ARRAY STRING(2;aItem75a;0)ARRAY STRING(60;aItem75aDes;0)ARRAY STRING(1;aItem75b;0)ARRAY STRING(1;aItem108a;0)ARRAY STRING(26;aItem108aD;0)ARRAY STRING(30;aItem75bDes;0)ARRAY STRING(5;BINa7FDescr_;0)ARRAY STRING(5;BINaFeatDescr_;0)ARRAY STRING(5;IDa7FDescr_;0)ARRAY STRING(5;IDaFeatDescr_;0)ARRAY STRING(5;a7FDescr_;0)ARRAY STRING(25;aDefCAT_;0)ARRAY STRING(3;aDefCode_;0)ARRAY STRING(25;aDirDescr_;0)ARRAY STRING(1;aDirIndex_;0)ARRAY STRING(5;aFeatDescr_;0)ARRAY STRING(50;aIt8BrCatDes_;0)ARRAY STRING(50;aIt8OwnerDes_;0)ARRAY STRING(3;aKeyCodes_;0)ARRAY STRING(35;aKeyDescr_;0)ARRAY STRING(25;aRatCAT1_;0)ARRAY STRING(25;aRatCAT2_;0)ARRAY STRING(25;aRatCAT3_;0)ARRAY STRING(25;aRatCAT4_;0)ARRAY STRING(2;aRatCode_;0)ARRAY STRING(10;aRatingFT_;0)ARRAY STRING(20;aTownName_;0)ARRAY STRING(25;aUORCAT_;0)ARRAY STRING(2;aUORCode_;0)ARRAY STRING(2;aTempBridgeC_;0)ARRAY STRING(25;aTempBridge_;0)ARRAY STRING(25;aNBIPages;0)  `moved here.... 2004-05-05pFile:=->[Bridge MHD NBIS]DefInLay:="Bridge Input"  `Default input layoutDefOutLay:="NBIS Stack Info"  `Default output layout  `Popup menus for SI & A stuffSHORT_MESSAGE ("Initializing process data. Please wait…")$v_Part1_L:=MillisecondsCOPY ARRAY(◊aMonths;aMonths)COPY ARRAY(◊aMonthI;aMonthI)COPY ARRAY(◊aMaintCod;aItem21)COPY ARRAY(◊aMaintOwner;aItem21Des)COPY ARRAY(◊aMaintCod;aItem22)COPY ARRAY(◊aMaintOwner;aItem22Des)COPY ARRAY(◊aFC_Cod;aItem26)COPY ARRAY(◊aFC;aItem26Des)COPY ARRAY(◊aDesLoadCod;aItem31)COPY ARRAY(◊aDesignLoad;aItem31Des)COPY ARRAY(◊aPostCode;aItem41)COPY ARRAY(◊aPosting;aItem41Des)COPY ARRAY(◊aSerOvrCode;aItem42a)COPY ARRAY(◊aServiceOvr;aItem42aDes)COPY ARRAY(◊aSerUndrCod;aItem42b)COPY ARRAY(◊aServUndr;aItem42bDes)COPY ARRAY(◊aMatCode;aItem43a)COPY ARRAY(◊aMaterial;aItem43aDes)COPY ARRAY(◊aMatCode;aItem44a)COPY ARRAY(◊aMaterial;aItem44aDes)COPY ARRAY(◊aDesignCod;aItem43b)COPY ARRAY(◊aDesign;aItem43bDes)COPY ARRAY(◊aDesignCod;aItem44b)COPY ARRAY(◊aDesign;aItem44bDes)COPY ARRAY(◊aTruckCod;aItem64a)COPY ARRAY(◊aTruck;aItem64aDes)COPY ARRAY(◊aTruckCod;aItem66a)COPY ARRAY(◊aTruck;aItem66aDes)COPY ARRAY(◊aDirCode;aItem102)COPY ARRAY(◊aDirection;aItem102Des)COPY ARRAY(◊aDeckCod;aItem107)COPY ARRAY(◊aDeck;aItem107Des)COPY ARRAY(◊aWearCod;aItem108a)COPY ARRAY(◊aWearing;aItem108aD)COPY ARRAY(◊aMembCod;aItem108b)COPY ARRAY(◊aMembrane;aItem108bD)COPY ARRAY(◊aDeckPCod;aItem108c)COPY ARRAY(◊aDeckProt;aItem108cD)COPY ARRAY(◊aTypeofWCod;aItem75a)COPY ARRAY(◊aTypeofWork;aItem75aDes)COPY ARRAY(◊aWdoneBCod;aItem75b)COPY ARRAY(◊aWorkDoneBy;aItem75bDes)COPY ARRAY(◊aItem20;aItem20_)COPY ARRAY(◊aItem20des;aItem20des_)COPY ARRAY(◊aItem33;aItem33_)COPY ARRAY(◊aItem33des;aItem33des_)COPY ARRAY(◊aItem38;aItem38_)COPY ARRAY(◊aItem38des;aItem38des_)COPY ARRAY(◊aItem37;aItem37_)COPY ARRAY(◊aItem37des;aItem37des_)COPY ARRAY(◊aItem100;aItem100_)COPY ARRAY(◊aItem100des;aItem100d_)COPY ARRAY(◊aItem101;aItem101_)COPY ARRAY(◊aItem101des;aItem101d_)COPY ARRAY(◊aItem111;aItem111_)COPY ARRAY(◊aItem111des;aItem111d_)COPY ARRAY(◊aFndCode;aFndCode_)COPY ARRAY(◊aFndtion;aFndtion_)COPY ARRAY(◊aInspRcod;aInspRcod_)COPY ARRAY(◊aInspRdes;aInspRdes_)COPY ARRAY(◊aInspCod;aInspCod_)COPY ARRAY(◊aInspType;aInspType_)COPY ARRAY(◊aCulInspCod;aCulInspC_)COPY ARRAY(◊aCulvertI;aCulvertI_)COPY ARRAY(◊aPostStat;aPostStat_)COPY ARRAY(◊aPostStatC;aPostStatC_)COPY ARRAY(◊aRatingMeth;aORatMeth_)COPY ARRAY(◊aRatMethDes;aORatMethD_)COPY ARRAY(◊aRatingMeth;aIRatMeth_)COPY ARRAY(◊aRatMethDes;aIRatMethD_)COPY ARRAY(◊aIntegralC;aIntegralC_)COPY ARRAY(◊aIntegralD;aIntegralD_)COPY ARRAY(◊aTownName;aTownName_)COPY ARRAY(◊aKeyCodes;aKeyCodes_)COPY ARRAY(◊aKeyDescr;aKeyDescr_)  `Added code on 1/10/2000COPY ARRAY(◊aFeatDescr;aFeatDescr_)COPY ARRAY(◊aFeatCodes;aFeatCodes_)COPY ARRAY(◊a7FDescr;a7FDescr_)COPY ARRAY(◊a7FCodes;a7FCodes_)  `End of code added on 1/10/2000  `Added code on 11/16/2000COPY ARRAY(◊aFeatDescr;IDaFeatDescr_)COPY ARRAY(◊aFeatCodes;IDaFeatCodes_)COPY ARRAY(◊a7FDescr;IDa7FDescr_)COPY ARRAY(◊a7FCodes;IDa7FCodes_)  `End of code added on 11/16/2000  `Added code on 11/17/2000COPY ARRAY(◊aFeatDescr;BINaFeatDescr_)COPY ARRAY(◊aFeatCodes;BINaFeatCodes_)COPY ARRAY(◊a7FDescr;BINa7FDescr_)COPY ARRAY(◊a7FCodes;BINa7FCodes_)  `End of code added on 11/17/2000COPY ARRAY(◊aDirIndex;aDirIndex_)COPY ARRAY(◊aDirDescr;aDirDescr_)COPY ARRAY(◊aRatingFT;aRatingFT_)  `3/17/2001 ASL - need three popup menus but only one coding arrayCOPY ARRAY(◊aRatCAT;aRatCAT1_)COPY ARRAY(◊aRatCAT;aRatCAT2_)COPY ARRAY(◊aRatCAT;aRatCAT3_)  `6/22/2002 ASL for previous underwater ratingCOPY ARRAY(◊aRatCAT;aRatCAT4_)  `For prev UW ratingCOPY ARRAY(◊aRatCode;aRatCode_)COPY ARRAY(◊aDefCAT;aDefCAT_)COPY ARRAY(◊aDefCode;aDefCode_)COPY ARRAY(◊aUORCAT;aUORCAT_)COPY ARRAY(◊aUORCode;aUORCode_)  `End of code added 3/17/2001 ASL  `6/22/2001 - To code insp level in roman numeralsCOPY ARRAY(◊aInspLevel;aInspLevel_)COPY ARRAY(◊aInspLevelCod;aInspLevelCod_)  `end of 6/22/2001 code  `Added code on 01/26/2001COPY ARRAY(◊aIt8OwnerDes;aIt8OwnerDes_)COPY ARRAY(◊aIt8OwnerCode;aIt8OwnerCode_)COPY ARRAY(◊aIt8BrCatDes;aIt8BrCatDes_)COPY ARRAY(◊aIt8BrCatCode;aIt8BrCatCode_)  `End of code added on 01/26/2001COPY ARRAY(◊aTempBridge;aTempBridge_)COPY ARRAY(◊aTempBridgeC;aTempBridgeC_)  `````````````begin: added code on 8/27/2003 for Bridge Design SheetARRAY STRING(25;aDesign_Scour;0)ARRAY STRING(2;aTrans_Scour;0)ARRAY STRING(40;aDesign_Deck;0)ARRAY STRING(2;aTrans_Deck;0)ARRAY STRING(40;aDesign_SuperStr;0)ARRAY STRING(3;aTrans_SuperStr;0)  `Fixed 2003-10-17ARRAY STRING(2;aTrans_WearingSurface;0)COPY ARRAY(◊aDesign_Scour;aDesign_Scour)COPY ARRAY(◊aTrans_Scour;aTrans_Scour)COPY ARRAY(◊aDesign_Deck;aDesign_Deck)COPY ARRAY(◊aTrans_Deck;aTrans_Deck)COPY ARRAY(◊aDesign_SuperStr;aDesign_SuperStr)COPY ARRAY(◊aTrans_SuperStr;aTrans_SuperStr)COPY ARRAY(◊aTrans_WearingSurface;aTrans_WearingSurface)  `````````````end: added code on 8/27/2003ARRAY STRING(60;aFreezeThawDesc_;0)  `Freeze Thaw arraysARRAY STRING(2;aFreezeThawCode_;0)If (Type(◊aFreezeThawDesc)=String array )COPY ARRAY(◊aFreezeThawDesc;aFreezeThawDesc_)COPY ARRAY(◊aFreezeThawCode;aFreezeThawCode_)End if   `Array for changesARRAY POINTER(ptr_Changes;0;0)  `5/14/2001 ASL  `Arrays for element dictARRAY STRING(40;aElementCat_;5)ARRAY STRING(3;aElementCatCode_;5)aElementCat_{1}:="Item 58 Deck"aElementCat_{2}:="Item 59 Superstructure"aElementCat_{3}:="Item 60 Substructure"aElementCat_{4}:="Item 61 Channel & Channel Protection"aElementCat_{5}:="Item 62 Culverts"aElementCatCode_{1}:="N58"aElementCatCode_{2}:="N59"aElementCatCode_{3}:="N60"aElementCatCode_{4}:="N61"aElementCatCode_{5}:="N62"$v_Part2_L:=MillisecondsIf (False)  `5/21/2001 ASL  `Drop down menu for [ElementDict];"NewElement"ARRAY STRING(40;aParent_;0)ARRAY INTEGER(aParentCode_;0)ARRAY STRING(3;aParentCat_;0)QUERY([ElementDict];[ElementDict]IsParent=True)ORDER BY([ElementDict];[ElementDict]ElementNo;>)SELECTION TO ARRAY([ElementDict]Description;aParent_;[ElementDict]ElementNo;aParentCode_;[ElementDict]Category;aParentCat_)REDUCE SELECTION([ElementDict];0)INSERT IN ARRAY(aParent_;1)INSERT IN ARRAY(aParentCode_;1)INSERT IN ARRAY(aParentCat_;1)aParent_{1}:="none"aParentCode_{1}:=0aParentCat_{1}:=""End if $v_Part3_L:=Milliseconds  `ImagesARRAY STRING(3;aPictCode;0)ARRAY STRING(15;aPictType;0)LIST TO ARRAY("PictureCode";aPictCode)LIST TO ARRAY("PictureCodeDescr";aPictType)  `Inspection form arraysARRAY STRING(2;aCollisionCode;0)ARRAY STRING(20;aCollisionDamage;0)ARRAY STRING(20;aScour;0)ARRAY STRING(20;aI59CollisionDamage;0)ARRAY STRING(20;aI59LoadDefl;0)ARRAY STRING(20;aI59LoadVibr;0)ARRAY STRING(20;aStreamFlow;0)ARRAY STRING(20;aI62Scour;0)ARRAY STRING(20;aI62CollisionDamage;0)ARRAY STRING(20;aI62LoadVibration;0)ARRAY STRING(2;aStreamCode;0)ARRAY STRING(40;aPedTraffNE;0)ARRAY STRING(40;aPedTraffSW;0)ARRAY STRING(2;aPedTraffCode;0)ARRAY STRING(20;aI62aCollisionDamage;0)ARRAY STRING(20;aI62bCollisionDamage;0)LIST TO ARRAY("DamageType";aCollisionDamage)LIST TO ARRAY("DamageType";aScour)LIST TO ARRAY("DamageType";aI59CollisionDamage)LIST TO ARRAY("DamageType";aI62aCollisionDamage)LIST TO ARRAY("DamageType";aI62bCollisionDamage)LIST TO ARRAY("DamageType";aI59LoadDefl)LIST TO ARRAY("DamageType";aI59LoadVibr)LIST TO ARRAY("DamageType";aI62Scour)LIST TO ARRAY("DamageType";aI62CollisionDamage)LIST TO ARRAY("DamageType";aI62LoadVibration)LIST TO ARRAY("DamageCode";aCollisionCode)LIST TO ARRAY("StreamVelocity";aStreamFlow)LIST TO ARRAY("StreamVelocityCode";aStreamCode)LIST TO ARRAY("PedTraffic";aPedTraffNE)LIST TO ARRAY("PedTraffic";aPedTraffSW)LIST TO ARRAY("PedTrafficCode";aPedTraffCode)  `````````````begin: added code on 11/18/2003 for 4D Word Templates  `ARRAY STRING(20;aDBIEphone;0)  `LIST TO ARRAY("DBIE Phone No";aDBIEphone)INI_LoadDBIEPhones   `````````````end: added code on 11/13/2003  `added variable for destinationC_STRING(80;vsForward)vsForward:=◊Forward$v_Part4_L:=Milliseconds  `Arrays for Personnel Data entry  `InitPers ut_RetrievePersArraysDoc $v_Part5_L:=MillisecondsINIT_BMS $v_Part6_L:=MillisecondsCLOSE WINDOWIf (Shift down)C_TEXT(Msg)Msg:="Part 1 : "+String($v_Part1_L-$v_startMili_L)+Char(13)Msg:=Msg+"Part 2 copy arrays : "+String($v_Part2_L-$v_Part1_L)+Char(13)Msg:=Msg+"Part 3  Elmt dict: "+String($v_Part3_L-$v_Part2_L)+Char(13)Msg:=Msg+"Part 4 copy lists : "+String($v_Part4_L-$v_Part3_L)+Char(13)Msg:=Msg+"Part 5  initpers: "+String($v_Part5_L-$v_Part4_L)+Char(13)Msg:=Msg+"Part 6 initbms : "+String($v_Part6_L-$v_Part5_L)+Char(13)C_LONGINT($Width_l;$Height_l;$Win_l;$Pages_l)C_BOOLEAN($FixedWidth_b;$FixedHeight_b)C_TEXT($Title_txt)GET FORM PROPERTIES([Dialogs];"stats";$Width_l;$Height_l;$Pages_l;$FixedWidth_b;$FixedHeight_b;$Title_txt)$Win_l:=ut_OpenNewWindow ($Width_l;$Height_l;0;0;$Title_txt;"ut_CloseCancel")  `$ref:=Open form window([Dialogs];"stats";0)DIALOG([Dialogs];"stats")CLOSE WINDOW($Win_l)Msg:=""End if 