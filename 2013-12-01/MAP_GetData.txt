  `Method: MAP_GetData  `Description  `  ` Parameters  ` ----------------------------------------------------If (False)  ` ----------------------------------------------------  `User name (OS): Costas Manousakis  `User (4D) : Designer  `Date and time: 12/01/13, 16:21:48  ` ----------------------------------------------------  `Created : Mods_2013_12End if   `C_LONGINT(MAP_BridgeCount_L)C_DATE(MAP_Date_d)C_REAL(MAP_CenterLat_r;MAP_CenterLon_r)ARRAY REAL(MAP_ArrayLat_ar;0)ARRAY REAL(MAP_ArrayLon_ar;0)ARRAY TEXT(MAP_ArrayDesc_atxt;0)ARRAY TEXT(MAP_ArrayInfoWin_atxt;0)ARRAY TEXT(MAP_ArrayBIN_atxt;0)ARRAY TEXT($Bdepts_atxt;0)ARRAY TEXT($item7_atxt;0)ARRAY TEXT($item6a_atxt;0)ARRAY LONGINT($it16a_aL;0)ARRAY LONGINT($it16b_aL;0)ARRAY REAL($it16c_ar;0)ARRAY LONGINT($it17a_aL;0)ARRAY LONGINT($it17b_aL;0)ARRAY REAL($it17c_ar;0)ARRAY TEXT($item8_atxt;0)SELECTION TO ARRAY([Bridge MHD NBIS]BIN;MAP_ArrayBIN_atxt;[Bridge MHD NBIS]BDEPT;$Bdepts_atxt;[Bridge MHD NBIS]Item7;$item7_atxt;[Bridge MHD NBIS]Item6A;$item6a_atxt)SELECTION TO ARRAY([Bridge MHD NBIS]Item16A;$it16a_aL;[Bridge MHD NBIS]Item16B;$it16b_aL;[Bridge MHD NBIS]Item16C;$it16c_ar;[Bridge MHD NBIS]Item17A;$it17a_aL;[Bridge MHD NBIS]Item17B;$it17b_aL;[Bridge MHD NBIS]Item17C;$it17c_ar)SELECTION TO ARRAY([Bridge MHD NBIS]Item8;$item8_atxt)ARRAY REAL(MAP_ArrayLat_ar;Records in selection([Bridge MHD NBIS]))ARRAY REAL(MAP_ArrayLon_ar;Records in selection([Bridge MHD NBIS]))ARRAY TEXT(MAP_ArrayDesc_atxt;Records in selection([Bridge MHD NBIS]))ARRAY TEXT(MAP_ArrayInfoWin_atxt;Records in selection([Bridge MHD NBIS]))MAP_Date_d:=Current date(*)C_LONGINT($loop_L)For ($loop_L;1;Size of array(MAP_ArrayBIN_atxt))MAP_ArrayDesc_atxt{$loop_L}:=$Bdepts_atxt{$loop_L}+" "+MAP_ArrayBIN_atxt{$loop_L}+" "+Replace string($item7_atxt{$loop_L};"  ";" ")+" over "+Replace string($item6a_atxt{$loop_L};"  ";" ")MAP_ArrayInfoWin_atxt{$loop_L}:=$Bdepts_atxt{$loop_L}+" ("+MAP_ArrayBIN_atxt{$loop_L}+") Item 8 : "+$item8_atxt{$loop_L}+"<br>"+Replace string($item7_atxt{$loop_L};"  ";" ")+" over "+Replace string($item6a_atxt{$loop_L};"  ";" ")+"<br>"If (($it16a_aL{$loop_L}#0) & ($it17a_aL{$loop_L}#0))MAP_ArrayLat_ar{$loop_L}:=ut_DegMinSecToDeg ($it16a_aL{$loop_L};$it16b_aL{$loop_L};$it16c_ar{$loop_L})MAP_ArrayLon_ar{$loop_L}:=-(ut_DegMinSecToDeg ($it17a_aL{$loop_L};$it17b_aL{$loop_L};$it17c_ar{$loop_L}))Else MAP_ArrayLon_ar{$loop_L}:=0MAP_ArrayLat_ar{$loop_L}:=0End if End for For ($loop_L;Size of array(MAP_ArrayLat_ar);1;-1)If (MAP_ArrayLat_ar{$loop_L}=0)DELETE FROM ARRAY(MAP_ArrayBIN_atxt;$loop_L;1)DELETE FROM ARRAY(MAP_ArrayLat_ar;$loop_L;1)DELETE FROM ARRAY(MAP_ArrayLon_ar;$loop_L;1)DELETE FROM ARRAY(MAP_ArrayDesc_atxt;$loop_L;1)End if End for MAP_CenterLat_r:=0MAP_CenterLon_r:=0MAP_BridgeCount_L:=Size of array(MAP_ArrayLat_ar)For ($loop_L;1;Size of array(MAP_ArrayLat_ar))MAP_CenterLat_r:=MAP_CenterLat_r+MAP_ArrayLat_ar{$loop_L}MAP_CenterLon_r:=MAP_CenterLon_r+MAP_ArrayLon_ar{$loop_L}End for MAP_CenterLat_r:=MAP_CenterLat_r/MAP_BridgeCount_LMAP_CenterLon_r:=MAP_CenterLon_r/MAP_BridgeCount_LC_TEXT($map_tml_txt)$map_tml_txt:=ut_GetSysParameter ("MAP_Template1")PROCESS HTML TAGS($map_tml_txt;$map_tml_txt)C_BLOB($newfile_blb)TEXT TO BLOB($map_tml_txt;$newfile_blb;UTF8 text without length )C_TIME($doc_t)$doc_t:=Create document("")CLOSE DOCUMENT($doc_t)BLOB TO DOCUMENT(document;$newfile_blb)  `End MAP_GetData