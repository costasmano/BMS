  ` ----------------------------------------------------  ` Form Method: ProjectDetails.i  ` User name (OS): cjmiller  ` Date and time: 03/24/06, 10:37:46  ` ----------------------------------------------------  ` Description  `   `  ` Parameters  ` ----------------------------------------------------If (False)Mods_2006_CJMv2 Mods_TimeTracking Mods_2006_CJMv2   `03/15/07, 15:59:18` remove * form bridge de variableMods_2006_CJMv2   `04/05/07, 16:05:45`fix when cancelling from selecting federal aid, program, or pr  `oject fileMods_2007_CJMv2   `04/26/07, 12:15:37`Integrate Changes made by CostasMods_2007_CJMv2   `r060   `05/16/07, 16:37:11 `Add code to control access Mods_PRJSELECTION   ` Modified by: costasmanousakis-(Designer)-(6/21/2007 10:13:53)Mods_2007_CJM_v5310   ` Modified by: costasmanousakis-(Designer)-(8/28/2007 15:43:12)Mods_2007_CM12_5301   `added use of ◊PRJ_SelectedBIN_txtMods_2007_CM12_5301   `10/01/07 Load RECORD([PRJ_ProjectFile])  ` Modified by: costasmanousakis-(Designer)-(10/29/2007 08:43:45)Mods_2007_CM12_5302   `added check in close detail events to re-order listsMods_2007_CJM_v5303   `r003 `10/09/07, 12:08:26`Add Chapter 85Mods_2007_CJM_v5303   `r004 `10/23/07, 16:30:01`Add code to allow for overide  consultantMods_2007_CJM_v54   `r002 `11/20/07, 16:13:01`Add record - made it so outside call is a method so add   `record form uses exact same call  ` Modified by: costasmanousakis-(Designer)-(6/29/08 10:20:54)Mods_2008_CM_5404   `On Unload mark the record we were in so that it gets highlighted on the output fo  `rm.  `  `Added field RPJ_status on Project data page  ` Modified by: costasmanousakis-(Designer)-(10/6/08 11:16:47)Mods_2008_CM_5404   `Change set name PRJLASTRECORDIN to $PRJLASTRECORDIN (local set)  ` Modified by: costasmanousakis-(Designer)-(4/8/09 09:33:28)Mods_2009_04   `Execute the START TRANSACTION only if PRJ_ReturnAccessAllowed=TRUE  ` Modified by: costasmanousakis-(Designer)-(5/26/09 11:51:24)Mods_2009_05   `Adjusted size of included lists for Reports, Types, Sketch and Str Reviews;  `changed size to automatic size, and Window size to "with constraints" - fixed witdh, min ht=500  ` Modified by: Costas Manousakis-(Designer)-(8/23/13 17:00:10)Mods_2013_08   `  `Changed buttons for projectInfo to use Resource file "projbtn.png"End if Case of : (Form event=On Load )UNLOAD RECORD([PRJ_ProjectFile])PRJ_SetManyTablesReadOnly PRJ_SetAccess If (PRJ_ReturnAccessAllowed )ENABLE BUTTON(PRJ_Validate_l)ENABLE BUTTON(PRJ_Save_l)START TRANSACTIONElse DISABLE BUTTON(PRJ_Validate_l)DISABLE BUTTON(PRJ_Save_l)End if LOAD RECORD([PRJ_ProjectFile])  `Mods_2007_CM12_5301   `10/01/07 Load RECORD([PRJ_ProjectFile])PRJ_BD_BuildBrgDataShtList ProjectChangesMade_b:=FalsePRJ_SetFormVariableToEmpty PRJ_LoadProjectFileData PRJ_LoadPage_0 C_LONGINT($Width_l;$Height_l)GET FORM PROPERTIES([PRJ_ProjectDetails];"ProjectDetails.i";$Width_l;$Height_l)ut_ResizeWindow (Frontmost window;$Width_l+0;$Height_l+0)ARRAY TEXT(PRJ_Detail_atxt;0)ARRAY TEXT(PRJ_DetailHead_atxt;0)If (Record number([PRJ_ProjectDetails])=New record )Inc_Sequence ("PRJ_ProjectID_l";->[PRJ_ProjectDetails]PRJ_ProjectID_l)PRJProjectTabs_as:=2Else PRJProjectTabs_as:=PRJ_DefaultPage_atxtIf (False)If ([PRJ_ProjectDetails]PRJ_BeamUnit_l#0)PRJ_BeamUnitCost_s:=String(Round(([PRJ_ProjectDetails]PRJ_BeamCost_r/[PRJ_ProjectDetails]PRJ_BeamUnit_l);2))Else PRJ_BeamUnitCost_s:="Beam Unit 0"End if End if End if PRJ_PT_CalcHourTotals   `Mods_TimeTrackingPRJ_ProjectTypes_atxt:=PRJ_SetUpDetailDDs (->PRJ_ProjectTypes_atxt;->[PRJ_ProjectDetails]PRJ_ProjectType_s)If ([PRJ_ProjectDetails]PRJ_BridgeSectResp_s="")If (PRJ_BridgeSection_atxt{1}#"select@")INSERT IN ARRAY(PRJ_BridgeSection_atxt;0;1)PRJ_BridgeSection_atxt{1}:="Select Responsible Group"End if PRJ_BridgeSection_atxt:=1Else If (PRJ_BridgeSection_atxt{1}="select@")DELETE FROM ARRAY(PRJ_BridgeSection_atxt;1;1)End if PRJ_BridgeSection_atxt:=PRJ_SetUpDetailDDs (->PRJ_BridgeSection_atxt;->[PRJ_ProjectDetails]PRJ_BridgeSectResp_s)End if PRJ_ControlPageMovement ut_SetStringOrTextFilter (->[PRJ_ProjectDetails]PRJ_NonBridgeNotes_txt)ut_SetStringOrTextFilter (->[PRJ_ProjectDetails]PRJ_CityOrTown_s)ut_SetStringOrTextFilter (->[PRJ_ProjectDetails]PRJ_EnteredDesignEWO_s)ut_SetStringOrTextFilter (->[PRJ_ProjectDetails]PRJ_FederalAid_s)ut_SetStringOrTextFilter (->[PRJ_ProjectDetails]PRJ_Program_s)ut_SetStringOrTextFilter (->[PRJ_ProjectDetails]PRJ_ApprovedType_s)ut_SetStringOrTextFilter (->[PRJ_ProjectDetails]PRJ_BinUpdateRequest_s)ut_SetStringOrTextFilter (->[PRJ_ProjectDetails]PRJ_Slot_s)ut_SetStringOrTextFilter (->[PRJ_ProjectDetails]PRJ_Comments_txt)ut_SetStringOrTextFilter (->[PRJ_ProjectDetails]PRJ_LastActionDescription_txt)ut_SetStringOrTextFilter (->[PRJ_ProjectDetails]PRJ_BridgeDataSheetComplete_s)ut_SetStringOrTextFilter (->[PRJ_ProjectDetails]PRJ_EnteredConstructionEWO_s)ut_SetStringOrTextFilter (->PRJ_DEBin_s)ut_SetStringOrTextFilter (->PRJ_ConsultantName_txt)ut_SetStringOrTextFilter (->PRJ_DEBridgeNo_s): (Form event=On Outside Call )PRJ_DetailOutsideCall : (Form event=On Unload )PRJ_SetFormVariableToEmpty CLEAR SET("$PRJLASTRECORDIN")CREATE EMPTY SET([PRJ_ProjectDetails];"$PRJLASTRECORDIN")ADD TO SET([PRJ_ProjectDetails];"$PRJLASTRECORDIN"): (Form event=On Close Detail )  `Mods_TimeTrackingCase of : (Current form page=3)  `ReportsQUERY([PRJ_ReportData];[PRJ_ReportData]PRJ_ProjectID_l=[PRJ_ProjectDetails]PRJ_ProjectID_l)ORDER BY([PRJ_ReportData];[PRJ_ReportData]RPT_Received_d;<): (Current form page=4)  `Type StudiesQUERY([PRJ_TypeStudy];[PRJ_TypeStudy]PRJ_ProjectID_l=[PRJ_ProjectDetails]PRJ_ProjectID_l)ORDER BY([PRJ_TypeStudy];[PRJ_TypeStudy]TYP_Received_d;<): (Current form page=5)  `SketchQUERY([PRJ_SketchPlans];[PRJ_SketchPlans]PRJ_ProjectID_l=[PRJ_ProjectDetails]PRJ_ProjectID_l)ORDER BY([PRJ_SketchPlans];[PRJ_SketchPlans]SKT_SubmissionNumber_l;<): (Current form page=6)  `Struct ReviewQUERY([PRJ_StructuralReview];[PRJ_StructuralReview]PRJ_ProjectID_l=[PRJ_ProjectDetails]PRJ_ProjectID_l)ORDER BY([PRJ_StructuralReview];[PRJ_StructuralReview]SR_StructureReviewOrder_l;<): (Current form page=7)  `TimesheetsPRJ_PT_CalcHourTotals ORDER BY([PRJ_ProjectTimeTracking];[PRJ_ProjectTimeTracking]PT_WeekEnding_d;<)End case : (Form event=On Data Change )End case   `End Form Method: ProjectDetails.i