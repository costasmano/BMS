  `----------------------------------------------------  `User name (OS): Charles Miller  `Date and time: 10/04/12, 11:38:22  `----------------------------------------------------  `Method: Form Method: [Inspections]Railfc_rr_p1  `Description  `  ` Parameters  ` ----------------------------------------------------If (False)Mods_2012_10   `r001 `   `Modified by: Charles Miller (10/4/12 11:38:23)Mods_2013_02   `r001 ` Allow for different headings on weights  `Modified by: Charles Miller (2/14/13 15:59:35)  ` Modified by: Costas Manousakis-(Designer)-(7/29/13 11:33:18)Mods_2013_07   `  `Modified print forms for MBTA to display the title MBTA Area engineer only.End if C_INTEGER($i;$recnum;$count;$REMARKS_NUMBER)$REMARKS_NUMBER:=5C_POINTER($pMember;$pRemarks;$pPrevRat;$pRat;$pDef;$pLetter;$p)C_LONGINT($temparea)ARRAY STRING(2;$aPrevRating;0)ARRAY STRING(2;$aCurrentRating;0)ARRAY STRING(5;$aDeficiency;0)ARRAY STRING(2;$aPriority;0)Case of : (Form event=On Printing Detail )INSP_SetWPHeadings G_Insp_RelateInsp (->[ElementsSafety]InspID)  `get the element safety recordsQUERY SELECTION([ElementsSafety];[ElementsSafety]AltRating#"N")$recnum:=Records in selection([ElementsSafety])  `Sort by element no.  `10/3/2002 ASL  `ORDER BY([ElementsSafety];[ElementsSafety]ElementNo;>)ORDER BY([ElementsSafety];[ElementDict]Category;>;[ElementDict]FullLabel;>)  `Initialize  form element variablesFor ($i;1;$REMARKS_NUMBER)$pMember:=Get pointer("vMember"+String($i))$pPrevRat:=Get pointer("vprevR"+String($i))$pRat:=Get pointer("vR"+String($i))$pDef:=Get pointer("vDEF"+String($i))$pRemarks:=Get pointer("vRemarks"+String($i))$pLetter:=Get pointer("vLetter"+String($i))$pMember->:=""$pPrevRat->:=""$pRat->:=""$pDef->:=""$pRemarks->:=""$pLetter->:=""$p:=Get pointer("vCrack"+String($i))$p->:=""$p:=Get pointer("vWeld"+String($i))$p->:=""$p:=Get pointer("vH20_"+String($i))$p->:=""$p:=Get pointer("vTyp3_"+String($i))$p->:=""$p:=Get pointer("v3S2_"+String($i))$p->:=""$p:=Get pointer("vNotRated_"+String($i))$p->:=""SET VISIBLE(*;"NotRated@";False)End for $i:=1ARRAY STRING(255;$aItem;$recnum)ARRAY STRING(255;$aElmMember;$recnum)C_LONGINT(vSpecMemStartLetter;$viStart)$viStart:=Character code("A")+vSpecMemStartLetterFIRST RECORD([ElementsSafety])While (Not(End selection([ElementsSafety])))RELATE ONE([ElementsSafety]ElementNo)$aItem{$i}:=INSP_ElmtSfty_ItemNo ([ElementsSafety]ElementNo;False)If ([ElementDict]Parent#0)  `has parent$aItem{$i}:=$aItem{$i}+"."+GetParentPrefix +" "+GetParentDescription   `Display description$aElmMember{$i}:=[ElementDict]Prefix+[ElementsSafety]DescriptionElse   `no parent$aItem{$i}:=$aItem{$i}+"."+[ElementDict]Prefix  `Display description$aElmMember{$i}:=[ElementsSafety]DescriptionEnd if   `Get the commentsIf ($i<=$REMARKS_NUMBER)$pLetter:=Get pointer("vLetter"+String($i))C_LONGINT($vlLetterCode;$vlLetterCycle)$vlLetterCode:=$viStart+$i-1$vlLetterCycle:=($vlLetterCode-Character code("A"))\26$vlLetterCode:=$vlLetterCode-(26*$vlLetterCycle)$pLetter->:=Char($vlLetterCode)If ($vlLetterCycle>0)$pLetter->:=Char($vlLetterCode)+String($vlLetterCycle)End if $pRemarks:=Get pointer("vRemarks"+String($i))If (BLOB size([ElementsSafety]ElmComments)>0)$temparea:=WR New offscreen area WR INSERT STYLED TEXT ($temparea;[ElementsSafety]ElmComments)WR EXECUTE COMMAND ($temparea;wr cmd select all )$count:=WR Count ($temparea;wr nb characters )If ($count<◊vLimitCharDAM)$pRemarks->:=WR Get selected text ($temparea)Else $pRemarks->:="See remarks in comments section."End if WR DELETE OFFSCREEN AREA ($temparea)Else $pRemarks->:=""End if $pMember:=Get pointer("vMember"+String($i))$pPrevRat:=Get pointer("vprevR"+String($i))$pRat:=Get pointer("vR"+String($i))$pDef:=Get pointer("vDEF"+String($i))$pMember->:=$aItem{$i}+" "+$aElmMember{$i}Case of   `added this to fit text.: (Length($pMember->)>29)FONT SIZE($pMember->;8): (Length($pMember->)>27)FONT SIZE($pMember->;9): (Length($pMember->)>24)FONT SIZE($pMember->;10)End case $pPrevRat->:=$aPrevRating{$i}$pRat->:=$aCurrentRating{$i}$pDef->:=$aDeficiency{$i}$p:=Get pointer("vCrack"+String($i))If ([ElementsSafety]Crack=True)$p->:="Y"Else $p->:="N"End if $p:=Get pointer("vWeld"+String($i))$p->:=[ElementsSafety]Weld ConditionIf ([ElementsSafety]Inv H20>=0)  `Is this correct for rr bridges$p:=Get pointer("vH20_"+String($i))$p->:=String([ElementsSafety]Inv H20;"##0;N;0")$p:=Get pointer("vTyp3_"+String($i))$p->:=String([ElementsSafety]Inv Type 3;"##0;N;0")$p:=Get pointer("v3S2_"+String($i))$p->:=String([ElementsSafety]Inv 3S2;"##0;N;0")Else $p:=Get pointer("vNotRated_"+String($i))$p->:="Not Rated"SET VISIBLE(*;("NotRated "+String($i));True)End if End if $i:=$i+1NEXT RECORD([ElementsSafety])End while End case   `End Form Method: [Inspections]Railfc_rr_p1