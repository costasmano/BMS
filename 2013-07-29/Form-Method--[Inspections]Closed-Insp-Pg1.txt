If (False)  `LO: [Inspections];"Closed Insp Pg1"  `Copyright © 1995-1996,  Albert S. Leung, All Rights Reserved.Mods_2005_CM01 Mods_2005_CM05   `twice   ` Modified by: ManousakisC (4/24/2006)Mods_2006_CM04   ` Modified by: costasmanousakis-(Designer)-(8/22/2007 15:36:32)Mods_2007_CM12_5301   ` Modified by: costasmanousakis-(Designer)-(3/28/08 15:02:59)Mods_2008_CM_5403   `Adjust Kilo/Mile display  ` Modified by: Costas Manousakis-(Designer)-(7/29/13 11:33:18)Mods_2013_07   `  `Modified print forms for MBTA to display the title MBTA Area engineer only.End if   `Load variablesC_INTEGER($i)C_INTEGER($recnum)C_POINTER($p;$q)C_INTEGER($elm)ARRAY INTEGER($A;0)ARRAY STRING(2;$B;0)ARRAY STRING(2;$C;0)ARRAY STRING(2;$D;0)C_STRING(23;vItem26)C_STRING(27;vItem21;vItem22)C_STRING(1;vLiftBucket;vLadder;vBoat;vWader;vInspect50;vRigging;vStaging;vTraffic;vFlagman;vPolice;vAccOther)C_STRING(1;vNeedLiftBucket;vNeedLadder;vNeedBoat;vNeedWader;vNeedInspect50;vNeedRigging;vNeedStaging;vNeedTraffic;vNeedFlagman;vNeedPolice;vNeedAccOther)C_STRING(1;xS1;xS2;xS3;xS4;xS5)C_STRING(255;vCld_Completion_Date)C_STRING(1;$vDeficiencyDef)$vDeficiencyDef:="-"Case of : (Form event=On Printing Detail )G_Insp_SetDirLbl ([Inspections]OrientationNS)INSP_KiloPtValues INSP_Item21Desc INSP_Item22Desc vItem26:=Get_Description (->◊aFC;->◊aFC_Cod;->[Inspections]Item26)INSP_Item41Desc INSP_Item43Desc INSP_Item107Desc   `Added variables for Item 58,59,60,60uw, 61, 61uw ratingsvItem58:=G_ElmtRatingTxt ([Inspections]Item 58)vItem59:=G_ElmtRatingTxt ([Inspections]Item 59)vItem60:=G_ElmtRatingTxt ([Inspections]Item 60)vItem60UW:=G_ElmtRatingTxt ([Inspections]Item 60 UW)vItem61:=G_ElmtRatingTxt ([Inspections]Item 61)vItem61UW:=G_ElmtRatingTxt ([Inspections]Item 61 UW)vItem62:=G_ElmtRatingTxt ([Inspections]Item 62)vItem62UW:=G_ElmtRatingTxt ([Inspections]Item 62 UW)  `Adjust Fonts and fields.If (Length(vItem26)>14)FONT SIZE(vItem26;9)End if INSP_Item43Desc ("Resize")Case of : (Length([Inspections]Barrier Type)>15)FONT SIZE(*;"BarrierTypeDesc";9)MOVE OBJECT(*;"BarrierTypeDesc";0;-4;0;20)End case G_Insp_FmtSTOWN   `DatesvItem90:=Uppercase(String([Inspections]Item 90;Internal date abbreviated ))If ([Inspections]Item 90=!00/00/00!)vItem90:="--------"End if vPosting_Date:=Uppercase(String([Inspections]PostingDate;Internal date short ))If ([Inspections]PostingDate=!00/00/00!)vPosting_Date:=""End if G_Insp_RelateInsp (->[ElementsSafety]InspID)$recnum:=Records in selection([ElementsSafety])If ($recnum>0)SELECTION TO ARRAY([ElementsSafety]ElementNo;$A)SELECTION TO ARRAY([ElementsSafety]Rating;$B)SELECTION TO ARRAY([ElementsSafety]Deficiency;$C)SELECTION TO ARRAY([ElementsSafety]Priority;$D)For ($i;30;33)  `Traffic Safety$p:=Get pointer("vR"+String($i))$q:=Get pointer("vD"+String($i))$elm:=Find in array($A;$i)If ($elm>0)$p->:=$B{$elm}If ($D{$elm}#"")$q->:=$C{$elm}+"-"+$D{$elm}Else $q->:=$C{$elm}End if Else $p->:="N"$q->:="N"End if If ($q->="N")$q->:=$vDeficiencyDefEnd if End for End if   `Check boxesIf ([Inspections]ClsdRoutine=True)vClsdR:="X"vClsdS:=""Else vClsdR:=""vClsdS:="X"End if   `Flags    If (([Inspections]PedBarricadesNE="A") | ([Inspections]PedBarricadesNE="B"))vPedAccess:="Y"Else vPedAccess:="N"End if If ([Inspections]RoadWayAbandon=True)vRoadAbd:="Y"Else vRoadAbd:="N"End if If ([Inspections]BarriersIP=True)vBarricades:="Y"Else vBarricades:="N"End if vLiftBucket:=Substring([Inspections]LiftBucket;2;1)vLadder:=Substring([Inspections]Ladder;2;1)vBoat:=Substring([Inspections]Boat;2;1)vWader:=Substring([Inspections]Wader;2;1)vInspect50:=Substring([Inspections]Inspector50;2;1)vRigging:=Substring([Inspections]Rigging;2;1)vStaging:=Substring([Inspections]Staging;2;1)vTraffic:=Substring([Inspections]Traffic Control;2;1)vFlagman:=Substring([Inspections]RR Flagman;2;1)vPolice:=Substring([Inspections]Police;2;1)vAccOther:=Substring([Inspections]OtherAccBool;2;1)vNeedLiftBucket:=Substring([Inspections]LiftBucket;1;1)vNeedLadder:=Substring([Inspections]Ladder;1;1)vNeedBoat:=Substring([Inspections]Boat;1;1)vNeedWader:=Substring([Inspections]Wader;1;1)vNeedInspect50:=Substring([Inspections]Inspector50;1;1)vNeedRigging:=Substring([Inspections]Rigging;1;1)vNeedStaging:=Substring([Inspections]Staging;1;1)vNeedTraffic:=Substring([Inspections]Traffic Control;1;1)vNeedFlagman:=Substring([Inspections]RR Flagman;1;1)vNeedPolice:=Substring([Inspections]Police;1;1)vNeedAccOther:=Substring([Inspections]OtherAccBool;1;1)If ([Inspections]Plans=True)vPlans:="Y"Else vPlans:="N"End if If ([Inspections]VCR=True)vVCR:="Y"Else vVCR:="N"End if If ([Inspections]ClosedSigns=True)vCldPost:=""vBrCldSgnNE:=[Inspections]BrCldSignsNEvBrCldSgnSW:=[Inspections]BrCldSignsSWvAdCldSgnNE:=[Inspections]AdCldSignsNEvAdCldSgnSW:=[Inspections]AdCldSignsSWElse vCldPost:="X"vBrCldSgnNE:=""vBrCldSgnSW:=""vAdCldSgnNE:=""vAdCldSgnSW:=""End if   `Get the year rehab'dvYrRehab:=[Inspections]YrRehabf_Var_to_Series ([Inspections]Cld_Schedule;"xS";"12345")vCld_Completion_Date:=Uppercase(String([Inspections]Cld_Completion_Date;Internal date short ))If ([Inspections]Cld_Completion_Date=!00/00/00!)vCld_Completion_Date:=""End if If ([Inspections]Cld_UnderConstruction=False)SET VISIBLE([Inspections]Cld_Contract_Number;False)SET VISIBLE([Inspections]Cld_Amount;False)SET VISIBLE(*;vCld_Completion_Date;False)SET VISIBLE([Inspections]Cld_Contractor;False)SET VISIBLE([Inspections]Cld_Resident_Engineer;False)SET VISIBLE([Inspections]Cld_Scope_of_Work;False)SET VISIBLE([Inspections]Cld_Remarks;False)End if G_Insp_SetDeptFont G_Insp_ApplyRev2_PR End case 