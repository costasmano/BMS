  `----------------------------------------------------  `User name (OS): Charles Miller  `Date and time: 02/16/12, 15:00:41  `----------------------------------------------------  `Method: ut_ControlLBSetUp  `Description  `This method controls creation of or load of records for LB where we are replacing included forms  ` Parameters  ` ----------------------------------------------------If (False)Mods_2012_02   `r001  `Modified by: Charles Miller (2/23/12 15:00:42)End if C_TEXT($1;$QueryName_txt)$QueryName_txt:=$1C_LONGINT($2)READ ONLY([LB_QueryTable])QUERY([LB_QueryTable];[LB_QueryTable]QueryName_s=$QueryName_txt)C_BOOLEAN($Continue_b)$Continue_b:=TrueCase of : (Records in selection([LB_QueryTable])=0)If (Current user="Designer")CREATE RECORD([LB_QueryTable])[LB_QueryTable]QueryName_s:=$QueryName_txt[LB_QueryTable]TableNumber_l:=$2[LB_QueryTable]TableName_s:=Table name([LB_QueryTable]TableNumber_l)[LB_QueryTable]WindowTitle_s:=""Inc_Sequence ("LB_QueryTable";->[LB_QueryTable]UniqueKey_l)LogNewRecord (->[LB_QueryTable]UniqueKey_l;->[LB_QueryTable]UniqueKey_l;->[LB_QueryTable]UniqueKey_l;0;"LB_QueryTable")InitChangeStack (1)PushChange (1;->[LB_QueryTable]QueryName_s)PushChange (1;->[LB_QueryTable]TableNumber_l)PushChange (1;->[LB_QueryTable]TableName_s)PushChange (1;->[LB_QueryTable]WindowTitle_s)FlushGrpChgs (1;->[LB_QueryTable]UniqueKey_l;->[LB_QueryTable]UniqueKey_l;->[LB_QueryTable]UniqueKey_l;0)SAVE RECORD([LB_QueryTable])Else End if : (Records in selection([LB_QueryTable])=1)Else $Continue_b:=FalseALERT("Design of this search "+$QueryName_txt+" is corrupted. Contact database adminstrator")End case If ($Continue_b)If (Current user="Designer") & (Shift down)ut_LoadRecordInteractiveV2 (->[LB_QueryTable])Else LOAD RECORD([LB_QueryTable])End if Else CANCELEnd if   `End ut_ControlLBSetUp