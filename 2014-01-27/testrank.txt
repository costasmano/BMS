QUERY([Bridge MHD NBIS];[Bridge MHD NBIS]FHWARecord=True)C_TIME($st;$en)$st:=Current timeFIRST RECORD([Bridge MHD NBIS])ARRAY REAL($rankfactor;Records in selection([Bridge MHD NBIS]))ARRAY STRING(3;$bins;Records in selection([Bridge MHD NBIS]))SHORT_MESSAGE ("calculating factor.....")While (Not(End selection([Bridge MHD NBIS])))BridgeRankingCalculation $rankfactor{Selected record number([Bridge MHD NBIS])}:=BridgeRankingRankFactor$bins{Selected record number([Bridge MHD NBIS])}:=[Bridge MHD NBIS]BIN[Bridge MHD NBIS]Rank:=BridgeRankingRankFactorSAVE RECORD([Bridge MHD NBIS])NEXT RECORD([Bridge MHD NBIS])End while $en:=Current timeCLOSE WINDOWSORT ARRAY($rankfactor;$bins)$st:=Current timeSHORT_MESSAGE ("storing rank.....")FIRST RECORD([Bridge MHD NBIS])While (Not(End selection([Bridge MHD NBIS])))[Bridge MHD NBIS]Rank:=Find in array($bins;[Bridge MHD NBIS]BIN)If ([Bridge MHD NBIS]Rank#Old([Bridge MHD NBIS]Rank))LogChanges (->[Bridge MHD NBIS]Rank;->[Bridge MHD NBIS]BIN;->[Bridge MHD NBIS]BIN;->[Bridge MHD NBIS]BIN;0)End if SAVE RECORD([Bridge MHD NBIS])NEXT RECORD([Bridge MHD NBIS])End while $en:=Current timeCLOSE WINDOW