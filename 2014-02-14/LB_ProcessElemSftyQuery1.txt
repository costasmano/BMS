ÊÊ`Method: LB_ProcessElemSftyQuery1ÊÊ`DescriptionÊÊ`ÊÊ` ParametersÊÊ` $0 : ReturnCode - default 0ÊÊ` ----------------------------------------------------If (False)ÊÊ`----------------------------------------------------ÊÊ`User name (OS): Charles MillerÊÊ`Date and time: 01/03/12, 14:56:58ÊÊ`----------------------------------------------------Mods_2011_12 ÊÊ`r004ÊÊ`Modified by: Charles Miller (1/3/12 14:56:59)ÊÊ` Modified by: Costas Manousakis-(Designer)-(10/24/13 11:19:39)Mods_2013_10 ÊÊ`ÊÊ`use  method  INSP_IsInspRoutine_b to check if inspection is a routine oneÊÊ` Modified by: Costas Manousakis-(Designer)-(2/12/14 12:33:12)Mods_2014_02_bug ÊÊ`ÊÊ`Made  vars for ELEMSafetyQuery2 non enterableEnd if C_LONGINT($0)$0:=0Case of : (Form event=On Load )C_LONGINT($ColumnNumber_l)C_TEXT($ColumnName_txt;$HeaderVarName_txt)C_POINTER($HeaderVar_ptr;$ColumnVar_ptr)SET LISTBOX TABLE SOURCE(*;"SelectListBox";[LB_QueryTable]TableNumber_l)ÊÊ`Column 1$ColumnNumber_l:=1LB_SetUPFieldColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$HeaderVar_ptr;->$ColumnName_txt)INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;[Inspection Type]Description;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(LB_Header1_l;"Type")ÊÊ`Column 2$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPFieldColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$HeaderVar_ptr;->$ColumnName_txt)INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;[Inspections]BIN;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(LB_Header2_l;"BIN")SET ALIGNMENT(*;$ColumnName_txt;Center )ÊÊ`Column 3$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPFieldColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$HeaderVar_ptr;->$ColumnName_txt)INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;[Bridge MHD NBIS]BDEPT;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(LB_Header3_l;"BDEPT")SET ALIGNMENT(*;$ColumnName_txt;Center )ÊÊ`Column 4$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPFieldColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$HeaderVar_ptr;->$ColumnName_txt)INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;[Inspections]Insp Date;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(LB_Header4_l;"Inspection Date")SET ALIGNMENT(*;$ColumnName_txt;Center )If ([LB_QueryTable]QueryName_s="ELEMSafetyQuery2")ÊÊ`addin remaining columnsÊÊ`Column 5$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPVariableColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$ColumnVar_ptr;->$HeaderVar_ptr;->$ColumnName_txt;"txt")INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;$ColumnVar_ptr->;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(LB_Header5_l;"Item No")SET ALIGNMENT(*;$ColumnName_txt;Center )SET ENTERABLE(*;$ColumnName_txt;False)ÊÊ`Column 6$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPVariableColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$ColumnVar_ptr;->$HeaderVar_ptr;->$ColumnName_txt;"txt")INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;$ColumnVar_ptr->;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(LB_Header6_l;"Description")SET ENTERABLE(*;$ColumnName_txt;False)ÊÊ`Column 7$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPFieldColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$HeaderVar_ptr;->$ColumnName_txt)INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;[ElementsSafety]Rating;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(LB_Header7_l;"Cur")SET ALIGNMENT(*;$ColumnName_txt;Center )ÊÊ`Column 8$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPFieldColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$HeaderVar_ptr;->$ColumnName_txt)INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;[ElementsSafety]AltRating;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(LB_Header8_l;"Dive")SET ALIGNMENT(*;$ColumnName_txt;Center )ÊÊ`Column 9$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPFieldColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$HeaderVar_ptr;->$ColumnName_txt)INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;[ElementsSafety]Deficiency;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(LB_Header9_l;"Def")SET ALIGNMENT(*;$ColumnName_txt;Center )ÊÊ`Column 10$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPFieldColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$HeaderVar_ptr;->$ColumnName_txt)INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;[ElementsSafety]Priority;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(LB_Header10_l;"Prio")SET ALIGNMENT(*;$ColumnName_txt;Center )ÊÊ`Column 11$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPFieldColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$HeaderVar_ptr;->$ColumnName_txt)INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;[ElementsSafety]Comment Flag;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(LB_Header11_l;"T")SET ALIGNMENT(*;$ColumnName_txt;Center )End if : (Form event=On Display Detail )If ([LB_QueryTable]QueryName_s="ELEMSafetyQuery2")ÊÊ`addin remaining columnsC_LONGINT($Element_l)LB_Detail5_txt:=INSP_ElmtSfty_ItemNo ([ElementsSafety]ElementNo)LB_Detail6_txt:=GetElmtNumber +" "+[ElementsSafety]DescriptionIf (INSP_IsInspRoutine_b )If ([ElementsSafety]SpecMemb Flag)LB_Detail6_txt:=LB_Detail6_txt+" - (Spec.Mb.)"End if LB_RowStyle_l:=0If (([ElementsSafety]ElementNo=300)Ê|Ê([ElementsSafety]ElementNo=313)Ê|Ê([ElementsSafety]ElementNo=325))LB_RowStyle_l:=Bold End if End if End if : (Form event=On Header Click )If ([LB_QueryTable]QueryName_s="ELEMSafetyQuery2")ÊÊ`addin remaining columnsC_TEXT($NameofObj_txt)C_LONGINT($dumTbl_L;$dumFld_L)RESOLVE POINTER(Self;$NameofObj_txt;$dumTbl_L;$dumFld_L)Case of : ($nameofObj_txt="LB_Header5_l")If (LB_SortDirection5_l=0)ORDER BY FORMULA([ElementsSafety];INSP_ElmtSfty_ItemNo ([ElementsSafety]ElementNo);>)LB_SortDirection5_l:=1LB_Header5_l:=1Else ORDER BY FORMULA([ElementsSafety];INSP_ElmtSfty_ItemNo ([ElementsSafety]ElementNo);<)LB_SortDirection5_l:=0LB_Header5_l:=2End if $0:=-1: ($nameofObj_txt="LB_Header6_l")If (LB_SortDirection6_l=0)ORDER BY FORMULA([ElementsSafety];GetElmtNumber +" "+[ElementsSafety]Description;>)LB_SortDirection6_l:=1LB_Header6_l:=1Else ORDER BY FORMULA([ElementsSafety];GetElmtNumber +" "+[ElementsSafety]Description;<)LB_Header6_l:=2LB_SortDirection6_l:=0End if $0:=-1End case End if End case ÊÊ`End LB_ProcessElemSftyQuery1