  `Method: ut_UpdateSysParameter  `Description  `Update or Create a system parameter. (create is only available for design group users)  ` Parameters  ` $1 : $ParamName_txt  ` $2 : $Additional_txt - additional text to be shown with the prompt  ` $3 : $EditValue_txt optional : if it starts with "V" the value field will be updated ; else the description field (default)  ` ----------------------------------------------------If (False)  ` ----------------------------------------------------  `User name (OS): Costas Manousakis  `User (4D) : Designer  `Date and time: 01/21/14, 15:42:34  ` ----------------------------------------------------  `Created : Mods_2014_01 End if   `C_TEXT($1;$ParamName_txt)$ParamName_txt:=$1C_BOOLEAN($EditValue_b)$EditValue_b:=False  `default edit the descr fieldC_TEXT($Additional_txt)$Additional_txt:=""If (Count parameters>1)C_TEXT($2)$Additional_txt:=$2End if If (Count parameters>2)C_TEXT($3)$EditValue_b:=($3="V@")End if C_BOOLEAN($FoundParam_B)$FoundParam_B:=TrueQUERY([Parameters];[Parameters]ParamCode=$ParamName_txt)If (Records in selection([Parameters])#1)If (User in group(Current user;"Design Access Group"))CONFIRM("Parameter "+$ParamName_txt+" not found! Create it?")If (OK=1)CREATE RECORD([Parameters])[Parameters]ParamCode:=$ParamName_txtSAVE RECORD([Parameters])LogNewRecord (->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0;"")Else $FoundParam_B:=FalseEnd if Else ALERT("System Parameter "+$ParamName_txt+" does not exist!!! Please notify your database administrator!")$FoundParam_B:=FalseEnd if End if If ($FoundParam_B)If (ut_LoadRecordInteractive (->[Parameters]))C_TEXT(vtExtraText;vsExtraTextLabel)If ($EditValue_b)vtExtraText:=[Parameters]ValueElse vtExtraText:=[Parameters]DescriptionEnd if vsExtraTextLabel:="Update system parameter "+$ParamName_txtIf ($Additional_txt#"")vsExtraTextLabel:=vsExtraTextLabel+" "+$Additional_txtEnd if C_LONGINT($Width_l;$Height_l;$Win_l;$Pages_l)C_BOOLEAN($FixedWidth_b;$FixedHeight_b)C_TEXT($Title_txt)GET FORM PROPERTIES([Dialogs];"GetInspExtraCmts";$Width_l;$Height_l;$Pages_l;$FixedWidth_b;$FixedHeight_b;$Title_txt)$Win_l:=ut_OpenNewWindow ($Width_l;$Height_l;0;Plain form window ;"System Parameter Update")DIALOG([Dialogs];"GetInspExtraCmts")CLOSE WINDOWIf (Ok=1)If ($EditValue_b)[Parameters]Value:=vtExtraTextLogChanges (->[Parameters]Value;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)Else [Parameters]Description:=vtExtraTextLogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)End if SAVE RECORD([Parameters])UNLOAD RECORD([Parameters])End if Else ALERT("Could not load record for Parameter "+$ParamName_txt+" for updating")End if Else End if   `End ut_UpdateSysParameter