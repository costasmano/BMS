ÊÊ` Method: RtgReq_UtilityÊÊ` DescriptionÊÊ` Utiltiy method  for RatingRequestsÊÊ` ParametersÊÊ` $1 : $Task_txt ("SETUPSYSPARAMS" | "STARTOUTPUTLIST" | "DEFAULTSORT" | "LOADCBARRAYS" | ÊÊ`ÊÊ` "LOADCONTRACTS" | "LOADASSIGNMENTS"ÊÊ` ----------------------------------------------------If (False)ÊÊ` User name (OS): Costas ManousakisÊÊ` User name (4D): DesignerÊÊ` Date and time: 01/16/14, 10:56:50ÊÊ` ----------------------------------------------------ÊÊ` First ReleaseMods_2014_01 End if C_TEXT($1;$Task_txt)$Task_txt:=$1Case of : ($Task_txt="SETUPSYSPARAMS")C_TEXT($prompt_txt)$prompt_txt:=" - Enter comma separated values with no spaces between values"ut_UpdateSysParameter ("RTGREQ_Priority";$prompt_txt)ut_UpdateSysParameter ("RTGREQ_AEActions";$prompt_txt)ut_UpdateSysParameter ("RTGREQ_BIEActions";$prompt_txt)ut_UpdateSysParameter ("RTGREQ_StEActions";$prompt_txt)ut_UpdateSysParameter ("RTGREQ_Status";$prompt_txt): ($Task_txt="STARTOUTPUTLIST")C_TEXT($LB_BaseName_txt)$LB_BaseName_txt:="RtgReq"QUERY([RatingRequests];[RatingRequests]Status_s#"Assigned";*)QUERY([RatingRequests];Ê&Ê;[RatingRequests]Status_s#"Rejected@")LB_Tasks ("CLEARHEADERS";$LB_BaseName_txt)LB_Tasks ("DESELECTALL";$LB_BaseName_txt)LB_Tasks ("SETWINDOWTITLE";$LB_BaseName_txt): ($Task_txt="DEFAULTSORT")SET AUTOMATIC RELATIONS(True;True)ORDER BY([RatingRequests];[Bridge MHD NBIS]Item2;>;[Bridge MHD NBIS]BDEPT;>)SET AUTOMATIC RELATIONS(False;False): ($Task_txt="LOADCBARRAYS")ARRAY TEXT(RtgReq_AEAction_cb;0)ARRAY TEXT(RtgReq_Prio_cb;0)ARRAY TEXT(RtgReq_BIEAction_cb;0)ARRAY TEXT(RtgReq_StEAction_cb;0)ARRAY TEXT(RtgReq_Status_cb;0)C_TEXT($ParamValue_txt)$ParamValue_txt:=ut_GetSysParameter ("RTGREQ_Priority")ut_TextToArray ($ParamValue_txt;->RtgReq_Prio_cb)$ParamValue_txt:=ut_GetSysParameter ("RTGREQ_AEActions")ut_TextToArray ($ParamValue_txt;->RtgReq_AEAction_cb)$ParamValue_txt:=ut_GetSysParameter ("RTGREQ_BIEActions")ut_TextToArray ($ParamValue_txt;->RtgReq_BIEAction_cb)$ParamValue_txt:=ut_GetSysParameter ("RTGREQ_StEActions")ut_TextToArray ($ParamValue_txt;->RtgReq_StEAction_cb)$ParamValue_txt:=ut_GetSysParameter ("RTGREQ_Status")ut_TextToArray ($ParamValue_txt;->RtgReq_Status_cb): ($Task_txt="LOADCONTRACTS")QUERY([Contracts];[Contracts]ContractType="@rating";*)QUERY([Contracts];Ê|Ê;[Contracts]ContractType="")ARRAY LONGINT(RtgReq_Contracts_cb;0)ARRAY TEXT($contracts_atxt;0)SELECTION TO ARRAY([Contracts]ContractNo;$contracts_atxt)ARRAY LONGINT(RtgReq_Contracts_cb;Size of array($contracts_atxt))C_LONGINT($loop_L)For ($loop_L;1;Size of array(RtgReq_Contracts_cb))RtgReq_Contracts_cb{$loop_L}:=Num($contracts_atxt{$loop_L})End for SORT ARRAY(RtgReq_Contracts_cb;>): ($Task_txt="LOADASSIGNMENTS")QUERY([Contract Assignments];[Contract Assignments]ContractNo=String([RatingRequests]ContractNo_L))SELECTION TO ARRAY([Contract Assignments]AssignNo;RtgReq_ContrAssign_cb)SORT ARRAY(RtgReq_ContrAssign_cb;>)End case 