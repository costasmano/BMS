ÊÊ` Method: RtgReq_LB_OMÊÊ` DescriptionÊÊ` ÊÊ` ÊÊ` ParametersÊÊ` $1 : $FormEvent_LÊÊ` ----------------------------------------------------If (False)ÊÊ` User name (OS): Costas ManousakisÊÊ` User name (4D): DesignerÊÊ` Date and time: 01/14/14, 15:11:21ÊÊ` ----------------------------------------------------ÊÊ` First ReleaseMods_2014_01 End if C_LONGINT($0)$0:=0C_LONGINT($FormEvent_L)If (Count parameters>0)C_LONGINT($1)$FormEvent_L:=$1Else $FormEvent_L:=Form eventEnd if Case of : ($FormEvent_L=On Display Detail )QUERY([Bridge MHD NBIS];[Bridge MHD NBIS]BIN=[RatingRequests]BIN): ($FormEvent_L=On Double Clicked )ÊÊ`COPY NAMED SELECTION([RatingRequests];"LBSELECTIONRTGREQ")If (RtgReq_Edit_b )READ WRITE([RatingRequests])READ WRITE([AddtlRatingRequests])End if LB_Tasks ("DOUBLECLICK";"RtgReq")ÊÊ`If (LB_Tasks ("DOUBLECLICK";"RtgReq")=1)ÊÊ`ÊÊ`what happens if you delete something???????ÊÊ`ÊÊ`USE NAMED SELECTION("LBSELECTIONRTGREQ")ÊÊ`ÊÊ`CLEAR NAMED SELECTION("LBSELECTIONRTGREQ")REDRAW(RtgReq_LB)ÊÊ`End if READ ONLY([RatingRequests])READ ONLY([AddtlRatingRequests])UNLOAD RECORD([RatingRequests])UNLOAD RECORD([AddtlRatingRequests]): ($FormEvent_L=On Clicked )C_LONGINT($LBCol_L;$LBRow_L;$SelectedRow_L;$Ret_L;$MinRet_L;$MaxRet_L)GET LISTBOX CELL POSITION(*;"RtgReq_LB";$LBCol_L;$LBRow_L)C_LONGINT($Popupchoice_L)C_TEXT($Popupmenu_txt)If ((Right click)Ê|Ê(Macintosh control down))$Popupchoice_L:=Pop up menu($Popupmenu_txt)Case of : ($Popupchoice_L=1)End case End if : ($FormEvent_L=On Load ): ($FormEvent_L=On After Sort ): ($FormEvent_L=On Header Click )C_TEXT($NameofObj_txt)C_LONGINT($dumTbl_L;$dumFld_L)RESOLVE POINTER(Self;$NameofObj_txt;$dumTbl_L;$dumFld_L)ÊÊ`ALERT("Click on header "+$nameofObj_txt)SET AUTOMATIC RELATIONS(True;True)Case of : ($nameofObj_txt="Header10")ÊÊ`DistIf ((Self->=2)Ê|Ê(Self->=0))ÊÊ`ORDER BY FORMULA([RatingRequests];RtgReq_GetBridgeInfo ([RatingRequests]BIN;->[Bridge MHD NBIS]Item2);>)ORDER BY([RatingRequests];[Bridge MHD NBIS]Item2;>)Self->:=1Else ÊÊ`ORDER BY FORMULA([RatingRequests];RtgReq_GetBridgeInfo ([RatingRequests]BIN;->[Bridge MHD NBIS]Item2);<)ORDER BY([RatingRequests];[Bridge MHD NBIS]Item2;<)Self->:=2End if $0:=-1: ($nameofObj_txt="Header2")ÊÊ`BDEPTIf ((Self->=2)Ê|Ê(Self->=0))ÊÊ`ORDER BY FORMULA([RatingRequests];RtgReq_GetBridgeInfo ([RatingRequests]BIN;->[Bridge MHD NBIS]BDEPT);>)ORDER BY([RatingRequests];[Bridge MHD NBIS]BDEPT;>)Self->:=1Else ÊÊ`ORDER BY FORMULA([RatingRequests];RtgReq_GetBridgeInfo ([RatingRequests]BIN;->[Bridge MHD NBIS]BDEPT);<)ORDER BY([RatingRequests];[Bridge MHD NBIS]BDEPT;<)Self->:=2End if $0:=-1: ($nameofObj_txt="Header4")ÊÊ`PriorityIf ((Self->=2)Ê|Ê(Self->=0))ORDER BY FORMULA([RatingRequests];RtgReq_SortByPriority ;>)Self->:=1Else ORDER BY FORMULA([RatingRequests];RtgReq_SortByPriority ;<)Self->:=2End if $0:=-1End case SET AUTOMATIC RELATIONS(False;False)End case 