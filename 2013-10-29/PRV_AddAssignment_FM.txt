  ` Method: PRV_AddAssignment_FM  ` Description  `   `   ` Parameters  ` $1 : $FormEvent_L  ` ----------------------------------------------------If (False)  ` User name (OS): Costas Manousakis  ` User name (4D): Designer  ` Date and time: 02/11/13, 09:35:27  ` ----------------------------------------------------  ` First ReleaseMods_2013_02   ` Modified by: Costas Manousakis-(Designer)-(9/25/13 15:02:54)Mods_2013_09   `  `Copied to DEV  ` Modified by: Costas Manousakis-(Designer)-(10/29/13 16:20:32)Mods_2013_10   `  `changed dialog to use vars instead of fieldsEnd if C_LONGINT($FormEvent_L)If (Count parameters>0)C_LONGINT($1)$FormEvent_L:=$1Else $FormEvent_L:=Form eventEnd if C_LONGINT($ContinueButton_L)$ContinueButton_L:=-15Case of : ($FormEvent_L=On Display Detail ): ($FormEvent_L=On Close Detail ): ($FormEvent_L=On Data Change )[Contract_Assignment_Maintenance]ContractNo:=PRV_ADD_Contract_txt[Contract_Assignment_Maintenance]ProjectIS:=PRV_ADD_ProjInfoNum_txt[Contract_Assignment_Maintenance]AssignNo:=PRV_ADD_AssignNo_LPRV_Variables ("RELATEPINFO"): ($FormEvent_L=On Load )  `DISABLE BUTTON(*;"PRVContinue")REDUCE SELECTION([PRJ_DesignContracts];0)REDUCE SELECTION([PRJ_ProjectDetails];0)PRV_ADD_Contract_txt:=""PRV_ADD_ProjInfoNum_txt:=""PRV_ADD_AssignNo_L:=0: ($FormEvent_L=On Validate ): ($FormEvent_L=On Unload ): ($FormEvent_L=$ContinueButton_L)C_TEXT($WarningMsg_txt)$WarningMsg_txt:=""Case of : ([Contract_Assignment_Maintenance]ProjectIS="")$WarningMsg_txt:="No Project Number Entered!"+Char(13): (Records in selection([PRJ_ProjectFile])=0)$WarningMsg_txt:="Project Number Not Found in database!"+Char(13)End case Case of : ([Contract_Assignment_Maintenance]ContractNo="")$WarningMsg_txt:=$WarningMsg_txt+"No Contract Number Entered!"+Char(13): (Records in selection([PRJ_DesignContracts])=0)$WarningMsg_txt:=$WarningMsg_txt+"Contract Number Not Found in database!"+Char(13)End case If ($WarningMsg_txt="")ACCEPTElse CONFIRM($WarningMsg_txt+"Continue with New Assignment?")If (OK=1)ACCEPTEnd if End if End case 