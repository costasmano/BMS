If (False)  `Procedure: FieldsToArray(file ptr;array ptr;array ptr;boolean;boolean;array ptr)  `ACI University Programming Classes  `Generic ACI Shell Programming  `Created By:  Jim Steinman  `Date:  10/5/95  `Legend:  `$1 - pointer to file to copy fieldnames from.  `$2 - pointer to array to put fieldnames into.  `$3 - pointer to array to put pointers to fields into.  `$4 - if true, only copy indexed fields.  `$5 - (Optional) if true, include invisible fields  `Purpose: Copies fieldnames into an array and copies field pointers into second a  `Picture fields and subfiles are not copied.◊fGeneric:=False◊f_Ver1x20:=False◊fJ_Steinman:=False  `Modification by Tom Nee, 1/28/98.  `$6 - (Optional) pointer to array of field types and lengths.  ` Modified by: Costas Manousakis-(Designer)-(10/16/13 10:01:53)Mods_2013_10   `  `Replaced Insert in Array with Append to ArrayEnd if C_POINTER($1;$2;$3;$6;$pField)C_LONGINT($i;$j;$LType;$LLen;$LFileNum;$LParms;$LInvisible;$LRelatFile;$LRelatField;$LAttribute)C_STRING(30;$sChoiceList)C_BOOLEAN($4;$5;$fIndexed;$DoTypes;$vbUnique;$vbInvisible;$vbInvisChk)C_STRING(8;$Ltype_s)  `SetCursor is now Set Cursor in v6.5  `Change made on 6 02 00  `SetCursor(4)SET CURSOR(4)$LParms:=Count parametersIf ($LParms>=5)  `added this one....$vbInvisChk:=$5End if If ($LParms=6)$DoTypes:=TrueEnd if $LFileNum:=Table($1)  `Get the file number we are using$j:=0For ($i;1;Get last field number($1))$pField:=Field(Table($1);$i)  `Get a pointer to the fieldGET FIELD PROPERTIES($pField;$LType;$LLen;$fIndexed;$vbUnique;$vbInvisible)If (($LType#Is Picture ) & ($LType#Is Subtable ) & ($LType#Is BLOB ))  `not a picture, Blob field or a subfileIf ((Not($4)) | (($4) & ($fIndexed)))  `If indexed or including all fields regardless of indexIf (Not(($vbInvisible & ($LParms>=5))))  `($LInvisible=0)  `Include if not invisible or not checking$j:=$j+1  `INSERT IN ARRAY($2->;$j)  `ARRAY STRING(19;$2->;$j)  `$2->{$j}:=Substring(sFriendlyName (Field name($pField));1;19)  `make sure we get only 19 charsAPPEND TO ARRAY($2->;Substring(sFriendlyName (Field name($pField));1;19))  `INSERT IN ARRAY($3->;$j)  `ARRAY POINTER($3->;$j)  `$3->{$j}:=$pFieldAPPEND TO ARRAY($3->;$pField)If ($DoTypes)  `INSERT IN ARRAY($6->;$j)  `ARRAY STRING(8;$6->;$j)Case of : ($LType=Is Alpha Field )$Ltype_s:="Char*"+String($LLen)  `String: ($LType=Is Real )$Ltype_s:="Real"  `Real: ($LType=Is Text )$Ltype_s:="Text"  `Text: ($LType=Is Date )$Ltype_s:="Date"  `Date: ($LType=Is Boolean )$Ltype_s:="Boolean"  `Boolean: ($LType=Is Integer )$Ltype_s:="Integer"  `Integer: ($LType=Is LongInt )$Ltype_s:="Long Int"  `Long Integer: ($LType=Is Time )$Ltype_s:="Time"  `TimeElse $Ltype_s:="?"End case APPEND TO ARRAY($6->;$Ltype_s)End if End if End if End if End for   `SetCursor is now Set Cursor in v6.5  `Change made on 6 02 00  `SetCursor(0)SET CURSOR(0)  `CLOSE WINDOW  `End of procedure 