If (False)ÊÊ` ----------------------------------------------------ÊÊ` User name (OS): costasmanousakisÊÊ` User name (4D): DesignerÊÊ` Date and time: 02/22/09, 19:15:23ÊÊ` ----------------------------------------------------ÊÊ` Method: INSP_FRZ_PrintCmtsÊÊ` DescriptionÊÊ` ÊÊ` ÊÊ` ParametersÊÊ` $0 : $NumPages_LÊÊ` $1 : $PrintFlag_bÊÊ` ----------------------------------------------------Mods_2009_CM_5404 ÊÊ` --- "FREEZETHAW"Mods_2011_06 ÊÊ` CJ Miller`06/14/11, 13:25:05      ` Type all local variables for v11ÊÊ` Modified by: Costas Manousakis-(Designer)-(12/27/12 11:37:09)Mods_2012_12 ÊÊ`ÊÊ` Clear picture var CommentsPrevw_P when done printingÊÊ` Modified by: Costas Manousakis-(Designer)-(2/18/14 14:32:47)Mods_2014_02ÊÊ`ÊÊ`Freeze thaw New VersionEnd if C_BOOLEAN(PrintFlag)C_LONGINT($0;$numpages)If (Count parameters>0)C_BOOLEAN($1)PrintFlag:=$1Else PrintFlag:=TrueEnd if C_BLOB(vCmtsArea_)C_LONGINT($i;$numpages;$numnewpages)C_LONGINT($mainarea;$temparea;$count)C_STRING(132;$vElmTitle)C_LONGINT($numphotos;$printht)$numphotos:=Records in selection([Standard Photos])$numpages:=0ÊÊ`create main offscreen area$mainarea:=WR New offscreen area WR UPDATE MODE ($mainarea;0)ÊÊ`turn off updatingSet Doc Margins ($mainarea)SET CURSOR(4)vbTopOfPage:=TrueÊÊ`say we start from top of pageC_LONGINT($loop)For ($loop;1;Size of array(FRZ_CommentsFit_b);2)If (FRZ_CommentsFit_b{$Loop}Ê|ÊFRZ_CommentsFit_b{$Loop+1})C_TEXT($ElmtDesc_txt)GOTO SELECTED RECORD([ElementsSafety];($loop+1)/2)Case of : ([ElementsSafety]ElementNo=41)$ElmtDesc_txt:="Deck (Underside) / Arch Ring": ([ElementsSafety]ElementNo=42)$ElmtDesc_txt:="Beams and Diaphragms": ([ElementsSafety]ElementNo=43)$ElmtDesc_txt:="Concrete Piers / Pier Caps / Columns / Abutments": ([ElementsSafety]ElementNo=44)$ElmtDesc_txt:="Others (i.e. Parapets, Haunches, Spandrel Walls, etc.)"Else $ElmtDesc_txt:=""End case WR SET TEXT PROPERTY ($mainarea;wr bold ;1)WR SET TEXT PROPERTY ($mainarea;wr underline ;1)WR INSERT TEXT ($mainarea;($ElmtDesc_txt+×sCR))WR EXECUTE COMMAND ($mainarea;wr cmd plain )If (FRZ_CommentsFit_b{$Loop})BLOB TO VARIABLE([ElementsSafety]ElmComments;$ElmtDesc_txt)WR SET TEXT PROPERTY ($mainarea;wr bold ;1)WR SET TEXT PROPERTY ($mainarea;wr underline ;1)WR INSERT TEXT ($mainarea;("Problem Areas :"+×sCR))WR EXECUTE COMMAND ($mainarea;wr cmd plain )WR INSERT TEXT ($mainarea;($ElmtDesc_txt+×sCR))End if If (FRZ_CommentsFit_b{$Loop+1})WR SET TEXT PROPERTY ($mainarea;wr bold ;1)WR SET TEXT PROPERTY ($mainarea;wr underline ;1)If ([Inspections]Insp Date<×InspFormRevDate_7)WR INSERT TEXT ($mainarea;("Action Taken :"+×sCR))Else WR INSERT TEXT ($mainarea;("Description :"+×sCR))End if WR EXECUTE COMMAND ($mainarea;wr cmd plain )WR INSERT TEXT ($mainarea;([ElementsSafety]Comments+×sCR))End if WR INSERT TEXT ($mainarea;(×sCR))End if End for If ($numphotos>0)ÊÊ` get photo titles in arrayG_CreateImageLog ($mainarea)vbTopOfPage:=FalseÊÊ`we have added something to the pageEnd if $count:=WR Count ($mainarea;wr nb characters )If ($count>0)ÊÊ`There was something added - not a blank page...ÊÊ` make sure we go to the bottom of page.?$numpages:=WR Count ($mainarea;wr nb pages )$numnewpages:=$numpagesWhile ($numnewpages=$numpages)WR INSERT TEXT ($mainarea;×sCR)$numnewpages:=WR Count ($mainarea;wr nb pages )End while ÊÊ`maybe we do maybe we dont't know why we do not need to delete the last line feedWR BACKSPACE ($mainarea)$numpages:=WR Count ($mainarea;wr nb pages )WR UPDATE MODE ($mainarea;1)ÊÊ`turn on updatingIf ((PrintFlag)Ê&Ê(viInspPreviewErr=0))ÊÊ`MODS_XXXX_CMC_PICTURE(CommentsPrevw_P)For ($i;1;$numpages)CommentsPrevw_P:=WR Build preview ($mainarea;$i)PAGE BREAK(>)$printht:=Print form([Inspections];"CmtsPrint")If (viInspPreviewErr#0)ÊÊ`exit if preview error$i:=$numpages+1End if End for CommentsPrevw_P:=CommentsPrevw_P*0End if ÊÊ`if Printflag and not(previewerror)$0:=$numpagesEnd if ÊÊ`if count of chars > 0ÊÊ`delete the main offscreen areaWR DELETE OFFSCREEN AREA ($mainarea)SET CURSOR$0:=$numpages