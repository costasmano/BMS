If (False)  ` ----------------------------------------------------  ` User name (OS): costasmanousakis  ` User name (4D): Designer  ` Date and time: 02/16/09, 20:41:40  ` ----------------------------------------------------  ` Method: Method: Print_Freeze_pg1  ` Description  `   `   ` Parameters  ` $0 : $NumPages  ` $1 : PrintFlag  ` ----------------------------------------------------If (False)DIALOG([Inspections];"FrzThawPg1")End if Mods_2009_CM_5404   ` --- "FREEZETHAW"  ` Modified by: costasmanousakis-(Designer)-(4/9/09 19:26:19)Mods_2009_04   `  `When running the method with PrintFlag=False (ie checking page numbers), direct the print output to  `  `a temp file and then delete the file. Avoids blank pages.  ` Modified by: costasmanousakis-(Designer)-(4/29/09 19:26:19)Mods_2009_04   `  `Fixed the SET PRINT OPTION(Destination option ;2;$tempFile_txt) - used to have option 3  `  `which worked on a MAC, but gave errors when trying to delete the temp file on a PC.Mods_2011_06   ` CJ Miller`06/14/11, 13:25:05      ` Type all local variables for v11  ` Modified by: Costas Manousakis-(Designer)-(2/18/14 13:41:38)Mods_2014_02  `  `New Freeze thawEnd if C_BOOLEAN(PrintFlag)C_LONGINT($0;$NumPages)If (Count parameters>0)C_BOOLEAN($1)PrintFlag:=$1Else PrintFlag:=TrueEnd if G_Insp_RelateInsp (->[ElementsSafety]InspID)ARRAY BOOLEAN(FRZ_CommentsFit_b;8)  `2 for each of the freeze thaw itemsC_INTEGER($recnum;$i;$numGrps;$j;$k;$viElmtsPerPage;$viElmtsPerPage2)C_STRING(40;$vsInspFormName;$vsInspFormName2)C_INTEGER(vPageno)  `Sort by element no.If ([Inspections]Insp Date<◊InspFormRevDate_7)$vsInspFormName:="FrzThawPg1"Else $vsInspFormName:="FrzThawPg1A"End if ORDER BY([ElementsSafety];[ElementsSafety]ElementNo;>)ARRAY LONGINT($alAllElmts;0)C_LONGINT($lElmtRecIDNum;$Loop)vPageNo:=1If (Not(PrintFlag))C_TEXT($tempFile_txt)$tempFile_txt:=Temporary folder+"FRZ_"+ut_CreateTimeStamp +".tmp"SET PRINT OPTION(Destination option ;2;$tempFile_txt)PAGE BREAKEnd if $lElmtRecIDNum:=Print form([Inspections];$vsInspFormName)If (Not(PrintFlag))PAGE BREAKSET PRINT OPTION(Destination option ;1;"")DELETE DOCUMENT($tempFile_txt)End if   `now see if everything  fitC_BOOLEAN($AllFit_b)$AllFit_b:=FalseFor ($Loop;1;Size of array(FRZ_CommentsFit_b))$AllFit_b:=$AllFit_b | FRZ_CommentsFit_b{$Loop}End for If ($AllFit_b)  `PAGE BREAK(>) `not needed here????$NumPages:=INSP_FRZ_PrintCmts (PrintFlag)+1Else $NumPages:=1End if $0:=$NumPages