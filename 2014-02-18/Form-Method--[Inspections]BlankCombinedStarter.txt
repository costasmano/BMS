If (False)  `Form Method: [Inspections];"BlankCombinedStarter"  `Used to open the required input form depending on the inspection typeMods_2005_CM06 Mods_2005_VN01   ` Modified by: costasmanousakis-(Designer)-(2/21/2006 10:31:49)Mods_2006_CM03   ` Modified by: costasmanousakis-(Designer)-(2/27/2006 14:05:58)Mods_2006_CM03   ` Modified by: costasmanousakis-(Designer)-(11/3/06 17:26:14)Mods_2006_CM07   ` Modified by: costasmanousakis-(Designer)-(12/4/07 14:20:57)Mods_2007_CM_5401   `make sure the Bridge MHD NBIS record is in readonly mode so we don't lock it  `  `  `Also hide the 'Press this button' button until we exit the form...  ` Modified by: costasmanousakis-(Designer)-(12/20/07 12:18:35)Mods_2007_CM_5401   `Set  [Element Cat] [ElementDict] tables to read only  ` Modified by: costasmanousakis-(Designer)-(5/1/08 16:51:40)Mods_2008_CM_5403   `  `Allow access to users belonging to MHDInspectionROAccess group when  `  `the inspection has been completed  ` Modified by: costasmanousakis-(Designer)-(2/16/09 11:58:16)Mods_2009_CM_5404   ` --- "FREEZETHAW"  ` Modified by: costasmanousakis-(Designer)-(4/9/09 20:53:22)Mods_2009_04   `Call method G_InitInspVars here instead of in the input form methods  ` Modified by: costasmanousakis-(Designer)-(4/21/09 20:11:32)Mods_2009_04   `Place WildCard around "MHD BMS External" for new .4Dx extensions   `Removed the .comp at the District X BMS.comp string.  ` Modified by: costasmanousakis-(Designer)-(11/18/09 11:12:07)Mods_2009_11   `Added user group InspectionAllAccess to allow access to all inspections.  `Per request of S.Eslinger  ` Modified by: costasmanousakis-(Designer)-(6/11/10 08:42:18)Mods_2010_06   `  `Allow Access to Freeze Thaw inspections if they are approved by the DBIE  ` Modified by: costasmanousakis-(Designer)-(9/28/10 09:43:43)Mods_2010_09   `  `Use new method INSP_UserAllowed  ` Modified by: costasmanousakis-(Designer)-(1/19/11 09:04:39)Mods_2011_01   `` RR  ` Modified by: Costas Manousakis-(Designer)-(5/8/12 17:20:05)Mods_2012_05   `  `Added Flood DVF inspection typeMods_2012_12   `r001 ` Add code for new inspection types  `Modified by: Charles Miller (12/13/12 14:03:34)  ` Modified by: Costas Manousakis-(Designer)-(12/28/12 15:34:50)Mods_2012_12   `  `added code for RRS RRF RRD RRO Inspection types  ` Modified by: Costas Manousakis-(Designer)-(1/16/13 14:19:36)Mods_2013_01   `  `added code to unload [RAILBridgeInfo] if loaded;  `  `added code to unload field trip records also at the end  ` Modified by: Costas Manousakis-(Designer)-(4/16/13 14:50:21)Mods_2013_04   `  `Tunnels  ` Modified by: Costas Manousakis-(Designer)-(5/24/13 17:06:40)Mods_2013_05   `  `changed READ WRITE (*) at the end of load and Unload to  INSP_Read_Write_Tables ("WRITE")    ` Modified by: Costas Manousakis-(Designer)-(10/17/13 11:32:35)Mods_2013_10   `  `place the input form name in a variable- use dialog to load inspection if table is in read only modeEnd if Case of : (Form event=On Load )SET VISIBLE(BlankExitBtn;False)READ ONLY([Bridge MHD NBIS])  `Mods_2007_CM_5401READ ONLY([RAILBridgeInfo])SET AUTOMATIC RELATIONS(False;False)UNLOAD RECORD([Bridge MHD NBIS])LOAD RECORD([Bridge MHD NBIS])If (Is record loaded([RAILBridgeInfo]))UNLOAD RECORD([RAILBridgeInfo])LOAD RECORD([RAILBridgeInfo])End if READ ONLY([Inspection Type])If (Is record loaded([Inspection Type]))UNLOAD RECORD([Inspection Type])LOAD RECORD([Inspection Type])End if C_BOOLEAN($Configured)C_TEXT($Form_txt)$Configured:=TrueCase of : ([Inspections]Insp Type="RTN")$Form_txt:="Routine Combined": ([Inspections]Insp Type="RRR")$Form_txt:="RailRoutineInput": ([Inspections]Insp Type="RTA")$Form_txt:="Routine Combined": ([Inspections]Insp Type="RRA")$Form_txt:="RailRoutineInput": ([Inspections]Insp Type="FCR")$Form_txt:="Critical Member": ([Inspections]Insp Type="CMI")$Form_txt:="Critical Member": ([Inspections]Insp Type="OTH")$Form_txt:="Critical Member": ([Inspections]Insp Type="CUL")$Form_txt:="Culvert Combined": ([Inspections]Insp Type="CLD")$Form_txt:="Closed Bridge": ([Inspections]Insp Type="DAM")$Form_txt:="Damage Form": ([Inspections]Insp Type="DVE")$Form_txt:="Dive Form": ([Inspections]Insp Type="DVL")$Form_txt:="Dive LowCl": ([Inspections]Insp Type="DVA")$Form_txt:="Dive LowCl": ([Inspections]Insp Type="DVS")$Form_txt:="Underwater Special Member": ([Inspections]Insp Type="PON")$Form_txt:="Pontis Form": ([Inspections]Insp Type="FRZ")If ([Inspections]Insp Date<◊InspFormRevDate_7)$Form_txt:="FreezeThaw"Else $Form_txt:="FreezeThawA"End if : ([Inspections]Insp Type="DVF")$Form_txt:="StormDamageInspection": ([Inspections]Insp Type="PED")$Form_txt:="PedestrianInspection-PED": ([Inspections]Insp Type="RRC")$Form_txt:="RailCulvertCombined-RRC": ([Inspections]Insp Type="RRS")$Form_txt:="Critical Member": ([Inspections]Insp Type="RRF")$Form_txt:="Critical Member": ([Inspections]Insp Type="RRO")$Form_txt:="Critical Member": ([Inspections]Insp Type="RRD")$Form_txt:="Damage Form": ([Inspections]Insp Type="TAL")$Form_txt:="TunnelInspection": ([Inspections]Insp Type="TOV")$Form_txt:="TunnelOverheadInspection": ([Inspections]Insp Type="TSP")$Form_txt:="TunnelSpecial"Else $Configured:=FalseEnd case If ($Configured=True)  `Define inspection fonts      G_SetInspFont C_STRING(80;$vsSaveForward)C_BOOLEAN($vbUserAllowed)  `allow access if User is in group or if Inspection is approved.$vbUserAllowed:=INSP_UserAllowed If ($vbUserAllowed)SET AUTOMATIC RELATIONS(False;False)If ([Combined Inspections]NBISInspID#[Inspections]InspID)  `Get the correct Combined recordQUERY([Combined Inspections];[Combined Inspections]NBISInspID=[Inspections]InspID)If (Records in selection([Combined Inspections])=1)GOTO SELECTED RECORD([Combined Inspections];1)End if End if LOAD RECORD([Combined Inspections])C_BOOLEAN(vblnCombinedInspection)vblnCombinedInspection:=TrueCOPY NAMED SELECTION([Combined Inspections];"curCombinedInspection")  `RELATE ONE([Combined Inspections]NBISInspID)RELATE ONE([Combined Inspections]BMSInspID)C_LONGINT(vCurrentPontisID_L;vCurrentCombID_L)vCurrentPontisID_L:=[BMS Inspections]Inspection IDvCurrentCombID_L:=[Combined Inspections]ID$vsSaveForward:=vsForward  `Added to change Forward address per maintenance responsibility      If (Structure file="MHD BMS External@")If ([Bridge MHD NBIS]InspResp="DIST@")vsForward:="District "+Substring([Bridge MHD NBIS]InspResp;5;1)+" BMS"End if End if READ ONLY([Element Cat])READ ONLY([ElementDict])  `## Initialize transfer dataInitChangeStack (1)  `For [Inspections] recordInitChangeStack (2)  `for sub-elementsInitChangeStack (3)  `for bms inspections recordInitChangeStack (4)  `for combined inspections recordG_InitInspVars   `Start needed variables  `Enter using the chosen input form    If (Read only state([Inspections]))DIALOG([Inspections];$form_txt)Else INPUT FORM([Inspections];$form_txt)MODIFY RECORD([Inspections])End if   `Reset the input form to this oneINPUT FORM([Inspections];"BlankCombinedStarter")vblnCombinedInspection:=False  ` need to check if we are still in a transactionIf (In transaction)CANCEL TRANSACTIONEnd if CANCEL  ` get out of this formUNLOAD RECORD([Inspections])UNLOAD RECORD([BMS Inspections])UNLOAD RECORD([Combined Inspections])UNLOAD RECORD([ElementsSafety])  `Mods_2007_CM_5401UNLOAD RECORD([Standard Photos])UNLOAD RECORD([Cond Units])UNLOAD RECORD([Field Trip])UNLOAD RECORD([BMS Field Trip])UNLOAD RECORD([TunnelInspection])  `added to clear locks on [activity log] tableIf (Is record loaded([Activity Log]))UNLOAD RECORD([Activity Log])End if   `restore ForwardvsForward:=$vsSaveForward  `SET AUTOMATIC RELATIONS(True;True)Else ALERT("Not allowed to open this Inspection")CANCEL  `exit formUNLOAD RECORD([Inspections])End if   `if user allowedSET VISIBLE(BlankExitBtn;True)Else   `This should not happen the way things are set up,  ` but just in case..    ALERT("Please use the Configure button for this inspection form!")CANCEL  `get out of this formUNLOAD RECORD([Inspections])End if INSP_Read_Write_Tables ("WRITE")  `Mods_2007_CM_5401: (Form event=On Unload )INSP_Read_Write_Tables ("WRITE")  `Mods_2007_CM_5401End case 