If (False)ÊÊ` Modified by: costasmanousakis-(Designer)-(9/15/08 11:52:56)Mods_2008_CM_5404 ÊÊ` ("IMAGESTORE")ÊÊ`Don't compress the image after it is loadedÊÊ` Modified by: costasmanousakis-(Designer)-(5/4/11 11:54:09)Mods_2011_05 ÊÊ`ÊÊ`Changed the Open Document to Get Pathname onlyÊÊ` Modified by: Costas Manousakis-(Designer)-(10/28/13 16:47:28)Mods_2013_10 ÊÊ`ÊÊ`The Cannot handle file type is when OK=0 -> $vlRes=1 ; added message with the list of supported types from Picture Codec ListEnd if C_TIME($vRef)C_TEXT($vsDocument)C_LONGINT($vlRes)$vRef:=Open document("";"";Get Pathname )$vsDocument:=DocumentÊÊ`store it - Read Pic File clears it if errorIf (OK=1)CLOSE DOCUMENT($vRef)SET CURSOR(4)C_PICTURE($vTempPic)C_LONGINT($vPicW;$vPicH;$vPicHoff;$vPicVoff;$vPicmode;$res)READ PICTURE FILE($vsDocument;$vTempPic)$vlRes:=1-OKIf ($vlRes=0)[Standard Photos]Std Photo:=$vTempPicPushChange (2;->[Standard Photos]Std Photo)vbPictureChanged:=TrueREDRAW([Standard Photos]Std Photo)C_TEXT(vPictStats)PICTURE PROPERTIES([Standard Photos]Std Photo;$vPicW;$vPicH;$vPicHoff;$vPicVoff;$vPicmode)vPictStats:=String($vPicW)+"x"+String($vPicH)+×sCRvPictStats:=vPictStats+"("+String(Picture size([Standard Photos]Std Photo);"##,###,### Bytes")+")"Else Case of : ($vlRes=-108)ALERT("Insufficient memory to read picture file <"+$vsDocument+">"): ($vlRes=1)ARRAY TEXT($picTypes_atxt;0)ARRAY TEXT($picTypeNames_atxt;0)C_TEXT($msg_txt)PICTURE CODEC LIST($picTypes_atxt;$picTypeNames_atxt)C_LONGINT($loop_L)$msg_txt:=$picTypes_atxt{1}For ($loop_L;2;Size of array($picTypes_atxt))$msg_txt:=$msg_txt+", "+$picTypes_atxt{$loop_L}End for $msg_txt:="Cannot handle image type of file <"+$vsDocument+">"+×sCR+"Supported image types are "+$msg_txtALERT($msg_txt)Else ALERT("Error ("+String($vlRes)+") reading file <"+$vsDocument+">")End case End if $vTempPic:=$vTempPic*0SET CURSOR(0)End if 