If (False)ÊÊ` ----------------------------------------------------ÊÊ` User name (OS): costasmanousakisÊÊ` User name (4D): DesignerÊÊ` Date and time: 01/14/07, 21:53:38ÊÊ` ----------------------------------------------------ÊÊ` Method: INSP_PreviewBtn_OMÊÊ` DescriptionÊÊ` ÊÊ` ÊÊ` ParametersÊÊ` ----------------------------------------------------Mods_2007_CM04 ÊÊ` Modified by: costasmanousakis-(Designer)-(1/23/2007 16:08:22)Mods_2007_CM05a ÊÊ` Modified by: costasmanousakis-(Designer)-(9/12/2007 11:41:49)Mods_2007_CM12_5301 ÊÊ` Modified by: costasmanousakis-(Designer)-(2/24/10 16:30:56)Mods_2010_02 ÊÊ`Modifications for PONTIS in spec member inspectionsÊÊ` Modified by: Costas Manousakis-(Designer)-(1/3/13 10:46:36)Mods_2013_01 ÊÊ`ÊÊ`Added case for RRD inspection typeÊÊ` Modified by: Costas Manousakis-(Designer)-(11/13/13 08:50:44)Mods_2013_11 ÊÊ`ÊÊ`Added call to INSP_Check4DWriteChgsEnd if ÊÊ`Preview pages depending on which form page is current.SET PRINT PREVIEW(True)C_BOOLEAN(PrintFlag)C_INTEGER(vPageNo;vPrintPhotos;vPrintSketches;vPrintCharts)INSP_Check4DWriteChgs COPY NAMED SELECTION([ElementsSafety];"TempElmtsPreview")COPY NAMED SELECTION([Standard Photos];"TempImagesPreview")ÊÊ`Count pagesG_CountSpInspPgs Case of : (([Inspections]Insp Type="DAM")Ê|Ê([Inspections]Insp Type="RRD"))ARRAY INTEGER($Pg1PrintPage_ai;5)$Pg1PrintPage_ai{1}:=1$Pg1PrintPage_ai{2}:=2$Pg1PrintPage_ai{3}:=3$Pg1PrintPage_ai{4}:=4$Pg1PrintPage_ai{5}:=8C_INTEGER($CmtsPrintPage_i;$ImagePrintPage_i)$CmtsPrintPage_i:=5$ImagePrintPage_i:=6Else ARRAY INTEGER($Pg1PrintPage_ai;3)$Pg1PrintPage_ai{1}:=1$Pg1PrintPage_ai{2}:=2$Pg1PrintPage_ai{3}:=3C_INTEGER($CmtsPrintPage_i;$ImagePrintPage_i)$CmtsPrintPage_i:=4$ImagePrintPage_i:=5End case sInspDATE:=Uppercase(String([Inspections]Insp Date;Internal date abbreviated ))ON ERR CALL("G_PrintError")C_INTEGER(viInspPreviewErr)ÊÊ`Initialize our Print Error varviInspPreviewErr:=0ÊÊ`initialize ErrorÊÊ`PAGE SETUP([Inspections];"FC Pr (Pg 1)")G_PrintOptions C_INTEGER($viCurPg)$viCurPg:=Current form pageCase of : (Find in array($Pg1PrintPage_ai;$viCurPg)>0)vPageNo:=0Print_SpecMem_pg1 PAGE BREAK: ($viCurPg=$CmtsPrintPage_i)vPageNo:=viCmtsPgStart-1PrintFlag:=TrueC_LONGINT($vlNumCmtPgs)$vlNumCmtPgs:=Print_Dive_Cmt_a_new If ($vlNumCmtPgs=0)ALERT("There are no Comments for this Inspection")Else PAGE BREAKEnd if : (Current form page=$ImagePrintPage_i)G_PreviewInspImage : (vTabRoutingPages{$viCurPg}="Pontis")If (Records in selection([Cond Units])>0)ORDER BY([Cond Units];[BMS Elements]Element No;[Cond Units]Environment)OUTPUT FORM([Cond Units];"Cond Units Prt 2")PRINT SELECTION([Cond Units];*)OUTPUT FORM([Cond Units];"Cond Units Out")PAGE BREAKEnd if End case SET PRINT PREVIEW(False)ON ERR CALL("")USE NAMED SELECTION("TempElmtsPreview")USE NAMED SELECTION("TempImagesPreview")CLEAR NAMED SELECTION("TempElmtsPreview")CLEAR NAMED SELECTION("TempImagesPreview")