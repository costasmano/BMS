If (False)ÊÊ`G_AddElmtTxt2AreaÊÊ`Append current [ElementsSafety]ElmComments styled text to an area with a title. ÊÊ`G_AddElmtTxt2Area(area;Title)Mods_2004_CM11 Mods_2007_CM04 ÊÊ` Modified by: Costas Manousakis-(Designer)-(11/2/12 15:12:25)Mods_2012_11 ÊÊ`Copied to Server on : 11/02/12, 15:13:14ÊÊ`ÊÊ`Declare vInspFontNumber and assign it only if > 0End if C_LONGINT($1)C_STRING(132;$vElmTitle;$2)C_LONGINT($i;$numpages;$numnewpages;$vlStartSel;$vlEndSel;$vlCol;$vlLine;$vlPos)C_LONGINT($mainarea)C_BOOLEAN(vbTopOfPage)$mainarea:=$1$vElmTitle:=$2C_TEXT($vTitleTxt;vtHeaderLbl)If (vtHeaderLbl#"")$vTitleTxt:=vtHeaderLbl+×sCR+×sCR+$vElmTitlevtHeaderLbl:=""Else $vTitleTxt:=$vElmTitleEnd if $numpages:=WR Count ($mainarea;wr nb pages )ÊÊ`$numpages : page count at startWR GET SELECTION ($mainarea;$vlStartSel;$vlEndSel)ÊÊ`$vlStartSel := gets where we are at start - at the end of the text inserted before.If (Not(vbTopOfPage))ÊÊ`if at top of page no need to add linesWR INSERT TEXT ($mainarea;×sCR)G_ApplySheet ($mainarea;1)WR GET CURSOR POSITION ($mainarea;$numnewpages;$vlCol;$vlLine;$vlPos)ÊÊ`check if we went to next page $i:=0If ($numnewpages=$numpages)ÊÊ`if still on same page then add one more linefeed  WR INSERT TEXT ($mainarea;×sCR)$i:=1ÊÊ`number of CRs to be deleted later if the text goes into another pageEnd if End if If (False)WR EXECUTE COMMAND ($mainarea;wr cmd plain )Else G_ApplySheet ($mainarea;1)End if WR SET TEXT PROPERTY ($mainarea;wr bold ;1)WR SET TEXT PROPERTY ($mainarea;wr underline ;1)ÊÊ`underline - continuous underlineWR GET CURSOR POSITION ($mainarea;$numnewpages;$vlCol;$vlLine;$vlPos)ÊÊ`$vlLine : first line where the label will be insertedWR INSERT TEXT ($mainarea;$vTitleTxt)WR INSERT TEXT ($mainarea;×sCR)WR EXECUTE COMMAND ($mainarea;wr cmd plain )WR INSERT STYLED TEXT ($mainarea;[ElementsSafety]ElmComments)WR EXECUTE COMMAND ($mainarea;wr cmd select all )C_LONGINT(vInspFontNumber)If (vInspFontNumber>0)WR SET TEXT PROPERTY ($mainarea;wr font number ;vInspFontNumber)End if If (vInspFontSize>0)WR SET TEXT PROPERTY ($mainarea;wr font size ;vInspFontSize)End if G_Insp_ApplyLineSpacing ($mainarea)WR SET SELECTION ($mainarea;WR Count ($mainarea;wr nb characters );WR Count ($mainarea;wr nb characters ))ÊÊ`move to end of document$numnewpages:=WR Count ($mainarea;wr nb pages )If ($numnewpages>$numpages)G_InspParagProt ($mainarea;$numpages;$vlLine;$vlStartSel;$i;$vElmTitle) End if 