  `Method: INSP_CheckTunnelSpcFreq  `Description  `  ` Parameters  ` ----------------------------------------------------If (False)  ` ----------------------------------------------------  `User name (OS): Costas Manousakis  `User (4D) : Designer  `Date and time: 09/26/13, 16:11:29  ` ----------------------------------------------------  `Created : Mods_2013_09 End if   `C_LONGINT($Numeq4_L;$numLT4_L;$NumOtherEQ4_L;$NumOtherLT4_L)GET AUTOMATIC RELATIONS($one_b;$many_b)SET AUTOMATIC RELATIONS(True;True)ARRAY TEXT($cat_atxt;0)ARRAY LONGINT($countsEq4_aL;0)ARRAY LONGINT($countsLT4_aL;0)C_BOOLEAN($Freq_3_b;$Freq_6_b;$Freq_12_b)$Freq_3_b:=False$Freq_6_b:=False$Freq_12_b:=FalseC_TEXT($Freq_3_txt;$Freq_6_txt;$Freq_12_txt)APPEND TO ARRAY($cat_atxt;"STR")APPEND TO ARRAY($cat_atxt;"ROA")APPEND TO ARRAY($cat_atxt;"CEI")APPEND TO ARRAY($cat_atxt;"SUP")APPEND TO ARRAY($cat_atxt;"CRO")APPEND TO ARRAY($cat_atxt;"EGR")APPEND TO ARRAY($cat_atxt;"UTI")ARRAY LONGINT($countsEq4_aL;Size of array($cat_atxt))ARRAY LONGINT($countsLT4_aL;Size of array($cat_atxt))C_LONGINT($loop_L)For ($loop_L;1;Size of array($cat_atxt))SET QUERY DESTINATION(Into variable ;$Numeq4_L)QUERY SELECTION([ElementsSafety];[ElementDict]Category=$cat_atxt{$loop_L};*)QUERY SELECTION([ElementsSafety]; & ;[ElementsSafety]Rating="4")SET QUERY DESTINATION(Into current selection )SET QUERY DESTINATION(Into variable ;$numLT4_L)QUERY SELECTION([ElementsSafety];[ElementsSafety]Rating="0";*)QUERY SELECTION([ElementsSafety]; | ;[ElementsSafety]Rating="1";*)QUERY SELECTION([ElementsSafety]; | ;[ElementsSafety]Rating="2";*)QUERY SELECTION([ElementsSafety]; | ;[ElementsSafety]Rating="3";*)QUERY SELECTION([ElementsSafety]; & ;[ElementDict]Category=$cat_atxt{$loop_L})SET QUERY DESTINATION(Into current selection )$countsEq4_aL{$loop_L}:=$Numeq4_L$countsLT4_aL{$loop_L}:=$numLT4_LIf ($cat_atxt{$loop_L}="CEI")  `more criticalIf ($numLT4_L>0)$Freq_3_txt:=String($numLT4_L)+" Overhead Items less than 4"$Freq_3_b:=TrueEnd if If ($Numeq4_L>0)$Freq_6_txt:=$Freq_6_txt+String($Numeq4_L)+" Overhead Items less than 4"+Char(13)$Freq_6_b:=TrueEnd if Else If ($numLT4_L>0)$Freq_6_txt:=String($numLT4_L)+" Overhead Items less than 4"$Freq_6_b:=TrueEnd if If ($Numeq4_L>0)$Freq_12_txt:=$Freq_6_txt+String($Numeq4_L)+" Overhead Items less than 4"+Char(13)$Freq_12_b:=TrueEnd if End if End for SET AUTOMATIC RELATIONS($one_b;$many_b)  `End INSP_CheckTunnelSpcFreq