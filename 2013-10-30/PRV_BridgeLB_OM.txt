  `Method: PRV_BridgeLB_OM  `Description  `  ` Parameters  ` ----------------------------------------------------If (False)  ` ----------------------------------------------------  `User name (OS): Costas Manousakis  `User (4D) : Designer  `Date and time: 06/05/12, 09:27:06  ` ----------------------------------------------------  `Created : Mods_2012_06   ` Modified by: Costas Manousakis-(Designer)-(9/25/13 15:02:54)Mods_2013_09   `  `Copied to DEV  ` Modified by: Costas Manousakis-(Designer)-(10/24/13 11:19:39)Mods_2013_10   `  `use  method  INSP_IsInspRoutine_b to check if inspection is a routine oneEnd if   `C_LONGINT($FormEvent_L)C_TEXT($LBName_txt)C_LONGINT($1)$FormEvent_L:=$1C_TEXT($2)$LBName_txt:=$2Case of : ($FormEvent_L=On Load ): ($FormEvent_L=On Display Detail )Case of : ($LBName_txt="BRIDGES")  `Variable LB_Detail6_txt SD/FOLB_BRIDGES_Det06_txt:=""QUERY([Bridge MHD NBIS];[Bridge MHD NBIS]BIN=[Contract_Project_Maintenance]BIN)Case of : ([Bridge MHD NBIS]StructDef)LB_BRIDGES_Det06_txt:="SD": ([Bridge MHD NBIS]FunctObs)LB_BRIDGES_Det06_txt:="FO"End case LB_BRIDGES_Det07_txt:=QR_Item26OnOff LB_BRIDGES_Det08_txt:=[Bridge MHD NBIS]Item8: ($LBName_txt="BRIDGESDEC")QUERY([Bridge MHD NBIS];[Bridge MHD NBIS]BIN=[Contract_Project_Maintenance]BIN)  `LB_Detail2_txt:=String([Bridge MHD NBIS]Item27)  `LB_Detail3_txt:=String([Bridge MHD NBIS]Item106)  `LB_Detail4_txt:=[Bridge MHD NBIS]Item58  `LB_Detail5_txt:=[Bridge MHD NBIS]Item59  `LB_Detail6_txt:=[Bridge MHD NBIS]Item60  `LB_Detail7_txt:=[Bridge MHD NBIS]Item62  `LB_Detail8_txt:=[Bridge MHD NBIS]Item67  `LB_Detail9_txt:=[Bridge MHD NBIS]Item71  `LB_Detail10_txt:=[Bridge MHD NBIS]Item113LB_BRIDGESDEC_Det11_txt:=[Bridge MHD NBIS]Item58  `paintLB_BRIDGESDEC_Det12_txt:=[Bridge MHD NBIS]Item36A+[Bridge MHD NBIS]Item36B+[Bridge MHD NBIS]Item36C+[Bridge MHD NBIS]Item36DLB_BRIDGESDEC_Det13_txt:=String(10.7639104*QR_BridgeArea_r ;"###,###.0")LB_BRIDGESDEC_Det14_txt:=String(3.280839895*[Bridge MHD NBIS]Item54B;"###,###.0")  `vert CL in ftLB_BRIDGESDEC_Det15_txt:=String(100*[Bridge MHD NBIS]HealthIndex;"###.00;;0")  `HILB_BRIDGESDEC_Det16_txt:=String([Bridge MHD NBIS]Item29;"###,###,###")  `ADTLB_BRIDGESDEC_Det17_txt:=String(0.621371192*[Bridge MHD NBIS]Item19;"###.0")  `Detour in milesLB_BRIDGESDEC_Det18_txt:=QR_Item26 : ($LBName_txt="STR25"): ($LBName_txt="HWY25"): ($LBName_txt="INSPECT")LB_INSPECT_Det01_txt:=[Inspection Type]DescriptionQUERY([Inspections];[Inspections]InspID=[Combined Inspections]NBISInspID)If (INSP_IsInspRoutine_b )C_BOOLEAN($vbCombined)If (Substring(◊Version;1;(Position(" ";◊Version)-1))>="5.0")$vbCombined:=[Inspections]InspRtnSpcMemFlagElse $vbCombined:=(G_Insp_CountSpMs >0)End if If ($vbCombined)LB_INSPECT_Det01_txt:=LB_INSPECT_Det01_txt+" & Spec.Mem."End if End if Case of : ([Inspections]InspReviewed=0)LB_INSPECT_Det10_pct:=LB_INSPECT_Det10_pct*0: ([Inspections]InspReviewed=1)GET PICTURE FROM LIBRARY("BMS RejectIcon";LB_INSPECT_Det10_pct): ([Inspections]InspReviewed=2)GET PICTURE FROM LIBRARY("BMS ApproveIcon";LB_INSPECT_Det10_pct)End case Case of : ([Inspections]InspApproved=0)LB_INSPECT_Det11_pct:=LB_INSPECT_Det11_pct*0: ([Inspections]InspApproved=1)GET PICTURE FROM LIBRARY("BMS RejectIcon";LB_INSPECT_Det11_pct): ([Inspections]InspApproved=2)GET PICTURE FROM LIBRARY("BMS ApproveIcon";LB_INSPECT_Det11_pct)End case LB_INSPECT_Det03_txt:=[Inspections]Item 58  `vsInc_Insp_I59:=[Inspections]Item 59  `If ([Inspections]Insp Type="DV@")LB_INSPECT_Det05_txt:=[Inspections]Item 60 UWLB_INSPECT_Det06_txt:=[Inspections]Item 61 UWLB_INSPECT_Det07_txt:=[Inspections]Item 62 UWElse LB_INSPECT_Det05_txt:=[Inspections]Item 60LB_INSPECT_Det06_txt:=[Inspections]Item 61LB_INSPECT_Det07_txt:=[Inspections]Item 62End if Case of : ([Inspections]Insp Type="FCR")LB_INSPECT_Det03_txt:=""LB_INSPECT_Det06_txt:=""LB_INSPECT_Det07_txt:="": ([Inspections]Insp Type="CMI")LB_INSPECT_Det06_txt:=""End case If ([Inspections]InspComplete)GET PICTURE FROM LIBRARY("Mark_on";LB_INSPECT_Det09_pct)Else GET PICTURE FROM LIBRARY("Mark_Off";LB_INSPECT_Det09_pct)End if End case : ($FormEvent_L=On Data Change ): ($FormEvent_L=On Clicked ): ($FormEvent_L=On Double Clicked )C_POINTER($3;$Table_ptr)$Table_ptr:=$3C_TEXT($4;$FormName_txt)$FormName_txt:=$4C_TEXT($LBName_txt;$SetName_txt;PRV_NEWREVIEWTYPE_s;$LBSelection_txt)C_LONGINT($Dumm_L;$LBCol_L;$LBRow_L;$LbTableNum_L)  `ALERT("doubleClicked on "+$LBName_txt)PRV_NEWREVIEWTYPE_s:=$LBName_txt$SetName_txt:="PRV_"+$LBName_txt+"_HS"$LBName_txt:="PRV_"+$LBName_txt+"_LB"If (Records in set($SetName_txt)>0)GET LISTBOX TABLE SOURCE(*;$LBName_txt;$LbTableNum_L;$LBSelection_txt)If ($LBSelection_txt#"")USE NAMED SELECTION($LBSelection_txt)End if GET LISTBOX CELL POSITION(*;$LBName_txt;$LBCol_L;$LBRow_L)If ($LBRow_L>0)Case of : ($LBName_txt="PRV_INSPECT_LB")READ ONLY([Bridge MHD NBIS])READ ONLY([Combined Inspections])READ ONLY([Inspections])READ ONLY([Inspection Type])SET AUTOMATIC RELATIONS(False;False)LOAD RECORD([Combined Inspections])QUERY([Bridge MHD NBIS];[Bridge MHD NBIS]BIN=[Combined Inspections]BIN)SET CURSOR(4)RELATE ONE([Combined Inspections]NBISInspID)RELATE ONE([Combined Inspections]BMSInspID)C_LONGINT(vCurrentPontisID_L;vCurrentCombID_L)C_BOOLEAN(vAllRelationsOK_B)vCurrentPontisID_L:=[BMS Inspections]Inspection IDvCurrentCombID_L:=[Combined Inspections]IDvAllRelationsOK_B:=TrueIf ([Combined Inspections]BMSInspID>0)If (vCurrentPontisID_L#[Combined Inspections]BMSInspID)vAllRelationsOK_B:=FalseEnd if If ([BMS Inspections]BIN#[Combined Inspections]BIN)vAllRelationsOK_B:=FalseEnd if End if If (vAllRelationsOK_B)READ ONLY([Combined Inspections])QUERY([Inspection Type];[Inspection Type]Code=[Inspections]Insp Type)DIALOG([Inspections];"BlankCombinedStarter")If (In transaction)CANCEL TRANSACTIONEnd if Else ALERT("There are database link problems with this inspection record!! Record cannot be l"+"oaded!!")End if READ ONLY([Bridge MHD NBIS])QUERY([Bridge MHD NBIS];[Bridge MHD NBIS]BIN=[Contract_Project_Maintenance]BIN)INSP_UpdateInspList : ($LBName_txt="PRV_BRIDGES_LB")INPUT FORM($Table_ptr->;$FormName_txt)If (Read only state([Contract_Assignment_Maintenance]))READ ONLY($Table_ptr->)LOAD RECORD($Table_ptr->)DIALOG($Table_ptr->;$FormName_txt)Else C_LONGINT($LoadRecResult_L)$LoadRecResult_L:=ut_LoadRecordInteractiveV2 ($Table_ptr)Case of : ($LoadRecResult_L=1)MODIFY RECORD($Table_ptr->)PRV_Variables ("RELATEBRIDGEINFO")PRV_CTRLSelections (PRV_NEWREVIEWTYPE_s): ($LoadRecResult_L=2)READ ONLY($Table_ptr->)LOAD RECORD($Table_ptr->)DIALOG($Table_ptr->;$FormName_txt)End case End if : ($LBName_txt="PRV_BRIDGESDEC_LB")READ ONLY($Table_ptr->)LOAD RECORD($Table_ptr->)DIALOG($Table_ptr->;$FormName_txt)End case End if Else   `ALERT("Nothing")End if End case   `End PRV_BridgeLB_OM