  `CreateRandomSetinCI_Contract   `purpose: create a random set of bridges from the Search by ContractNo dialogIf (False)  `created: 4/22/2004  `copied and modified from CreateRandomSet  ` Modified by: Costas Manousakis-(Designer)-(12/30/13 16:44:16)Mods_2013_12   `  `Instead of blanking the search variables,  leave them with a space as a workaround for the v13  upgrade.End if C_STRING(30;$s)If ((vAddTo=True) & (Records in set("Random Set")=0))CREATE SET([Cons Inspection];"Random Set")End if DISABLE BUTTON(bFind)SHORT_MESSAGE ("Looking…")If (vAddTo=False)USE NAMED SELECTION("UserRegionA")Else ALL RECORDS([Cons Inspection])End if If (vContractNo#"")$s:=Replace string(vContractNo;" ";"")If (Length($s)<3)$s:=$s+"@"End if QUERY SELECTION([Cons Inspection];[Cons Inspection]ConContractNo=$s)End if If (vsAssignNo#"")QUERY SELECTION([Cons Inspection];[Cons Inspection]AssignConNumber=Num(vsAssignNo))End if CLOSE WINDOWENABLE BUTTON(bFind)vContractNo:=" "vsAssignNo:=""GOTO AREA(vContractNo)CREATE SET([Cons Inspection];"Found Bridge Recs Set")If (Records in set("Random Set")=0)If (vAddTo=False)CREATE EMPTY SET([Cons Inspection];"Random Set")End if End if UNION("Random Set";"Found Bridge Recs Set";"Random Set")CLEAR SET("Found Bridge Recs Set")