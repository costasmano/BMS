ÊÊ`CreateRandomSetinConsltAddress ÊÊ`purpose: create a random set of conslt from Search Consultant Address dialogIf (False)ÊÊ`created: 10/15/2003ÊÊ`copied and modified from CreateRandomSetinConsltRatingÊÊ` Modified by: costasmanousakis-(Designer)-(10/31/2007 08:29:51)Mods_2007_CM12_5302 ÊÊ` made changes in the search :if user has a wild card, then use it.ÊÊ` Modified by: Costas Manousakis-(Designer)-(12/30/13 16:44:16)Mods_2013_12 ÊÊ`ÊÊ`Instead of blanking the search variables,  leave them with a space as a workaround for the v13  upgrade.End if If ((vAddTo=True)Ê&Ê(Records in set("Random Set")=0))CREATE SET([Conslt Address];"Random Set")End if DISABLE BUTTON(bFind)SHORT_MESSAGE ("LookingÉ")If (vAddTo=False)USE NAMED SELECTION("UserRegionA")Else ALL RECORDS([Conslt Address])End if If (vConsltName#"")If (Position("@";vConsltName)>0)Else If (Length(vConsltName)<6)vConsltName:="@"+vConsltName+"@"End if End if QUERY SELECTION([Conslt Address];[Conslt Address]ConsltName=vConsltName)vConsltName:=" "GOTO AREA(vConsltName)End if If (vLastName#"")If (Position("@";vLastName)>0)Else If (Length(vLastName)<6)vLastName:="@"+vLastName+"@"End if End if QUERY SELECTION([Conslt Address];[Conslt Address]ContactLName=vLastName)vLastName:=" "GOTO AREA(vLastName)End if CLOSE WINDOWENABLE BUTTON(bFind)CREATE SET([Conslt Address];"Found Consultant Address Set")If (Records in set("Random Set")=0)If (vAddTo=False)CREATE EMPTY SET([Conslt Address];"Random Set")End if End if UNION("Random Set";"Found Consultant Address Set";"Random Set")CLEAR SET("Found Consultant Address Set")