  `CreateRandomSetinCR_Contract   `purpose: create a random set of bridges from the Search by ContractNo dialog  If (False)  `created: 4/22/2004  `copied and modified from CreateRandomSet  ` Modified by: Costas Manousakis-(Designer)-(12/30/13 16:44:16)Mods_2013_12   `  `Instead of blanking the search variables,  leave them with a space as a workaround for the v13  upgrade.End if C_STRING(30;$s)If ((vAddTo=True) & (Records in set("Random Set")=0))CREATE SET([Conslt Rating];"Random Set")End if DISABLE BUTTON(bFind)SHORT_MESSAGE ("Looking…")If (vAddTo=False)USE NAMED SELECTION("UserRegionA")Else ALL RECORDS([Conslt Rating])End if If (vContractNo#"")$s:=Replace string(vContractNo;" ";"")If (Length($s)<3)$s:=$s+"@"End if QUERY SELECTION([Conslt Rating];[Conslt Rating]ContractNoRat=$s)End if If (vsAssignNo#"")QUERY SELECTION([Conslt Rating];[Conslt Rating]AssignNoRat=Num(vsAssignNo))End if ORDER BY([Conslt Rating];[Conslt Rating]AssignNoRat)CLOSE WINDOWENABLE BUTTON(bFind)vContractNo:=" "vsAssignNo:=""GOTO AREA(vContractNo)CREATE SET([Conslt Rating];"Found Bridge Recs Set")If (Records in set("Random Set")=0)If (vAddTo=False)CREATE EMPTY SET([Conslt Rating];"Random Set")End if End if UNION("Random Set";"Found Bridge Recs Set";"Random Set")CLEAR SET("Found Bridge Recs Set")