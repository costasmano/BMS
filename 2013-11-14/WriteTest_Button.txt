  `Method: Object Method: WriteTest.Button  `Description  `  ` Parameters  ` ----------------------------------------------------If (False)  ` ----------------------------------------------------  `User name (OS): Costas Manousakis  `User (4D) : Designer  `Date and time: 11/05/13, 09:28:54  ` ----------------------------------------------------  `Created : Mods_2013_11 End if   `C_TEXT(WrtTest_codes_txt;WrtTest_txt;WrtTest_Props_txt;WrtTest_FormatTxtBlb_txt;$blob_txt;$blobWords_txt)WrtTest_txt:=WR Get selected text (WriteArea)C_LONGINT($txtLen_L;$loop_L)$txtLen_L:=Length(WrtTest_txt)C_BLOB($FormatTxt_blb)If ($txtLen_L>0)WrtTest_codes_txt:=String(Character code(Substring(WrtTest_txt;1;1)))For ($loop_L;2;$txtLen_L)WrtTest_codes_txt:=WrtTest_codes_txt+";"+String(Character code(Substring(WrtTest_txt;$loop_L;1)))End for Else WrtTest_txt:=""WrtTest_codes_txt:=""End if $FormatTxt_blb:=WR Get styled text (WriteArea)$blob_txt:=BLOB to text($FormatTxt_blb;Mac text without length )$txtLen_L:=Length($blob_txt)If ($txtLen_L>0)WrtTest_FormatTxtBlb_txt:=String(Character code(Substring($blob_txt;1;1)))+"("+Substring($blob_txt;1;1)+")"$blobWords_txt:=Substring($blob_txt;1;1)For ($loop_L;2;$txtLen_L)WrtTest_FormatTxtBlb_txt:=WrtTest_FormatTxtBlb_txt+";"+String(Character code(Substring($blob_txt;$loop_L;1)))If (Character code(Substring($blob_txt;$loop_L;1))=0)WrtTest_FormatTxtBlb_txt:=WrtTest_FormatTxtBlb_txt+"()"$blobWords_txt:=$blobWords_txt+"^"Else WrtTest_FormatTxtBlb_txt:=WrtTest_FormatTxtBlb_txt+"("+Substring($blob_txt;$loop_L;1)+")"$blobWords_txt:=$blobWords_txt+Substring($blob_txt;$loop_L;1)End if End for WrtTest_FormatTxtBlb_txt:=WrtTest_FormatTxtBlb_txt+Char(13)+"words :"+Char(13)+$blobWords_txtElse WrtTest_FormatTxtBlb_txt:=""End if   `End Object Method: WriteTest.Button