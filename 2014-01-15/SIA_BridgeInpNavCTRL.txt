If (False)  ` ----------------------------------------------------  ` User name (OS): costasmanousakis  ` User name (4D): Designer  ` Date and time: 08/19/10, 08:59:02  ` ----------------------------------------------------  ` Method: SIA_BridgeInpNavCTRL  ` Description  `  ` Control Navigation in Bridge Input form  `   ` Parameters  ` $1 : $PageNumber_L  ` ----------------------------------------------------Mods_2010_09   ` Modified by: costasmanousakis-(Designer)-(1/18/11 12:10:44)Mods_2011_01   `  `` Rail Road input changes  ` Modified by: costasmanousakis-(Designer)-(5/2/11 16:40:51)Mods_2011_05   `  `Bug fix for locking after RR inputMods_2012_02   `r003  `Modified by: Charles Miller (2/28/12 15:56:14)Mods_2012_03   `r003 `Add code to use list box for Inventory button on   `Modified by: Charles Miller (3/29/12 14:11:41)  ` Modified by: Costas Manousakis-(Designer)-(5/3/12 10:34:42)Mods_2012_05   `  `Unload the current record of the table listed  `  `added the query for [Bridge Design] in here  ` Modified by: Costas Manousakis-(Designer)-(5/10/12 13:48:36)Mods_2012_05   `  `Added vApproveLvl and INSP_KiloPtValues in the call for [Combined Inspections]  ` Modified by: Costas Manousakis-(Designer)-(1/16/13 13:52:24)Mods_2013_01   `  `Added call to ut_Read_Write_Tables ("READ";.. to set  unneeded tables to RO for [Combined Inspections]Mods_2013_02   `r001 `  Remove [BridgeInfoLink] updates as we are going to update data on add only  `Modified by: Charles Miller (2/26/13 16:28:36)  ` Modified by: Costas Manousakis-(Designer)-(3/18/13 14:03:21)Mods_2013_03   `  `Added code to enable MBTAFullEdit users access to Rail Info data  ` Modified by: Costas Manousakis-(Designer)-(4/16/13 11:10:28)Mods_2013_04   `Tunnel inspection  ` Modified by: Costas Manousakis-(Designer)-(6/6/13 10:25:20)Mods_2013_06   `  `in rail road info use new method ut_WindowSize to control window size   ` Modified by: Costas Manousakis-(Designer)-(1/15/14 15:58:32)Mods_2014_01   `  `End if C_LONGINT($1;$PageNumber_L)$PageNumber_L:=$1SET VISIBLE(*;"BridgeTemplate_@";True)Case of : ($PageNumber_L=2)  `Cons InspectionsQUERY([Cons Inspection];[Cons Inspection]BIN=[Bridge MHD NBIS]BIN)ORDER BY([Cons Inspection];[Cons Inspection]InspMonth;<)If (Not(User in group(◊CurrentUser_Name;"Conslt Rating - ReadWrite")))READ ONLY([Cons Inspection])DISABLE BUTTON(*;"AddConsInspBtn")End if UNLOAD RECORD([Cons Inspection])SIA_ReleaseBridgeRec SIA_SetUpListBoxes ($PageNumber_L)SIA_GoToPage ($PageNumber_L): ($PageNumber_L=3)  `[Conslt Rating]QUERY([Conslt Rating];[Conslt Rating]BIN=[Bridge MHD NBIS]BIN)ORDER BY([Conslt Rating];[Conslt Rating]DateReqbyDistrictBIE;<)If (Not(User in group(◊CurrentUser_Name;"Conslt Rating - ReadWrite")))READ ONLY([Conslt Rating])DISABLE BUTTON(*;"AddConsRtgBtn")End if UNLOAD RECORD([Conslt Rating])SIA_ReleaseBridgeRec SIA_SetUpListBoxes ($PageNumber_L)SIA_GoToPage ($PageNumber_L): ($PageNumber_L=4)  `[RatingReports]vTown:=[Bridge MHD NBIS]Town NamevTown:=vTown+" (D-"+String(Num([Bridge MHD NBIS]Item2))+")"If (User in group(◊CurrentUser_Name;"Ratings and Overloads"))ENABLE BUTTON(*;"AddRatingBtn")READ WRITE([RatingReports])READ WRITE([RatingMember])Else DISABLE BUTTON(*;"AddRatingBtn")READ ONLY([RatingReports])READ ONLY([RatingMember])End if   `sort rating reports by date decreasing  QUERY([RatingReports];[RatingReports]BIN=[Bridge MHD NBIS]BIN)ORDER BY([RatingReports];[RatingReports]ReportDate;<)UNLOAD RECORD([RatingReports])SIA_ReleaseBridgeRec SIA_SetUpListBoxes ($PageNumber_L)SIA_GoToPage ($PageNumber_L): ($PageNumber_L=5)  `[NBIS Secondary]QUERY([NBIS Secondary];[NBIS Secondary]BIN=[Bridge MHD NBIS]BIN)ORDER BY([NBIS Secondary];[NBIS Secondary]Item5;>)UNLOAD RECORD([NBIS Secondary])SIA_ReleaseBridgeRec SIA_SetUpListBoxes ($PageNumber_L)SIA_GoToPage ($PageNumber_L)DISABLE BUTTON(*;"AddSecndrBtn")READ ONLY([NBIS Secondary]): ($PageNumber_L=6)  `[Bridge Design]QUERY([Bridge Design];[Bridge Design]BIN=[Bridge MHD NBIS]BIN)ORDER BY([Bridge Design];[Bridge Design]ADVDate;<)UNLOAD RECORD([Bridge Design])If ((User in group(◊CurrentUser_Name;"BridgeDataSheet")) & (Not(User in group(◊CurrentUser_Name;"ReadOnly"))))ENABLE BUTTON(*;"AddBrgDesBtn")READ WRITE([Bridge Design])Else DISABLE BUTTON(*;"AddBrgDesBtn")READ ONLY([Bridge Design])End if SIA_ReleaseBridgeRec SIA_SetUpListBoxes ($PageNumber_L)SIA_GoToPage ($PageNumber_L): ($PageNumber_L=7)  `[Combined Inspections]SET VISIBLE(*;"BridgeTemplate_@";False)ut_Read_Write_Tables ("READ";->[Element Cat];->[ElementDict];->[Personnel];->[Inspection Type])ut_Read_Write_Tables ("READ";->[Common Notes];->[BMS Categories];->[CS Notes];->[BMS Elements])ut_Read_Write_Tables ("READ";->[Cond States];->[Cat CS Notes];->[CS Actions];->[Element Costs];->[Environments])C_TEXT(INSP_Inspection_list_txt)INSP_Inspection_list_txt:="BRIDGE"INSP_UpdateInspList C_INTEGER(vApproveLvl)vApproveLvl:=0  `Cannot approve inspections from this point of entry.INSP_KiloPtValues SIA_ReleaseBridgeRec SIA_SetUpListBoxes ($PageNumber_L)SIA_GoToPage ($PageNumber_L): ($PageNumber_L=8)  `[InventoryPhotoInsp]SIA_SetUpListBoxes ($PageNumber_L)INV_GetBINInventoryPhotos INV_SetHelpMsg_List SIA_ReleaseBridgeRec SIA_GoToPage ($PageNumber_L): (($PageNumber_L=9) | ($PageNumber_L=10))  `RailRoad info  `Can User Edit RR Bridges?C_BOOLEAN($EditRRInfo_b)C_TEXT($CurrUser_txt)$CurrUser_txt:=◊CurrentUser_Name$EditRRInfo_b:=(User in group($CurrUser_txt;"RRBridgeEdit") | User in group($CurrUser_txt;"Design Access Group"))C_LONGINT($WW;$WH)ut_WindowSize ("GET";->$WW;->$WH)If (([Bridge MHD NBIS]InspResp="MBTA") & User in group($currUser_txt;"MBTA_FullEdit"))$EditRRInfo_b:=$EditRRInfo_b | TrueEnd if If ($EditRRInfo_b)InitChangeStack (1)  `changes to [Bridge MHD NBIS]InitChangeStack (2)  `changes to [RAILBridgeInfo]LOAD RECORD([Bridge MHD NBIS])If (ut_LoadRecordInteractive (->[Bridge MHD NBIS]))INPUT FORM([RAILBridgeInfo];"RailInput")SIA_RRVariableUtil ("INIT")SIA_RRVariableUtil ("LOAD")QUERY([RAILBridgeInfo];[RAILBridgeInfo]BIN=[Bridge MHD NBIS]BIN)If (Records in selection([RAILBridgeInfo])=1)LOAD RECORD([RAILBridgeInfo])If (ut_LoadRecordInteractive (->[RAILBridgeInfo]))MODIFY RECORD([RAILBridgeInfo])Else ALERT("Could not load for editing the Rail Road Bridge Info!")SET AUTOMATIC RELATIONS(False;False)UNLOAD RECORD([Bridge MHD NBIS])UNLOAD RECORD([RAILBridgeInfo])READ ONLY([Bridge MHD NBIS])READ ONLY([RAILBridgeInfo])LOAD RECORD([RAILBridgeInfo])LOAD RECORD([Bridge MHD NBIS])DIALOG([RAILBridgeInfo];"RailInput")End if Else READ WRITE([RAILBridgeInfo])ADD RECORD([RAILBridgeInfo])End if Else End if Else SET AUTOMATIC RELATIONS(False;False)UNLOAD RECORD([Bridge MHD NBIS])UNLOAD RECORD([RAILBridgeInfo])READ ONLY([Bridge MHD NBIS])READ ONLY([RAILBridgeInfo])LOAD RECORD([Bridge MHD NBIS])QUERY([RAILBridgeInfo];[RAILBridgeInfo]BIN=[Bridge MHD NBIS]BIN)LOAD RECORD([RAILBridgeInfo])SIA_RRVariableUtil ("INIT")SIA_RRVariableUtil ("LOAD")DIALOG([RAILBridgeInfo];"RailInput")READ WRITE([Bridge MHD NBIS])End if SIA_BridgeInput_FM (On Load )ut_WindowSize ("MATCH";->$WW;->$WH): ($PageNumber_L=11)  `tunnel inspectionsSET VISIBLE(*;"BridgeTemplate_@";False)ut_Read_Write_Tables ("READ";->[Element Cat];->[ElementDict];->[Personnel];->[Inspection Type])ut_Read_Write_Tables ("READ";->[Common Notes];->[BMS Categories];->[CS Notes];->[BMS Elements])ut_Read_Write_Tables ("READ";->[Cond States];->[Cat CS Notes];->[CS Actions];->[Element Costs];->[Environments])ut_Read_Write_Tables ("READ";->[TunnelInspection];->[TunnelInfo])C_TEXT(INSP_Inspection_list_txt)INSP_Inspection_list_txt:="TUNNEL"INSP_UpdateInspList C_INTEGER(vApproveLvl)vApproveLvl:=0  `Cannot approve inspections from this point of entry.INSP_KiloPtValues SIA_ReleaseBridgeRec SIA_SetUpListBoxes ($PageNumber_L)QUERY([TunnelInfo];[TunnelInfo]BIN=[Bridge MHD NBIS]BIN)LOAD RECORD([TunnelInfo])SIA_GoToPage ($PageNumber_L): ($PageNumber_L=12)  `vTown:=[Bridge MHD NBIS]Town NamevTown:=vTown+" (D-"+String(Num([Bridge MHD NBIS]Item2))+")"If (User in group(◊CurrentUser_Name;"Ratings and Overloads"))ENABLE BUTTON(*;"AddRatingBtn")READ WRITE([RatingRequests])READ WRITE([AddtlRatingRequests])Else DISABLE BUTTON(*;"AddRatingBtn")READ ONLY([RatingRequests])READ ONLY([AddtlRatingRequests])End if   `sort rating reports by date decreasing  QUERY([RatingRequests];[RatingRequests]BIN=[Bridge MHD NBIS]BIN)ORDER BY([RatingRequests];[RatingRequests]DateOfRequest_d;<)UNLOAD RECORD([RatingRequests])LB_Tasks ("ADDTOLIST";"RtgReqIncl";"";"input")SIA_ReleaseBridgeRec SIA_SetUpListBoxes ($PageNumber_L)SIA_GoToPage ($PageNumber_L)End case 