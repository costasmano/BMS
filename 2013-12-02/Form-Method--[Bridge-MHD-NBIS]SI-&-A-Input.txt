If (False)ÊÊ`Form Method: [Bridge MHD NBIS];"SI & A Input" Mods_2005_CM05 Mods_2005_CM12 ÊÊ` Modified by: costasmanousakis-(Designer)-(1/17/2006 11:28:17)Mods_2006_CM03 ÊÊ` Modified by: costasmanousakis-(Designer)-(2/27/2006 14:43:58)Mods_2006_CM03 ÊÊ` Modified by: costasmanousakis-(Designer)-(4/10/2006 09:27:32)Mods_2006_CM04 ÊÊ` Modified by: costasmanousakis-(Designer)-(3/28/2007 16:05:30)Mods_2007_CM07 ÊÊ` Modified by: costasmanousakis-(Designer)-(1/4/08 12:26:58)Mods_2007_CM_5401 ÊÊ`ÊÊ`Release the curr bridge rec if the user is not part of the SIAAccess groupÊÊ` Modified by: costasmanousakis-(Designer)-(3/6/08 15:19:32)Mods_2008_CM_5403 ÊÊ`Allow Area and Bridge inps engineer access to the Freeze thawÊÊ` Modified by: costasmanousakis-(Designer)-(4/4/08 16:52:21)Mods_2008_CM_5403 ÊÊ` Modified by: costasmanousakis-(Designer)-(4/30/08 16:46:33)Mods_2008_CM_5403 ÊÊ`ÊÊ`Adjust entry order on page 1; change objects for item7,6a to use the newÊÊ`ÊÊ`SIA_@_OM project methods.Mods_2008_CM_5403 ÊÊ`Added rank and HI object and methodÊÊ` Modified by: costasmanousakis-(Designer)-(10/13/09 14:30:40)Mods_2009_10 ÊÊ`ÊÊ`Added display of Scour Categry and rank; call SIA_ScourRank_OM in form methodÊÊ` Modified by: costasmanousakis-(Designer)-(12/18/09 16:07:46)Mods_2009_12 ÊÊ`ÊÊ`Added help tip on the Accept and Cacnel  buttons and control with the method SIA_HelpTipCtrl ÊÊ` Modified by: costasmanousakis-(Designer)-(1/20/11 09:54:57)Mods_2011_01 ÊÊ`` RR Changes To allow RRBridgeEdit users access to the SIA for @RO bridges; also use $currUser_txtÊÊ` Modified by: costasmanousakis-(Designer)-(2/28/11 10:11:04)Mods_2011_02 ÊÊ`ÊÊ`Applied entry filter Item5Main to Item 5ÊÊ` Modified by: costasmanousakis-(Designer)-(11/30/11 16:01:44)Mods_2011_11 ÊÊ`ÊÊ` Use ×CurrentUser_Name instead of Current userMods_2013_03 ÊÊ`r001 ` Add code for access for MBTA users Group MBTA ad MBTA_ROÊÊ`Modified by: Charles Miller (3/12/13 16:23:47)ÊÊ` Modified by: Costas Manousakis-(Designer)-(5/23/13 11:51:17)Mods_2013_05 ÊÊ`ÊÊ`Added fields from [RAILBridgeInfo] for load ratings of hwy bridges - Rail road ratings are in the railinput formÊÊ` Modified by: Costas Manousakis-(Designer)-(9/6/13 16:55:49)Mods_2013_09 ÊÊ`ÊÊ`Named inspection data fields to DE BridgeInsp@ÊÊ` Modified by: Costas Manousakis-(Designer)-(10/22/13 16:41:35)Mods_2013_10 ÊÊ`ÊÊ`at the end of the load event, if the table is in RO mode lock the whole input form anywayÊÊ` Modified by: Costas Manousakis-(Designer)-(10/24/13 16:57:11)Mods_2013_10 ÊÊ`ÊÊ`Special case for (GRP_UserInGroup ("TEMP_EditLatLon")=1) to allow interns to edit lat long values onlyEnd if C_TEXT($currUser_txt)$currUser_txt:=×CurrentUser_NameCase of : (Form event=On Load )ÊÊ`SIA Page RefARRAY STRING(25;aSIAPages;0)COPY ARRAY(×aSIAPages;aSIAPages)aSIAPages:=11SIA_HelpTipCtrl ("INIT")ÊÊ`SJH 04/21/2004 `````````````````````````````````````````````````ÊÊ`ARRAY STRING(25;aNBIPages;0)COPY ARRAY(×aNBIPages;aNBIPages)aNBIPages:=1ÊÊ`SJH 04/21/2004 `````````````````````````````````````````````````ÊÊ`## Initialize transfer dataInitChangeStack (1)ÊÊ`Unrestricted check box for Item 10If ([Bridge MHD NBIS]Item10=99.99)CBItem10:=1Else CBItem10:=0End if ÊÊ`Blank check box for Item 106If ([Bridge MHD NBIS]Item106=0)CBItem106:=1Else CBItem106:=0End if ÊÊ`Check box for Item 47If ([Bridge MHD NBIS]Item47=99.9)CBItem47:=1Else CBItem47:=0End if ÊÊ`Blank check box for Item 51If ([Bridge MHD NBIS]Item51=0)CBItem51:=1Else CBItem51:=0End if ÊÊ`Blank check box for Item 52If ([Bridge MHD NBIS]Item52=0)CBItem52:=1Else CBItem52:=0End if ÊÊ`Blank check box for Item 98If (Blank ([Bridge MHD NBIS]Item98A))CBItem98:=1Else CBItem98:=0End if ÊÊ`Checkbox for Item 53CBItem53:=0Case of : ([Bridge MHD NBIS]Item53=99.99)CBItem53:=1End case ÊÊ`Checkbox for Item 54BCBItem54:=0Case of : ([Bridge MHD NBIS]Item54B=99.99)CBItem54:=1End case ÊÊ`Radio buttons for Bypass detour lengthrItem19a:=0rItem19b:=0rItem19c:=0Case of : ([Bridge MHD NBIS]Item19=0)rItem19a:=1: ([Bridge MHD NBIS]Item19=1)rItem19b:=1: ([Bridge MHD NBIS]Item19=199)rItem19c:=1End case ÊÊ`Radio buttons for feature underneath for Item 54Case of : ([Bridge MHD NBIS]Item54A="H")sItem54h:=1: ([Bridge MHD NBIS]Item54A="R")sItem54r:=1: ([Bridge MHD NBIS]Item54A="N")sItem54n:=1End case ÊÊ`Radio buttons for feature underneath for Item 55Case of : ([Bridge MHD NBIS]Item55A="H")tItem55h:=1: ([Bridge MHD NBIS]Item55A="R")tItem55r:=1: ([Bridge MHD NBIS]Item55A="N")tItem55n:=1End case ÊÊ`Check box for Item 55If ([Bridge MHD NBIS]Item55B>30)CBItem55:=1Else CBItem55:=0End if ÊÊ`radio buttons for Item 56Case of : ([Bridge MHD NBIS]Item56=99.9)uItem56a:=1: ([Bridge MHD NBIS]Item56=99.8)uItem56b:=1: ([Bridge MHD NBIS]Item56=0)uItem56c:=1: (([Bridge MHD NBIS]Item56<99.8)Ê&Ê([Bridge MHD NBIS]Item56>0))uItem56d:=1End case ÊÊ`Init integral bridge typeIf ([Bridge MHD NBIS]JointlessType="")[Bridge MHD NBIS]JointlessType:="X"PushChange (1;->[Bridge MHD NBIS]JointlessType)ÊÊ`Added Mar-03 (was missing)aIntegralD_:=Find in array(aIntegralC_;"X")End if ÊÊ`Init Item 42    If ([Bridge MHD NBIS]Item42="")[Bridge MHD NBIS]Item42:="  "item42a:=Substring([Bridge MHD NBIS]Item42;1;1)ÊÊ`need to redo related popupsPOPUPMENUC (->aItem42aDes;->aItem42a;->item42a)item42b:=Substring([Bridge MHD NBIS]Item42;2;1)POPUPMENUC (->aItem42bDes;->aItem42b;->item42b)PushChange (1;->[Bridge MHD NBIS]Item42)End if ÊÊ`Init Item 43 If ([Bridge MHD NBIS]Item43="")[Bridge MHD NBIS]Item43:="   "item43a:=Substring([Bridge MHD NBIS]Item43;1;1)ÊÊ`need to redo related popupsPOPUPMENUC (->aItem43aDes;->aItem43a;->item43a)item43b:=Substring([Bridge MHD NBIS]Item43;2;2)POPUPMENUC (->aItem43bDes;->aItem43b;->item43b)PushChange (1;->[Bridge MHD NBIS]Item43)End if ÊÊ`Init item 44If ([Bridge MHD NBIS]Item44="")[Bridge MHD NBIS]Item44:="   "item44a:=Substring([Bridge MHD NBIS]Item44;1;1)ÊÊ`need to redo related popupsPOPUPMENUC (->aItem44aDes;->aItem44a;->item44a)item44b:=Substring([Bridge MHD NBIS]Item44;2;2)POPUPMENUC (->aItem44bDes;->aItem44b;->item44b)PushChange (1;->[Bridge MHD NBIS]Item44)End if ÊÊ`added to get the Recommended Posting values from the [RatingReports] tableIf (([Bridge MHD NBIS]PostingStatus="DESIGN")Ê|Ê([Bridge MHD NBIS]PostingStatus="CLOSED"))vRecPostingH:=0vRecPost3:=0vRecPost3S2:=0Else G_SIA_GetRecPostings End if SIA_ScourRank_OM SIA_BridgeRankOM SIA_SecureInputForm ("RELEASE")ÊÊ`make sure we start clean..SIA_SecureInputForm ("APPLY")If (User in group($currUser_txt;"MBTA"))If (User in group($currUser_txt;"MBTA_RO"))SIA_SecureInputForm ("LOCK")End if Else If ([Bridge MHD NBIS]Item8 BridgeCat="@RO")If (User in group($currUser_txt;"RRBridgeEdit")Ê|ÊUser in group($currUser_txt;"BMS Admin")Ê|ÊUser in group($currUser_txt;"Application Admin"))Else SIA_SecureInputForm ("LOCK")End if Else If (Not(User in group($currUser_txt;"SIA Access"))Ê|ÊNot(BRG_RWAccess ))SIA_SecureInputForm ("LOCK")End if End if End if ÊÊ```` ÊÊ```` Changes for MBTA RatingsÊÊ````SET VISIBLE(*;"DisplayOnlyRtg@";True)SET VISIBLE(*;"MBTARating_@";False)If ([Bridge MHD NBIS]InspResp="MBTA")SET VISIBLE(*;"DisplayOnlyRtg@";False)SET VISIBLE(*;"MBTARating_@";True)QUERY([RAILBridgeInfo];[RAILBridgeInfo]BIN=[Bridge MHD NBIS]BIN)If ((User in group($currUser_txt;"MBTA_FullEdit"))Ê|Ê(User in group($currUser_txt;"MBTA_Inspectors"))Ê|ÊUser in group(Current user;"Design Access Group"))InitChangeStack (2)If (Records in selection([RAILBridgeInfo])=1)If (ut_LoadRecordInteractive (->[RAILBridgeInfo]))Else ALERT("Cannot edit Rating Loads at this time!")SET ENTERABLE(*;"MBTARating_@";False)SET COLOR(*;"MBTARating_@";×Color_not_editable)End if Else CREATE RECORD([RAILBridgeInfo])[RAILBridgeInfo]BIN:=[Bridge MHD NBIS]BIN[RAILBridgeInfo]Created_Date_d:=Current date(*)[RAILBridgeInfo]Created_Time_t:=Current time(*)[RAILBridgeInfo]CreatedBy_s:=Current user[RAILBridgeInfo]LineName:=[Bridge MHD NBIS]RRBranch[RAILBridgeInfo]MilePt:=[Bridge MHD NBIS]RRBridgeNoLogNewRecord (->[RAILBridgeInfo]BIN;->[RAILBridgeInfo]BIN;->[RAILBridgeInfo]BIN;0;"")PushChange (2;->[RAILBridgeInfo]Created_Date_d)PushChange (2;->[RAILBridgeInfo]Created_Time_t)PushChange (2;->[RAILBridgeInfo]CreatedBy_s)PushChange (2;->[RAILBridgeInfo]LineName)PushChange (2;->[RAILBridgeInfo]MilePt)FlushGrpChgs (2;->[RAILBridgeInfo]BIN;->[RAILBridgeInfo]BIN;->[RAILBridgeInfo]BIN;0)SAVE RECORD([RAILBridgeInfo])End if Else SET ENTERABLE(*;"MBTARating_@";False)SET COLOR(*;"MBTARating_@";×Color_not_editable)End if End if If (GRP_UserInGroup ("TEMP_EditLatLon")=1)SIA_SecureInputForm ("EDITLATLONG")End if If (Read only state([Bridge MHD NBIS]))SIA_SecureInputForm ("LOCK")End if : (Form event=On Validate )If (Modified record([Bridge MHD NBIS]))If (Size of array(ptr_changes{1})>0)ÊÊ`added this to avoid un-needed log entriesTimeStamp (->[Bridge MHD NBIS];->[Bridge MHD NBIS]DateCreated;->[Bridge MHD NBIS]TimeCreated;->[Bridge MHD NBIS]DateModified;->[Bridge MHD NBIS]TimeModified)[Bridge MHD NBIS]Modified By:=$currUser_txtIf ([Bridge MHD NBIS]Modified By#Old([Bridge MHD NBIS]Modified By))PushChange (1;->[Bridge MHD NBIS]Modified By)End if If ([Bridge MHD NBIS]DateModified#Old([Bridge MHD NBIS]DateModified))PushChange (1;->[Bridge MHD NBIS]DateModified)End if PushChange (1;->[Bridge MHD NBIS]TimeModified)End if ÊÊ`Recalculate the AASHTO Sufficiency rating[Bridge MHD NBIS]AASHTO:=AASHTO_SuffRat If ([Bridge MHD NBIS]AASHTO#Old([Bridge MHD NBIS]AASHTO))PushChange (1;->[Bridge MHD NBIS]AASHTO)ÊÊ`This should be recalculated at the remote!End if If ([Bridge MHD NBIS]Item67#Old([Bridge MHD NBIS]Item67))PushChange (1;->[Bridge MHD NBIS]Item67)End if If ([Bridge MHD NBIS]Item68#Old([Bridge MHD NBIS]Item68))PushChange (1;->[Bridge MHD NBIS]Item68)End if If ([Bridge MHD NBIS]Item69#Old([Bridge MHD NBIS]Item69))PushChange (1;->[Bridge MHD NBIS]Item69)End if If ([Bridge MHD NBIS]Item70#Old([Bridge MHD NBIS]Item70))PushChange (1;->[Bridge MHD NBIS]Item70)End if If ([Bridge MHD NBIS]Item91#Old([Bridge MHD NBIS]Item91))PushChange (1;->[Bridge MHD NBIS]Item91)End if ÊÊ`##Save changes made to fileFlushGrpChgs (1;->[Bridge MHD NBIS]BIN;->[Bridge MHD NBIS]BIN;->[Bridge MHD NBIS]BIN;0)End if If (Modified record([RAILBridgeInfo]))[RAILBridgeInfo]Modified_Date_d:=Current date(*)[RAILBridgeInfo]Modified_Time_t:=Current time(*)[RAILBridgeInfo]ModifiedBy_s:=Current userPushChange (2;->[RAILBridgeInfo]Modified_Date_d)PushChange (2;->[RAILBridgeInfo]Modified_Time_t)PushChange (2;->[RAILBridgeInfo]ModifiedBy_s)FlushGrpChgs (2;->[RAILBridgeInfo]BIN;->[RAILBridgeInfo]BIN;->[RAILBridgeInfo]BIN;0)SAVE RECORD([RAILBridgeInfo])End if If (Not(User in group($currUser_txt;"SIA Access")))SET ENTERABLE(*;"Field@";True)SET ENTERABLE(*;"Featur@";True)SET ENTERABLE(*;"UW @";True)SET ENTERABLE(*;"DE @";True)SET COLOR(*;"Field@";×Color_editable)SET COLOR(*;"Featur@";×Color_editable)SET COLOR(*;"UW @";×Color_editable)SET COLOR(*;"DE @";×Color_editable)SET ENTERABLE(*;"Variable@";True)ENABLE BUTTON(*;"Variable@")ENABLE BUTTON(*;"Featur@")End if : (Form event=On Unload )SIA_HelpTipCtrl ("RESET")End case 