ÊÊ`G_InspExtraCmtsBtnÊÊ`v3.3f3ÊÊ`Usage :ÊÊ`G_InspExtraCmtsBtn (VsLabel;vCommentsFieldPtr;Self;Stack)ÊÊ` VsLabel : string : Label for the commentsÊÊ` vCommentsFieldPtr : pointer : pointer to the field where the comments are storeÊÊ` Self : pointer : pointer to the button calling this methodÊÊ` Stack : number of the stack for PushChangeIf (False)Mods_2004_CM12 Mods_2009_03 ÊÊ`CJM  r001   `03/06/09, 14:19:18`Upgrade from open form window to open windowÊÊ` Modified by: Costas Manousakis-(Designer)-(12/3/13 10:01:45)Mods_2013_12 ÊÊ`ÊÊ`added 4th optional param for the change stack numberEnd if C_STRING(132;$1;vsExtraTextLabel)C_POINTER($2;$vpCmtsField;$3;$vpButton)vsExtraTextLabel:=$1$vpCmtsField:=$2$vpButton:=$3C_LONGINT($ChangeStack_L)$ChangeStack_L:=1If (Count parameters>3)C_LONGINT($4)$ChangeStack_L:=$4End if C_TEXT(vtExtraText)vtExtraText:=$vpCmtsField->C_LONGINT($Width_l;$Height_l;$Win_l;$Pages_l)C_BOOLEAN($FixedWidth_b;$FixedHeight_b)C_TEXT($Title_txt)GET FORM PROPERTIES([Dialogs];"GetInspExtraCmts";$Width_l;$Height_l;$Pages_l;$FixedWidth_b;$FixedHeight_b;$Title_txt)$Win_l:=ut_OpenNewWindow ($Width_l;$Height_l;0;Movable form dialog box )ÊÊ`$tempwin:=Open form window([Dialogs];"GetInspExtraCmts";Movable form dialog box )DIALOG([Dialogs];"GetInspExtraCmts")CLOSE WINDOWIf (OK=1)$vpCmtsField->:=f_TrimStr (vtExtraText;True;True)PushChange ($ChangeStack_L;$vpCmtsField)If (Length($vpCmtsField->)>0)SET COLOR($vpButton->;-(Black ))Else SET COLOR($vpButton->;-(Red ))End if End if 