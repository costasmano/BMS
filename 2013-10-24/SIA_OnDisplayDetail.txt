  `Method: SIA_OnDisplayDetail  `Description  `  ` Parameters  ` ----------------------------------------------------If (False)  `----------------------------------------------------  `User name (OS): Charles Miller  `Date and time: 02/23/12, 13:36:29  `----------------------------------------------------Mods_2012_02   `r003  `Modified by: Charles Miller (2/23/12 13:36:30)Mods_2012_03   `r003 `Add code to use list box for Inventory button on   `Modified by: Charles Miller (3/29/12 14:14:09)  ` Modified by: Costas Manousakis-(Designer)-(4/11/13 16:38:53)Mods_2013_04   `Tunnel Inspection pg 11  ` Modified by: Costas Manousakis-(Designer)-(10/24/13 11:19:39)Mods_2013_10   `  `use  method  INSP_IsInspRoutine_b to check if inspection is a routine oneEnd if Case of : (Current form page=2)If ((Month of([Cons Inspection]InspMonth)=0) | (Year of([Cons Inspection]InspMonth)=0))LB_Detail1_txt:=""Else LB_Detail1_txt:=String(Month of([Cons Inspection]InspMonth))+"/"+String(Year of([Cons Inspection]InspMonth))End if If ([Cons Inspection]AssignStatus="Insp. Notification Received")LB_Detail7_txt:="Notifctn Recvd"Else LB_Detail7_txt:=[Cons Inspection]AssignStatusEnd if : (Current form page=7)LB_Detail1_txt:=[Inspection Type]DescriptionQUERY([Inspections];[Inspections]InspID=[Combined Inspections]NBISInspID)C_BOOLEAN($vbCombined)Case of : (INSP_IsInspRoutine_b )If (Substring(◊Version;1;(Position(" ";◊Version)-1))>="5.0")$vbCombined:=[Inspections]InspRtnSpcMemFlagElse $vbCombined:=(G_Insp_CountSpMs >0)End if : (([Inspections]Insp Type="RRR") | ([Inspections]Insp Type="RRA") | ([Inspections]Insp Type="RRC"))$vbCombined:=(G_Insp_CountSpMs >0)LB_Detail1_txt:=Replace string(LB_Detail1_txt;"RailRoad/Transit";"R/T")End case If ($vbCombined)LB_Detail1_txt:=LB_Detail1_txt+" & Spec.Mem."End if Case of : ([Inspections]InspReviewed=0)LB_Detail10_pct:=LB_Detail10_pct*0: ([Inspections]InspReviewed=1)GET PICTURE FROM LIBRARY("BMS RejectIcon";LB_Detail10_pct): ([Inspections]InspReviewed=2)GET PICTURE FROM LIBRARY("BMS ApproveIcon";LB_Detail10_pct)End case Case of : ([Inspections]InspApproved=0)LB_Detail11_pct:=LB_Detail11_pct*0: ([Inspections]InspApproved=1)GET PICTURE FROM LIBRARY("BMS RejectIcon";LB_Detail11_pct): ([Inspections]InspApproved=2)GET PICTURE FROM LIBRARY("BMS ApproveIcon";LB_Detail11_pct)End case LB_Detail3_txt:=[Inspections]Item 58  `vsInc_Insp_I59:=[Inspections]Item 59  `If ([Inspections]Insp Type="DV@")LB_Detail5_txt:=[Inspections]Item 60 UWLB_Detail6_txt:=[Inspections]Item 61 UWLB_Detail7_txt:=[Inspections]Item 62 UWElse LB_Detail5_txt:=[Inspections]Item 60LB_Detail6_txt:=[Inspections]Item 61LB_Detail7_txt:=[Inspections]Item 62End if Case of : ([Inspections]Insp Type="FCR")LB_Detail3_txt:=""LB_Detail6_txt:=""LB_Detail7_txt:="": ([Inspections]Insp Type="CMI")LB_Detail6_txt:=""End case If ([Inspections]InspComplete)GET PICTURE FROM LIBRARY("Mark_on";LB_Detail9_pct)Else GET PICTURE FROM LIBRARY("Mark_Off";LB_Detail9_pct)End if : (Current form page=8)Case of : ([InventoryPhotoInsp]Approved_I=0)LB_Detail3_pct:=LB_Detail3_pct*0: ([InventoryPhotoInsp]Approved_I=1)GET PICTURE FROM LIBRARY("BMS RejectIcon";LB_Detail3_pct): ([InventoryPhotoInsp]Approved_I=2)GET PICTURE FROM LIBRARY("BMS ApproveIcon";LB_Detail3_pct)End case If ([InventoryPhotoInsp]Complete_B)GET PICTURE FROM LIBRARY("Mark_on";LB_Detail2_pct)Else GET PICTURE FROM LIBRARY("Mark_Off";LB_Detail2_pct)End if : (Current form page=11)LB_Detail1_txt:=[Inspection Type]DescriptionQUERY([Inspections];[Inspections]InspID=[Combined Inspections]NBISInspID)QUERY([TunnelInspection];[TunnelInspection]InspID=[Inspections]InspID)C_BOOLEAN($vbCombined)If (INSP_IsInspRoutine_b )If (Substring(◊Version;1;(Position(" ";◊Version)-1))>="5.0")$vbCombined:=[Inspections]InspRtnSpcMemFlagElse $vbCombined:=(G_Insp_CountSpMs >0)End if End if If ($vbCombined)LB_Detail1_txt:=LB_Detail1_txt+" & Spec.Mem."End if Case of : ([Inspections]InspReviewed=0)LB_Detail12_pct:=LB_Detail12_pct*0: ([Inspections]InspReviewed=1)GET PICTURE FROM LIBRARY("BMS RejectIcon";LB_Detail12_pct): ([Inspections]InspReviewed=2)GET PICTURE FROM LIBRARY("BMS ApproveIcon";LB_Detail12_pct)End case Case of : ([Inspections]InspApproved=0)LB_Detail13_pct:=LB_Detail13_pct*0: ([Inspections]InspApproved=1)GET PICTURE FROM LIBRARY("BMS RejectIcon";LB_Detail13_pct): ([Inspections]InspApproved=2)GET PICTURE FROM LIBRARY("BMS ApproveIcon";LB_Detail13_pct)End case   `vsInc_Insp_I59:=[Inspections]Item 59  `Case of : ([Inspections]Insp Type="TAL")LB_Detail3_txt:=[TunnelInspection]Structural_Rtg_sLB_Detail4_txt:=[TunnelInspection]Roadway_Rtg_sLB_Detail5_txt:=[TunnelInspection]Ceiling_Rtg_sLB_Detail6_txt:=[TunnelInspection]SupplyAirDuct_Rtg_sLB_Detail7_txt:=[TunnelInspection]CrossPassage_Rtg_sLB_Detail8_txt:=[TunnelInspection]Egress_Rtg_sLB_Detail9_txt:=[TunnelInspection]UtilityRoom_Rtg_s: ([Inspections]Insp Type="TOV")LB_Detail3_txt:=""LB_Detail4_txt:=""LB_Detail5_txt:=[TunnelInspection]Ceiling_Rtg_sLB_Detail6_txt:=""LB_Detail7_txt:=""LB_Detail8_txt:=""LB_Detail9_txt:="": ([Inspections]Insp Type="TSP")LB_Detail3_txt:=[TunnelInspection]Structural_Rtg_sLB_Detail4_txt:=[TunnelInspection]Roadway_Rtg_sLB_Detail5_txt:=[TunnelInspection]Ceiling_Rtg_sLB_Detail6_txt:=[TunnelInspection]SupplyAirDuct_Rtg_sLB_Detail7_txt:=[TunnelInspection]CrossPassage_Rtg_sLB_Detail8_txt:=[TunnelInspection]Egress_Rtg_sLB_Detail9_txt:=[TunnelInspection]UtilityRoom_Rtg_sEnd case If ([Inspections]InspComplete)GET PICTURE FROM LIBRARY("Mark_on";LB_Detail11_pct)Else GET PICTURE FROM LIBRARY("Mark_Off";LB_Detail11_pct)End if Else End case   `End SIA_OnDisplayDetail