  ` Method: INSP_SaveRecords  ` Description  ` Save the Inspection records [Inspection] [Combined; [BMS;  ` Extracted code from G_InspSaveInspection  `  ` ParametersIf (False)  ` ----------------------------------------------------  ` User name (OS): costasmanousakis  ` User name (4D): Designer  ` Date and time: 12/16/05, 15:08:10  ` ----------------------------------------------------  ` ----------------------------------------------------Mods_2005_CM20   ` Modified by: Costas Manousakis-(Designer)-(5/1/13 17:30:33)Mods_2013_05   `  `Added Tunnel Inspection  ` Modified by: Costas Manousakis-(Designer)-(10/24/13 11:19:39)Mods_2013_10   `  `use  method  INSP_IsInspRoutine_b to check if inspection is a routine oneEnd if SET CURSOR(4)  `Check if it is a combined inspectionIf (INSP_IsInspRoutine_b )C_LONGINT($vlNumSpecMems)$vlNumSpecMems:=G_Insp_CountSpMs If ([Inspections]InspRtnSpcMemFlag#($vlNumSpecMems>0))[Inspections]InspRtnSpcMemFlag:=($vlNumSpecMems>0)If (Substring(◊Version;1;(Position(" ";◊Version)-1))>="5.0")PushChange (1;->[Inspections]InspRtnSpcMemFlag)End if End if End if   `check if any changes madeIf (Size of array(ptr_Changes{1})>0)[Inspections]DateModified:=Current date(*)[Inspections]TimeModified:=Current time(*)PushChange (1;->[Inspections]DateModified)PushChange (1;->[Inspections]TimeModified)End if   `##Save changes made to fileFlushGrpChgs (1;->[Bridge MHD NBIS]BIN;->[Inspections]BIN;->[Inspections]InspID;1)SAVE RECORD([Inspections])If (([Inspections]Insp Type="TAL") | ([Inspections]Insp Type="TOV") | ([Inspections]Insp Type="TSP"))FlushGrpChgs (5;->[Inspections]InspID;->[TunnelInspection]InspID;->[TunnelInspection]TunnelInspID_L;2)SAVE RECORD([TunnelInspection])End if INSP_CheckLinks If ([Combined Inspections]BMSInspID>0)If (Is record loaded([BMS Inspections]))If ([BMS Inspections]Insp Date#[Inspections]Insp Date)[BMS Inspections]Insp Date:=[Inspections]Insp DatePushChange (3;->[BMS Inspections]Insp Date)End if FlushGrpChgs (3;->[Bridge MHD NBIS]BIN;->[BMS Inspections]BIN;->[BMS Inspections]Inspection ID;1)SAVE RECORD([BMS Inspections])End if End if If ([Combined Inspections]InspDate#[Inspections]Insp Date)[Combined Inspections]InspDate:=[Inspections]Insp DatePushChange (4;->[Combined Inspections]InspDate)End if FlushGrpChgs (4;->[Bridge MHD NBIS]BIN;->[Combined Inspections]BIN;->[Combined Inspections]ID;1)SAVE RECORD([Combined Inspections])VALIDATE TRANSACTION  `validate all changes made in include forms etc.FLUSH BUFFERS  `make sure all is saved...SET CURSOR(0)