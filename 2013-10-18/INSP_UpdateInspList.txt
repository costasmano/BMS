If (False)ÊÊ` ----------------------------------------------------ÊÊ` User name (OS): costasmanousakisÊÊ` User name (4D): DesignerÊÊ` Date and time: 08/20/08, 08:07:27ÊÊ` ----------------------------------------------------ÊÊ` Method: INSP_UpdateInspListÊÊ` DescriptionÊÊ` Update / get the current list of inspections for the current BINÊÊ` ÊÊ` ParametersÊÊ` $1 : $Bin_s [Optional]ÊÊ` ----------------------------------------------------Mods_2008_CM_5404 ÊÊ` Modified by: costasmanousakis-(Designer)-(4/10/09 08:49:17)Mods_2009_04 ÊÊ`Use the new effect of GOTO SELECTED RECORD to clear the selection of inspections.ÊÊ` Modified by: Costas Manousakis-(Designer)-(1/2/13 11:49:34)Mods_2013_01 ÊÊ`ÊÊ`Added call to ut_Read_Write_Tables ("READ";.. to set tables to RO before getting the selectionÊÊ` Modified by: Costas Manousakis-(Designer)-(4/12/13 16:16:51)Mods_2013_04 ÊÊ`ÊÊ`Use new INSP_Read_Write_TablesÊÊ` Modified by: Costas Manousakis-(Designer)-(5/1/13 13:49:05)Mods_2013_05 ÊÊ`ÊÊ`different inspection list for Bridges or TunnelsEnd if C_STRING(3;$BIN_s)If (Count parameters>0)C_STRING(3;$1)$BIN_s:=$1Else $BIN_s:=[Bridge MHD NBIS]BINEnd if C_BOOLEAN(vbInspRefresh)INSP_Read_Write_Tables ("READ")QUERY([Combined Inspections];[Combined Inspections]BIN=$BIN_s)C_TEXT(INSP_Inspection_list_txt)If (INSP_Inspection_list_txt="")INSP_Inspection_list_txt:="BRIDGE"End if Case of : (INSP_Inspection_list_txt="BRIDGE")QUERY SELECTION([Combined Inspections];[Combined Inspections]InspType#"TAL";*)QUERY SELECTION([Combined Inspections];Ê&Ê;[Combined Inspections]InspType#"TOV";*)QUERY SELECTION([Combined Inspections];Ê&Ê;[Combined Inspections]InspType#"TSP"): (INSP_Inspection_list_txt="TUNNEL")QUERY SELECTION([Combined Inspections];[Combined Inspections]InspType="TAL";*)QUERY SELECTION([Combined Inspections];Ê|Ê;[Combined Inspections]InspType="TOV";*)QUERY SELECTION([Combined Inspections];Ê|Ê;[Combined Inspections]InspType="TSP")End case ORDER BY([Combined Inspections];[Combined Inspections]InspDate;<)UNLOAD RECORD([Combined Inspections])UNLOAD RECORD([Inspections])UNLOAD RECORD([BMS Inspections])vbInspRefresh:=FalseÊÊ`mark this to not refresh inspection listÊÊ`we need to refresh inspection listCOPY NAMED SELECTION([Combined Inspections];"curCombinedInspection")GOTO SELECTED RECORD([Combined Inspections];0)