ÊÊ`Method: Form Method: [Inspections]InspectionReviewÊÊ`DescriptionÊÊ`ÊÊ` ParametersÊÊ` ----------------------------------------------------If (False)ÊÊ`----------------------------------------------------ÊÊ`User name (OS): Charles MillerÊÊ`Date and time: 06/28/13, 14:35:50ÊÊ`----------------------------------------------------Mods_2005_CM05 Mods_2005_CM12 ÊÊ` Modified by: costasmanousakis-(Designer)-(12/5/2005 11:41:38)Mods_2005_CM19 ÊÊ` Modified by: costasmanousakis-(Designer)-(6/2/2006 14:17:07)Mods_2006_CM04 ÊÊ` Modified by: costasmanousakis-(Designer)-(11/1/2007 14:36:53)Mods_2007_CM12_5302 ÊÊ` Modified by: costasmanousakis-(Designer)-(6/2/10 09:54:42)Mods_2010_06 ÊÊ`ÊÊ`Use new method INSP_SortReviewList at the on load event; don't do anything at the On Header.ÊÊ`ÊÊ`Sorting will be done at the buttons.ÊÊ`ÊÊ`Also added grey bar picture on the header and footer of the formÊÊ` Modified by: costasmanousakis-(Designer)-(8/27/10 14:08:02)Mods_2010_08 ÊÊ`ÊÊ`Removed the disbaling of the Print buttonMods_2013_03 ÊÊ`r001 ` Add code to set headings for MBTA engineersÊÊ`Modified by: Charles Miller (3/7/13 17:02:22)ÊÊ` Modified by: manousakisc (5/31/2013)Mods_2013_05 ÊÊ`ÊÊ`Added Redraw Window at end of on Close DetailMods_2013_06 ÊÊ`r001 ` Change titles fromÊÊ`QC'D, QA'D to Revwd AprvdÊÊ`by removed MBTA text objects and renaming notMBTA object names back to TextÊÊ`Modified by: Charles Miller (6/28/13 14:32:32)ÊÊ` Modified by: Costas Manousakis-(Designer)-(10/24/13 11:19:02)Mods_2013_10 ÊÊ`ÊÊ`use  method  INSP_IsInspRoutine_b to check if inspection is a routine oneÊÊ` Modified by: Costas Manousakis-(Designer)-(10/31/13 14:36:47)Mods_2013_10 ÊÊ`ÊÊ`Added sorting by complete, reviewed, approved columns ;ÊÊ`ÊÊ`Adjusted size of forms and moved objects to fit the new sort buttons.End if Case of : (Form event=On Load )C_TEXT($CurrUser_txt)$CurrUser_txt:=×CurrentUser_NameÊÊ`initialize sort buttons.    C_INTEGER(SortBdept;SortBIN;SorttmLdr;SortInspType;SortInspDate;SortInspCompl;SortInspApprove;SortInspReview)C_BOOLEAN(vbSortedHeader)C_STRING(255;vInspTitle)C_STRING(44;vTmLeader)C_INTEGER(vPicButtonReview;vPicButtonAppr)vbSortedHeader:=FalseC_POINTER(MultiLevelTbl)MultiLevelTbl:=->[Inspections]ARRAY POINTER(aPtrSortField;0)ARRAY POINTER(aPtrSortOrder;0)SortInspDate:=0SortBIN:=0SortBdept:=1SorttmLdr:=0SortInspType:=0SortInspCompl:=0SortInspApprove:=0SortInspReview:=0ÊÊ`ORDER BY([Inspections];[Bridge MHD NBIS]BDEPT;>)If (vApproveLvl=0)DISABLE BUTTON(*;"ApproveButton")End if If (Type(InspRespDescSel_atxt)#String array )ÊÊ` not a string arrayIf (Size of array(InspRespDescSel_atxt)>0)Else DISABLE BUTTON(*;"InspResp Select")SET VISIBLE(*;"InspResp Select@";False)End if End if INSP_SortReviewList : ((Form event=On Header )Ê&ÊNot(vbSortedHeader))If (False)INSP_SortReviewList End if : (Form event=On Display Detail )If ([Inspections]InitialInsp)vInspTitle:="Initial "+[Inspection Type]DescriptionElse vInspTitle:=[Inspection Type]DescriptionEnd if If (INSP_IsInspRoutine_b )C_BOOLEAN($vbCombined)If (Substring(×Version;1;(Position(" ";×Version)-1))>="5.0")$vbCombined:=[Inspections]InspRtnSpcMemFlagElse $vbCombined:=(G_Insp_CountSpMs >0)End if If ($vbCombined)vInspTitle:=vInspTitle+" & Spec.Mem."End if End if vTmLeader:=Get_Description (->aPeople;->aPeople_ID;->[Inspections]TeamLeader)vPicButtonReview:=[Inspections]InspReviewedvPicButtonAppr:=[Inspections]InspApproved: (Form event=On Open Detail )READ ONLY([Bridge MHD NBIS])C_LONGINT(vlInspRevWWid;vlInspRevWHt)C_LONGINT($vlLeft;$vlTop;$vlRight;$vlBot)GET WINDOW RECT($vlLeft;$vlTop;$vlRight;$vlBot)vlInspRevWWid:=$vlRight-$vlLeftvlInspRevWHt:=$vlBot-$vlTop$vlRight:=$vlLeft+740$vlBot:=$vlTop+540If ($vlRight>(Screen width-5))$vlLeft:=Screen width-740-5If ($vlLeft<1)$vlLeft:=1End if $vlRight:=Screen width-5End if If ($vlBot>(Screen height-5))$vlTop:=Screen height-540-5If ($vlTop<15)$vlTop:=15End if $vlBot:=Screen height-5End if C_LONGINT(INSPRV_CurrID_L;INSPRV_NumInSel_L)INSPRV_CurrID_L:=Selected record number([Inspections])INSPRV_NumInSel_L:=Records in selection([Inspections])SET WINDOW RECT($vlLeft;$vlTop;$vlRight;$vlBot)COPY NAMED SELECTION([Inspections];"TempInspectsOpen"): (Form event=On Close Detail )If (Records in selection([Inspections])=0)USE NAMED SELECTION("TempInspectsOpen")End if CLEAR NAMED SELECTION("TempInspectsOpen")If (Records in selection([Inspections])#INSPRV_NumInSel_L)COPY NAMED SELECTION([Inspections];"UserRegionA")RegionTitle If (INSPRV_CurrID_L<=Records in selection([Inspections]))Else INSPRV_CurrID_L:=Records in selection([Inspections])End if GOTO SELECTED RECORD([Inspections];INSPRV_CurrID_L)CLEAR SET("UserSet")CREATE EMPTY SET([Inspections];"UserSet")ADD TO SET([Inspections];"UserSet")HIGHLIGHT RECORDSEnd if C_LONGINT($vlLeft;$vlTop;$vlRight;$vlBot)GET WINDOW RECT($vlLeft;$vlTop;$vlRight;$vlBot)SET WINDOW RECT($vlLeft;$vlTop;$vlLeft+vlInspRevWWid;$vlTop+vlInspRevWHt)READ WRITE([Bridge MHD NBIS])REDRAW WINDOW: (Form event=On Outside Call )If (×fQuit)CANCELEnd if : (Form event=On Activate )UpdatFilesPalet : (Form event=On Deactivate )UpdatFilesPalet ÊÊ`REDRAW(×asWindows)End case ÊÊ`End Form Method: [Inspections]InspectionReview