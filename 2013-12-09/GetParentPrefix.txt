ÊÊ`GetParentPrefix ÊÊ`Created by Albert LeungÊÊ`Created 9/19/2002ÊÊ`Purpose: Get the Prefix of the parent elementIf (False)ÊÊ` Modified by: costasmanousakis-(Designer)-(10/22/2007 11:12:49)Mods_2007_CM12_5302 ÊÊ` Modified by: costasmanousakis-(Designer)-(11/1/2007 08:36:21)Mods_2007_CM12_5302 ÊÊ` Modified by: Costas Manousakis-(Designer)-(12/27/12 16:49:16)Mods_2012_12 ÊÊ`ÊÊ`Added special case for Rail RR@ÊÊ` Modified by: Costas Manousakis-(Designer)-(12/9/13 16:43:39)Mods_2013_12 ÊÊ`ÊÊ`Added  the case for Tunnel inspectionsEnd if C_STRING(4;$vsDescr)C_STRING(4;$0)C_INTEGER($ElmNo_i;$ElmParNo_i;$k)If (Count parameters=1)C_INTEGER($1)$ElmNo_i:=$1Else $ElmNo_i:=[ElementsSafety]ElementNoEnd if $vsDescr:=""$K:=Find in array(×ELMTDICT_ELNum_ai;$ElmNo_i)If ($k>0)$ElmParNo_i:=×ELMTDICT_Parent_ai{$k}If ($ElmParNo_i#0)ÊÊ`Does this element have a parent?$K:=Find in array(×ELMTDICT_ELNum_ai;$ElmParNo_i)Case of : ([Inspections]Insp Type="RTA")$vsDescr:=×ELMTDICT_Part_as{$K}If ($vsDescr="")$vsDescr:=×ELMTDICT_Prefix_as{$K}End if : (([Inspections]Insp Type="RR@")Ê|Ê([Inspections]Insp Type="R@"))$K:=Find in array(INSP_NewElementNumbers_ai;$ElmParNo_i)If ($K>0)$vsDescr:=INSP_NewElementLabels_atxt{$k}End if Else $vsDescr:=×ELMTDICT_Prefix_as{$K}End case End if End if $0:=$vsDescr