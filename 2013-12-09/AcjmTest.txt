If (False)C_BOOLEAN($OkToProceed_b;$NewMaximoInsection_b)C_STRING(100;$ESDesc_s;$ElementCatDesc_s)C_STRING(50;$ESDef_s;$ESPrit_s;$ElementCatCode_s)C_TEXT($ESComm_txt)C_LONGINT($ElementSafetyID_L;$ElementDictPos_l;$ElementNo_L;$catIndx_L)C_STRING(100;$StdPhotoDesciption_s)C_BLOB($StdPhotoPicture_blb)C_LONGINT($StdPhotoID_L)$OkToProceed_b:=ut_LoadSQLConnectionInfo ("MAXCORA06")SQLError_b:=FalseON ERR CALL("SQL_ERROR")SQL LOGIN("ODBC:"+[SQL_Connections]SQL_OBDCName_s;[SQL_Connections]SQL_UserName_s;[SQL_Connections]SQL_Password_s)ON ERR CALL("")If (False)QUERY([ElementsSafety];[ElementsSafety]ElmSafetyID=$ElementSafetyID_L)$ESPrit_s:=[ElementsSafety]Priority$ESDef_s:=[ElementsSafety]Deficiency$ElementNo_L:=[ElementsSafety]ElementNo$ElementDictPos_l:=Find in array(◊ELMTDICT_ELNum_ai;[ElementsSafety]ElementNo)$ElementCatCode_s:=◊ELMTDICT_Cat_as{$ElementDictPos_l}$catIndx_L:=Find in array(◊ALLElmtCatCode_as;◊ELMTDICT_Cat_as{$ElementDictPos_l})If ($catIndx_L>0)$ElementCatDesc_s:=◊ALLElmtCatDesc_as{$catIndx_L}Else $ElementCatDesc_s:=◊ELMTDICT_Cat_as{$ElementDictPos_l}End if $FindPosition_L:=Find in array($ElementIDS_aL;$ElementSafetyID_L)If (Length([ElementsSafety]Description)>0)$ESDesc_s:=[ElementsSafety]DescriptionElse $ESDesc_s:=◊ELMTDICT_Txt_as{$ElementDictPos_l}End if $ESComm_txt:=Fn_GetTextBlob ([ElementsSafety]ElmComments)ON ERR CALL("SQL_ERROR")SQL EXECUTE("UPDATE ELEMENTSSAFETY_4D set  DESCRIPTION = :$ESDesc_s, COMMENTS=:$ESComm_txt, DEFICIENCY=:$ESDef_s, PRIORITY=:$ESPrit_s, CATEGORY=:$ElementCatCode_s, CATEGORYDESC=:$ElementCatDesc_s, ELEMENTNO=:$ElementNo_L, DISTRICT=:$Dist_s, PROCESSED=:$PFlag_txt  "+"where ELMSAFETYID= :$ElementSafetyID_L; ")SQL CANCEL LOADON ERR CALL("")End if If (False)ON ERR CALL("SQL_ERROR")SQL EXECUTE("update ELEMENTSSAFETY_4D set PROCESSED = 'D' where ELMSAFETYID = :$ElementSafetyID_L ;")SQL CANCEL LOADON ERR CALL("")End if If (False)QUERY([Standard Photos];[Standard Photos]StdPhotoID=$StdPhotoID_L)Case of : ([Standard Photos]PictType=BMS Photo )$StdPhotoDesciption_s:="Photo ": ([Standard Photos]PictType=BMS Sketch )$StdPhotoDesciption_s:="Sketch ": ([Standard Photos]PictType=BMS Chart )$StdPhotoDesciption_s:="Chart "Else $StdPhotoDesciption_s:="Unknown "End case $StdPhotoDesciption_s:=$StdPhotoDesciption_s+String([Standard Photos]SeqNum)PICTURE TO BLOB([Standard Photos]Std Photo;$StdPhotoPicture_blb;"JPEG")ON ERR CALL("SQL_ERROR")SQL EXECUTE("update STANDARDPHOTOS_4D set DESCRIPTION = :$StdPhotoDesciption_s, STANDARDPHOTO = :$StdPhotoPicture_blb, PROCESSED = 'U' WHERE STANDARDPHOTOID = :$StdPhotoID_L ;")SQL CANCEL LOADON ERR CALL("")End if If (False)ON ERR CALL("SQL_ERROR")SQL EXECUTE("update STANDARDPHOTOS_4D set PROCESSED = 'D' where STANDARDPHOTOID = :$StdPhotoID_L;")SQL CANCEL LOADON ERR CALL("")End if End if If (False)G_SortTable_new End if If (False)ARRAY TEXT($arrnames;0)ARRAY TEXT($arralnames;0)ARRAY TEXT($arrdrivers;0)PRINTERS LIST($arrnames;$arralnames;$arrdrivers)C_LONGINT($left;$top;$right;$bott;$ht;$wt;$print_loop)C_TEXT($settings)For ($print_loop;1;Size of array($arrnames))SET CURRENT PRINTER($arrnames{$print_loop})$settings:=Get current printer+" - "+$arrnames{$print_loop}+" alt:"+$arralnames{$print_loop}+" driv:"+$arrdrivers{$print_loop}PRINT SETTINGS(1)GET PRINTABLE MARGIN($left;$top;$right;$bott)GET PRINTABLE AREA($ht;$wt)$settings:=$settings+Char(13)+"Marg "+String($left)+" "+String($top)+" "+String($right)+" "+String($bott)+"  Area "+" "+String($ht)+" "+String($wt)$settings:=$settings+Char(13)+"Paper ht :"+String($ht+$top+$bott)+"  wdth:"+String($wt+$left+$right)ALERT($settings)End for End if   `C_LONGINT($inspID_L)  `C_TEXT($BIN_txt)  `$inspID_L:=2345  `$BIN_txt:="D6-B45678-BBB"  `If (OK=1)  `  `Resetting of cursor  `SQL EXECUTE("Select inspid, BIN from Inspections";aInspids;aBINs)  `While (Not(SQL End selection))  `SQL LOAD RECORD  `End while   `  `SQL CANCEL LOAD  `  `SQL EXECUTE("insert into inspections (inspectionsid, inspid, BIN) values ( inspectionsidseq.nextval, :$inspID_L, :$BIN_txt) ; ")  `  `SQL CANCEL LOAD  `SQL EXECUTE("Select inspid, BIN from Inspections";aInspids;aBINs)  `While (Not(SQL End selection))  `SQL LOAD RECORD  `End while   `  `SQL CANCEL LOAD  `End if   `SQL LOGOUTIf (False)C_LONGINT($allflags_L)C_TEXT($flags_txt)$flags_txt:=""$flags_txt:=$flags_txt+"3 mon set "+f_Boolean2String (($allflags_L ?? 1);"YN")+Char(13)$flags_txt:=$flags_txt+"6 mon set "+f_Boolean2String (($allflags_L ?? 2);"YN")+Char(13)$flags_txt:=$flags_txt+"12 mon set "+f_Boolean2String (($allflags_L ?? 3);"YN")+Char(13)$flags_txt:=$flags_txt+"24 mon set "+f_Boolean2String (($allflags_L ?? 24);"YN")+Char(13)ALERT($flags_txt)$allflags_L:=$allflags_L ?+ 1  `set 3 mo$flags_txt:=""$flags_txt:=$flags_txt+"3 mon set "+f_Boolean2String (($allflags_L ?? 1);"YN")+Char(13)$flags_txt:=$flags_txt+"6 mon set "+f_Boolean2String (($allflags_L ?? 2);"YN")+Char(13)$flags_txt:=$flags_txt+"12 mon set "+f_Boolean2String (($allflags_L ?? 3);"YN")+Char(13)$flags_txt:=$flags_txt+"24 mon set "+f_Boolean2String (($allflags_L ?? 24);"YN")+Char(13)ALERT($flags_txt)$allflags_L:=$allflags_L ?+ 2  `set 6 mo$flags_txt:=""$flags_txt:=$flags_txt+"3 mon set "+f_Boolean2String (($allflags_L ?? 1);"YN")+Char(13)$flags_txt:=$flags_txt+"6 mon set "+f_Boolean2String (($allflags_L ?? 2);"YN")+Char(13)$flags_txt:=$flags_txt+"12 mon set "+f_Boolean2String (($allflags_L ?? 3);"YN")+Char(13)$flags_txt:=$flags_txt+"24 mon set "+f_Boolean2String (($allflags_L ?? 24);"YN")+Char(13)ALERT($flags_txt)$allflags_L:=$allflags_L ?+ 3  `set 12 mo$flags_txt:=""$flags_txt:=$flags_txt+"3 mon set "+f_Boolean2String (($allflags_L ?? 1);"YN")+Char(13)$flags_txt:=$flags_txt+"6 mon set "+f_Boolean2String (($allflags_L ?? 2);"YN")+Char(13)$flags_txt:=$flags_txt+"12 mon set "+f_Boolean2String (($allflags_L ?? 3);"YN")+Char(13)$flags_txt:=$flags_txt+"24 mon set "+f_Boolean2String (($allflags_L ?? 24);"YN")+Char(13)ALERT($flags_txt)$allflags_L:=$allflags_L ?- 2  `clear 6 mo$allflags_L:=$allflags_L ?+ 3  `set 12 mo$flags_txt:=""$flags_txt:=$flags_txt+"3 mon set "+f_Boolean2String (($allflags_L ?? 1);"YN")+Char(13)$flags_txt:=$flags_txt+"6 mon set "+f_Boolean2String (($allflags_L ?? 2);"YN")+Char(13)$flags_txt:=$flags_txt+"12 mon set "+f_Boolean2String (($allflags_L ?? 3);"YN")+Char(13)$flags_txt:=$flags_txt+"24 mon set "+f_Boolean2String (($allflags_L ?? 24);"YN")+Char(13)ALERT($flags_txt)$allflags_L:=$allflags_L ?+ 24  `set 24 mo$flags_txt:=""$flags_txt:=$flags_txt+"3 mon set "+f_Boolean2String (($allflags_L ?? 1);"YN")+Char(13)$flags_txt:=$flags_txt+"6 mon set "+f_Boolean2String (($allflags_L ?? 2);"YN")+Char(13)$flags_txt:=$flags_txt+"12 mon set "+f_Boolean2String (($allflags_L ?? 3);"YN")+Char(13)$flags_txt:=$flags_txt+"24 mon set "+f_Boolean2String (($allflags_L ?? 24);"YN")+Char(13)ALERT($flags_txt)$allflags_L:=$allflags_L ?- 24  `clear 24 mo$flags_txt:=""$flags_txt:=$flags_txt+"3 mon set "+f_Boolean2String (($allflags_L ?? 1);"YN")+Char(13)$flags_txt:=$flags_txt+"6 mon set "+f_Boolean2String (($allflags_L ?? 2);"YN")+Char(13)$flags_txt:=$flags_txt+"12 mon set "+f_Boolean2String (($allflags_L ?? 3);"YN")+Char(13)$flags_txt:=$flags_txt+"24 mon set "+f_Boolean2String (($allflags_L ?? 24);"YN")+Char(13)ALERT($flags_txt)End if 