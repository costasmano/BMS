  `Method: TNL_InspData2Tunnel  `Description  `  ` Handle the copy of data from tunnel inspection report to SIA;  `  `Two steps   `  `  `a) from [Inspections] to SIA ;  `  `  `b) [tunnelinspection] to [tunnelinfo]  ` Parameters  ` ----------------------------------------------------If (False)  ` ----------------------------------------------------  `User name (OS): Costas Manousakis  `User (4D) : Designer  `Date and time: 06/14/13, 13:19:53  ` ----------------------------------------------------  `Created : Mods_2013_06   ` Modified by: Costas Manousakis-(Designer)-(10/2/13 11:20:11)Mods_2013_10   `  `Changed text message in alertsEnd if   `C_TEXT($msg)C_BOOLEAN($one_b;$many_b)GET AUTOMATIC RELATIONS($one_b;$many_b)  `save the state of auto relationsSET AUTOMATIC RELATIONS(False;False)  ` save them to falseQUERY([Inspection Type];[Inspection Type]Code=[Inspections]Insp Type)$msg:="Approving a "+[Inspection Type]Description+" inspection - Step 1 : Saving data to Bridge SI & A for BIN : "$msg:=$msg+[Bridge MHD NBIS]BIN+" BDEPT : "+[Bridge MHD NBIS]BDEPTALERT($msg)G_RoutinetoBMS   `record saved in this methodIf (Not(Is record loaded([Bridge MHD NBIS])))LOAD RECORD([Bridge MHD NBIS])End if $msg:="Approving a "+[Inspection Type]Description+" inspection - Step 2 : Saving data to Tunnel SI & A for BIN : "$msg:=$msg+[Bridge MHD NBIS]BIN+" BDEPT : "+[Bridge MHD NBIS]BDEPTALERT($msg)  `Need the tunnelinfo record and make sure we have the [tunnelinsection] recordIf ([TunnelInspection]InspID#[Inspections]InspID)QUERY([TunnelInspection];[TunnelInspection]InspID=[Inspections]InspID)End if C_BOOLEAN($loadRec_b)QUERY([TunnelInfo];[TunnelInfo]BIN=[Inspections]BIN)If (Records in selection([TunnelInfo])=1)If (ut_LoadRecordInteractive (->[TunnelInfo]))TNL_SIA_Insp ("INSP2SIA")C_BOOLEAN($SaveRec_b)InitChangeStack (1)INSP_CheckTunnelSpcFreq   `check changesPushAllChanges (1;->[TunnelInfo])  `verify changes$SaveRec_b:=INSP_VerifySIAChanges (1)If ($SaveRec_b)[TunnelInfo]ModifiedBy_s:=Current user[TunnelInfo]ModifiedTimeStamp_s:=FN_Date2DateTime (Current date(*);Current time(*))PushChange (1;->[TunnelInfo]ModifiedBy_s)PushChange (1;->[TunnelInfo]ModifiedTimeStamp_s)FlushGrpChgs (1;->[TunnelInfo]BIN;->[TunnelInfo]BIN;->[TunnelInfo]BIN;0)SAVE RECORD([TunnelInfo])End if READ ONLY([TunnelInfo])  ` set this back to ROUNLOAD RECORD([TunnelInfo])Else ALERT("Could not load the corresponding Tunnel Information record!  Please enter data manually!")End if Else ALERT("Corresponding Tunnel Information record NOT Found! The record must be creat")End if SET AUTOMATIC RELATIONS($one_b;$many_b)  `reset state of auto relations  `End TNL_InspData2Tunnel