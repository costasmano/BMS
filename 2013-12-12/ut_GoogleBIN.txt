If (False)  ` ----------------------------------------------------  ` User name (OS): costasmanousakis  ` User name (4D): Designer  ` Date and time: 01/14/09, 19:08:19  ` ----------------------------------------------------  ` Method: ut_GoogleBIN  ` Description  ` Launch a browser with google maps to the latlongs of the current BIN record.  `   ` URL parameters :   `  ` &t=h : Show satelite view  ` Parameters  ` ----------------------------------------------------Mods_2009_CM_5404   ` Modified by: costasmanousakis-(Designer)-(2/25/10 15:31:43)Mods_2010_02   `  `Added code to show facility on/under  ` Modified by: costasmanousakis-(Designer)-(4/7/10 10:07:14)Mods_2010_04   `  `Fix some errors of displaying the fac on /under  ` Modified by: costasmanousakis-(Designer)-(11/12/10 09:05:43)Mods_2010_11   `  `Changed code and url string to use PROCESS HTML Var command;  `  `Added change to replace parens with brackets in Item 6 and 7  ` Modified by: costasmanousakis-(Designer)-(5/5/11 11:44:14)Mods_2011_05   `  `Made adjustments on how to open the URL depending on the application version,  `  `for > 8 (v11 and after ) use OPEN WEB URL (url), for 2004 OPEN WEB URL (url;*)  `  `Also made all 4DVAR variable to process vars. Local vars did not work in v11 compiled.  ` Modified by: Costas Manousakis-(Designer)-(11/8/13 14:48:47)Mods_2013_11   `  `Replace the word "TO" in item 6 and 7 with a "-" : causes google to think we asking for dierctioons  ` Modified by: Costas Manousakis-(Designer)-(12/12/13 14:38:31)Mods_2013_12   `  `replace  apostrophe (quote) and back apostrophe with spaceEnd if C_TEXT($url;$urlout)C_LONGINT(goo_zzvalue;goo_zoomValue)goo_zzvalue:=16goo_zoomValue:=1If ((Shift down) & User in group(◊CurrentUser_Name;"Application Admin"))$url:="http://www.gorissen.info/Pierre/maps/googleMapLocation.php?lat=<!--#4DVAR goo_brg"+"Lat"+"Value-->&lon"+"=<!--#4DVAR goo_brgLongValue-->&setLatLon=Set"Else $url:="http://maps.google.com/maps?f=q&source=s_q&hl=en&geocode=&q=<!--#4DVAR goo_brgLat"+"Val"+"ue-->"$url:=$url+",<!--#4DVAR goo_brgLongValue-->+(<!--#4DVAR goo_sBDEPT-->)&ie=UTF8&z=<!--#4DVAR g"+"oo_zzvalu"+"e-->"$url:=$url+"&iwloc=addr@zoom=<!--#4DVAR goo_zoomValue-->&t=h"End if C_TEXT($Item7_txt;$item6_txt;$ItemPrefix_txt)$Item7_txt:=[Bridge MHD NBIS]Item7$item6_txt:=[Bridge MHD NBIS]Item6A$ItemPrefix_txt:=Substring($Item7_txt;1;5)If (($ItemPrefix_txt="OTHER") | ($ItemPrefix_txt="WATER") | ($ItemPrefix_txt="HWY  "))$Item7_txt:=Substring($Item7_txt;6)End if $ItemPrefix_txt:=Substring($item6_txt;1;5)If (($ItemPrefix_txt="OTHER") | ($ItemPrefix_txt="WATER") | ($ItemPrefix_txt="HWY  "))$item6_txt:=Substring($item6_txt;6)End if $Item7_txt:=Replace string($Item7_txt;"(";"[")$Item7_txt:=Replace string($Item7_txt;")";"]")$item6_txt:=Replace string($item6_txt;"(";"[")$item6_txt:=Replace string($item6_txt;")";"]")$item6_txt:=Replace string($item6_txt;" TO ";" - ")$Item7_txt:=Replace string($Item7_txt;" TO ";" - ")C_REAL(goo_brgLatValue;goo_brgLongValue)goo_brgLatValue:=[Bridge MHD NBIS]Item16A+([Bridge MHD NBIS]Item16B/60)+([Bridge MHD NBIS]Item16C/3600)goo_brgLongValue:=-([Bridge MHD NBIS]Item17A+([Bridge MHD NBIS]Item17B/60)+([Bridge MHD NBIS]Item17C/3600))If ((goo_brgLatValue#0) & (goo_brgLongValue#0))goo_brgLatValue:=Round(goo_brgLatValue;8)goo_brgLongValue:=Round(goo_brgLongValue;8)C_TEXT(goo_sBDEPT;$TLineBdept)goo_sBDEPT:=[Bridge MHD NBIS]BDEPT$TLineBdept:=QR_TLineBrNo_2 If ($TLineBdept#"")goo_sBDEPT:=goo_sBDEPT+"="+$TLineBdeptEnd if goo_sBDEPT:=Replace string(goo_sBDEPT;"=";"-")goo_sBDEPT:=goo_sBDEPT+" ["+[Bridge MHD NBIS]BIN+"]"+" : "+(Replace string(f_TrimStr ($Item7_txt;True;True);"  ";" "))+" / "+(Replace string(f_TrimStr ($item6_txt;True;True);"  ";" "))goo_sBDEPT:=Replace string(goo_sBDEPT;"&";"AND")goo_sBDEPT:=Replace string(goo_sBDEPT;"'";" ")goo_sBDEPT:=Replace string(goo_sBDEPT;"`";" ")  `C_BLOB($in;$out)  `TEXT TO BLOB($url;$in;UTF8 text without length )PROCESS HTML TAGS($url;$urlout)  `$urlout:=BLOB to text($out;UTF8 text without length )  `SET TEXT TO CLIPBOARD($url+Char(13)+goo_sBDEPT+Char(13)+"Lat:"+String(goo_brgLatValue)+Char(13)+"Long:"+String(goo_brgLongValue)+Char(13)+$urlout)C_LONGINT($Version4D_L)$Version4D_L:=Num(Substring(Application version;1;2))If ($Version4D_L>8)OPEN WEB URL($urlout)Else OPEN WEB URL($urlout;*)End if goo_sBDEPT:=""Else   `OPEN WEB URL("http://maps.google.com/maps?f=q&source=s_q&hl=en&geocode=&q="+$Item7_txt+","+[Bridge MHD NBIS]Town Name+", MA {"+[Bridge MHD NBIS]BDEPT+", "+[Bridge MHD NBIS]BIN+", over "+$item6_txt+"}")ALERT("Zero Lat. Long. values for this Bridge Record!")End if 