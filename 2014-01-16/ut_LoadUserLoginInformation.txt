  `----------------------------------------------  ` ut_LoadUserLoginInformation  ` User name (OS): charlesmiller  ` Date and time: 07/12/11, 11:01:04  ` ----------------------------------------------------  ` Description  ` This method will select a file containing  `The following arrays  `ARRAY LONGINT($ExportUserNumbers_al;0)  `ARRAY LONGINT($ExportLoginCount_al;0)  `ARRAY DATE($ExportLastLoginDate_ad;0)  `ARRAY TEXT($ExportUserName_atxt;0)  `Created from method ut_SaveUserInformation  `It will loop through all users and reset login count and date  ` Parameters  ` ----------------------------------------------------If (False)Mods_2011_07   ` CJ Miller`07/12/11, 11:01:07      `  ` Modified by: costasmanousakis-(Designer)-(12/13/11 22:53:19)Mods_2011_12   `  `Fixed declaration of $Membership_aL switch from text array to longint  `  `Add Check for OK after doc select  ` Modified by: Costas Manousakis-(Designer)-(1/20/12 18:07:12)Mods_2012_01   `  `Fixed declaration of $GroupOwner_L switch from text  to longintMods_2012_02   `r001`Exclude Administrator and DesignerMods_2012_02   `r001 `Fix bug and bring up alerts re who was skipped or not found  `Modified by: Charles Miller (2/16/12 14:18:39)Mods_2013_06   `r001 ` Add update progress bar and change code to deal with adjusted user names  `Modified by: Charles Miller (6/13/13 16:27:04)  ` Modified by: Costas Manousakis-(Designer)-(12/30/13 11:06:27)Mods_2013_12   `  `fixed the update progress bar since the loop is  in reverse orderEnd if ARRAY LONGINT($ExportUserNumbers_al;0)ARRAY LONGINT($ExportLoginCount_al;0)ARRAY DATE($ExportLastLoginDate_ad;0)ARRAY TEXT($ExportUserName_atxt;0)C_TEXT($Folder_txt)ARRAY TEXT($Documents_atxt;0)If (Count parameters=1)C_TEXT($1)$Folder_txt:=$1If (Test path name($Folder_txt)=Is a document )Else $Folder_txt:=Select document("";"*";"Select Document to load User Login date and count";0;$Documents_atxt)$Folder_txt:=$Documents_atxt{1}End if Else $Folder_txt:=Select document("";"*";"Select Document to load User Login date and count";0;$Documents_atxt)$Folder_txt:=$Documents_atxt{1}End if If (OK=1)C_BLOB($Blob_blb)SET BLOB SIZE($Blob_blb;0)DOCUMENT TO BLOB($Folder_txt;$Blob_blb)C_LONGINT($Loop_l;$Position_l;$NumberofLogins_l;$UserID_l;$GroupOwner_L)C_DATE($LastLogin_d)$Loop_l:=0BLOB TO VARIABLE($Blob_blb;$ExportUserNumbers_al;$Loop_l)BLOB TO VARIABLE($Blob_blb;$ExportLoginCount_al;$Loop_l)BLOB TO VARIABLE($Blob_blb;$ExportLastLoginDate_ad;$Loop_l)BLOB TO VARIABLE($Blob_blb;$ExportUserName_atxt;$Loop_l)SET BLOB SIZE($Blob_blb;0)ARRAY LONGINT($Membership_aL;0)ARRAY TEXT($UserNames_atxt;0)ARRAY LONGINT($UserNumbers_al;0)C_TEXT($Name_txt;$StartUp_txt;$Password_txt)C_TEXT($Aster_txt)$Aster_txt:="*"C_LONGINT($NumberUpdated_l;$SizeofArray_l)$NumberUpdated_l:=0GET USER LIST($UserNames_atxt;$UserNumbers_al)$Position_l:=Find in array($UserNames_atxt;"Designer")If ($Position_l>0)DELETE FROM ARRAY($UserNames_atxt;$Position_l;1)DELETE FROM ARRAY($UserNumbers_al;$Position_l;1)End if $Position_l:=Find in array($UserNames_atxt;"Administrator")If ($Position_l>0)DELETE FROM ARRAY($UserNames_atxt;$Position_l;1)DELETE FROM ARRAY($UserNumbers_al;$Position_l;1)End if $SizeofArray_l:=Size of array($UserNumbers_al)◊ProgressPID:=StartProgress ("Load Login info";"Button";"Load user log in data")C_LONGINT($Interval_L)$Interval_L:=MaxNum (MinNum (Int($SizeofArray_l/40);20);2)  ` get an update interval between 2 and 20ARRAY TEXT($Unmatched_atxt;0)For ($Loop_l;$SizeofArray_l;1;-1)If ((($SizeofArray_l-$Loop_l)%$Interval_L=0) | ($Loop_l=$SizeofArray_l))  `Don't slow down things just to displayUpdateProgress (($SizeofArray_l-$Loop_l);$SizeofArray_l)End if $Position_l:=Find in array($ExportUserNumbers_al;$UserNumbers_al{$Loop_l})If ($Position_l>0)$NumberUpdated_l:=$NumberUpdated_l+1GET USER PROPERTIES($UserNumbers_al{$Loop_l};$Name_txt;$StartUp_txt;$Password_txt;$NumberofLogins_l;$LastLogin_d;$Membership_aL;$GroupOwner_L)Case of : ($Name_txt#$ExportUserName_atxt{$Position_l})APPEND TO ARRAY($Unmatched_atxt;$ExportUserName_atxt{$Position_l}+" set to "+$Name_txt)$UserID_l:=Set user properties($UserNumbers_al{$Loop_l};$Name_txt;$StartUp_txt;*;$ExportLoginCount_al{$Position_l};$ExportLastLoginDate_ad{$Position_l};$Membership_aL): ($Name_txt="Designer") | ($Name_txt="Administrator")Else $UserID_l:=Set user properties($UserNumbers_al{$Loop_l};$ExportUserName_atxt{$Position_l};$StartUp_txt;*;$ExportLoginCount_al{$Position_l};$ExportLastLoginDate_ad{$Position_l};$Membership_aL)End case DELETE FROM ARRAY($ExportUserName_atxt;$Position_l;1)DELETE FROM ARRAY($ExportLoginCount_al;$Position_l;1)DELETE FROM ARRAY($ExportLastLoginDate_ad;$Position_l;1)DELETE FROM ARRAY($ExportUserNumbers_al;$Position_l;1)DELETE FROM ARRAY($UserNumbers_al;$Loop_l;1)DELETE FROM ARRAY($UserNames_atxt;$Loop_l;1)End if End for CALL PROCESS(◊ProgressPID)If (Size of array($ExportUserName_atxt)>0)ARRAY TEXT(LBGeneric_atxt;0)COPY ARRAY($ExportUserName_atxt;LBGeneric_atxt)C_LONGINT($Width_l;$Height_l)GET FORM PROPERTIES("OneArrayLB";$Width_l;$Height_l)ut_OpenNewWindow ($Width_l;$Height_l;0;Plain window ;"Old Users Not Updated";"ut_CloseCancel")1_TXT:="Not Updated"DIALOG("OneArrayLB")If (False)C_TEXT($Message_txt)$Message_txt:=$ExportUserName_atxt{1}For ($Loop_l;2;Size of array($ExportUserName_atxt))$Message_txt:=$Message_txt+", "+$ExportUserName_atxt{$Loop_l}End for ALERT("The following "+String(Size of array($ExportUserName_atxt))+" old users not updated as they were not found on the receiving db."+Char(Carriage return )+$Message_txt)End if End if If (Size of array($Unmatched_atxt)>0)ARRAY TEXT(LBGeneric_atxt;0)COPY ARRAY($Unmatched_atxt;LBGeneric_atxt)C_LONGINT($Width_l;$Height_l)GET FORM PROPERTIES("OneArrayLB";$Width_l;$Height_l)ut_OpenNewWindow ($Width_l;$Height_l;0;Plain window ;"Mismatched Users";"ut_CloseCancel")1_TXT:="Names reset"DIALOG("OneArrayLB")End if If (Size of array($UserNames_atxt)>0)ARRAY TEXT(LBGeneric_atxt;0)COPY ARRAY($UserNames_atxt;LBGeneric_atxt)C_LONGINT($Width_l;$Height_l)GET FORM PROPERTIES("OneArrayLB";$Width_l;$Height_l)ut_OpenNewWindow ($Width_l;$Height_l;0;Plain window ;"New Users Added";"ut_CloseCancel")1_TXT:="New Users"DIALOG("OneArrayLB")If (False)C_TEXT($Message_txt)$Message_txt:=$UserNames_atxt{1}For ($Loop_l;2;Size of array($UserNames_atxt))$Message_txt:=$Message_txt+", "+$UserNames_atxt{$Loop_l}End for ALERT("The following "+String($SizeofArray_l-$NumberUpdated_l)+" new users not updated!!!"+Char(Carriage return )+$Message_txt)End if End if If ((Size of array($ExportUserName_atxt)=0) & (Size of array($UserNames_atxt)=0))ALERT("all users updated")End if End if ARRAY LONGINT($ExportUserNumbers_al;0)ARRAY LONGINT($ExportLoginCount_al;0)ARRAY DATE($ExportLastLoginDate_ad;0)ARRAY TEXT($ExportUserName_atxt;0)ARRAY LONGINT($UserNumbers_al;0)  `End ut_LoadUserLoginInformation