If (False)ÊÊ`LO: [RatingMember];"RatMemberIn"ÊÊ` Modified by: Costas Manousakis-(Designer)-(1/16/14 16:56:03)Mods_2014_01 ÊÊ`ÊÊ`modified form to add display of Bin, bdept, rating date, consultant; increased HT of descr; added vert scroll barsÊÊ`ÊÊ`on the on validate event clean out the text in the descr  to avoid multiple extra linesEnd if Case of : (Form event=On Load )InitChangeStack (3)If ([RatingMember]RatingID=0)ÊÊ`If this is a new record[RatingMember]RatingID:=[RatingReports]RatingIDSAVE RECORD([RatingMember])End if : (Form event=On Validate )C_LONGINT($pos_L;$DescLen_L)$DescLen_L:=Length([RatingMember]Description)C_TEXT($CleanDesc_txt;$orig_txt)$orig_txt:=[RatingMember]Description$CleanDesc_txt:=""ÊÊ`[RatingMember]DescriptionFor ($pos_L;1;($DescLen_L-1))If ($orig_txt²$pos_L³=Char(Carriage return ))If ($orig_txt²$pos_L+1³=Char(Carriage return ))Else $CleanDesc_txt:=$CleanDesc_txt+$orig_txt²$pos_L³End if Else $CleanDesc_txt:=$CleanDesc_txt+$orig_txt²$pos_L³End if End for $CleanDesc_txt:=$CleanDesc_txt+$orig_txt²$DescLen_L³[RatingMember]Description:=f_TrimStr ($CleanDesc_txt;True;True)ÊÊ` FlushChanges (3;->[RatingReports]RatingID;->[RatingMember]RatingID;ÊÊ`->Ê¥[RatingMember]MemberID¥Ê;2)End case 