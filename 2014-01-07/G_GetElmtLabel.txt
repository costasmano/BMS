ÊÊ`G_GetElmtLabelÊÊ` $0 : Element label used as a header in the comments, and in the list of special member elements pages 1-2ÊÊ` $1 : $GetParentHeader_b (optional)If (False)ÊÊ` Modified by: costasmanousakis-(Designer)-(1/11/2007 12:35:50)Mods_2007_CM04 ÊÊ` Modified by: costasmanousakis-(Designer)-(12/20/07 12:04:28)Mods_2007_CM_5401 ÊÊ`ÊÊ`Use the ×ELMTDICT_@ arrays instead of the table and pushing poping records for parent.ÊÊ` Modified by: costasmanousakis-(Designer)-(3/10/09 14:07:37)Mods_2009_03 ÊÊ`Use the element arrays generated by INSP_ElmtDescUtil to get the parent description.ÊÊ` Modified by: Costas Manousakis-(Designer)-(12/12/12 08:26:25)Mods_2012_12 ÊÊ`ÊÊ`Use arrays ×ALLElmtCatCode_as, ×ALLElmtCatDesc_as instead of querying [Element Cat]ÊÊ` Modified by: Costas Manousakis-(Designer)-(5/2/13 15:23:27)Mods_2013_05 ÊÊ`ÊÊ`Added special for Tunnel items 62a-gMods_2013_05 ÊÊ`r003 ` Make 62 b Roadway instead of structuralÊÊ`Modified by: Charles Miller (5/21/13 13:15:57)ÊÊ` Modified by: Costas Manousakis-(Designer)-(12/9/13 16:53:03)Mods_2013_12 ÊÊ`ÊÊ`For Tunnel categories remove the descr of the category from the title ; left only 62a,b,c, etc.ÊÊ`ÊÊ`Also add a "." between the itemtitle and the element titleEnd if C_BOOLEAN($1;$GetParentHeader_b)C_STRING(132;$vElmTitle;$vItmtitle;$vParentTitle;$0)C_INTEGER($vLen)C_LONGINT(INSP_PrevElmtParntID)If (Count parameters=1)$GetParentHeader_b:=$1Else $GetParentHeader_b:=FalseEnd if C_LONGINT($ElmIndx_L;$ElmParIndx_L;$catIndx_L)$ElmIndx_L:=Find in array(×ELMTDICT_ELNum_ai;[ElementsSafety]ElementNo)Case of : (Substring(×ELMTDICT_Cat_as{$ElmIndx_L};1;1)="N")$vItmtitle:="Item "+Substring(×ELMTDICT_Cat_as{$ElmIndx_L};2): (×ELMTDICT_Cat_as{$ElmIndx_L}="TRA")$vItmtitle:="Item 36": (×ELMTDICT_Cat_as{$ElmIndx_L}="STR")$vItmtitle:="62a": (×ELMTDICT_Cat_as{$ElmIndx_L}="ROA")$vItmtitle:="62b": (×ELMTDICT_Cat_as{$ElmIndx_L}="CEI")$vItmtitle:="62c": (×ELMTDICT_Cat_as{$ElmIndx_L}="SUP")$vItmtitle:="62d": (×ELMTDICT_Cat_as{$ElmIndx_L}="CRO")$vItmtitle:="62e": (×ELMTDICT_Cat_as{$ElmIndx_L}="EGR")$vItmtitle:="62f": (×ELMTDICT_Cat_as{$ElmIndx_L}="UTI")$vItmtitle:="62g"Else $catIndx_L:=Find in array(×ALLElmtCatCode_as;×ELMTDICT_Cat_as{$ElmIndx_L})If ($catIndx_L>0)$vItmtitle:=×ALLElmtCatDesc_as{$catIndx_L}Else $vItmtitle:=×ELMTDICT_Cat_as{$ElmIndx_L}End if End case ÊÊ`Add Description of parent item if any      If (×ELMTDICT_Parent_ai{$ElmIndx_L}>0)$ElmParIndx_L:=Find in array(×ELMTDICT_ELNum_ai;×ELMTDICT_Parent_ai{$ElmIndx_L})$vElmTitle:=×ELMTDICT_Prefix_as{$ElmParIndx_L}ÊÊ`do this only if the arrays have been defined and are non-zeroC_LONGINT($varType;$ElmParActIndx_L)$varType:=Type(INSPPR_ElmNo_ai)$ElmParActIndx_L:=-1If ($varType=Integer array )If (Size of array(INSPPR_ElmNo_ai)>0)$ElmParActIndx_L:=Find in array(INSPPR_ElmNo_ai;×ELMTDICT_Parent_ai{$ElmIndx_L})End if End if If ($ElmParActIndx_L>0)$vParentTitle:=INSPPR_ElmDesc_atxt{$ElmParActIndx_L}Else $vParentTitle:=×ELMTDICT_Txt_as{$ElmParIndx_L}End if If ((f_Insp_Revision3 ([Inspections]Insp Date))Ê&Ê$GetParentHeader_b)If (×ELMTDICT_Parent_ai{$ElmIndx_L}#INSP_PrevElmtParntID)$vElmtitle:=Replace string($vElmtitle;" ";"")$vLen:=Length($vElmTitle)If (Substring($vElmTitle;$vLen;1)=".")$vElmTitle:=Substring($vElmTitle;1;($vLen-1))End if $vItmtitle:=$vItmtitle+"."+$vElmtitle+" - "+$vParentTitle+Char(13)+$vItmtitleEnd if End if INSP_PrevElmtParntID:=×ELMTDICT_Parent_ai{$ElmIndx_L}Else INSP_PrevElmtParntID:=0End if If (×ELMTDICT_IsPar_ab{$ElmIndx_L})INSP_PrevElmtParntID:=×ELMTDICT_ELNum_ai{$ElmIndx_L}End if $vElmTitle:=GetElmtNumber $vElmTitle:=Replace string($vElmtitle;" ";"")$vLen:=Length($vElmTitle)If (Substring($vElmTitle;$vLen;1)=".")$vElmTitle:=Substring($vElmTitle;1;($vLen-1))End if $vElmTitle:=$vElmTitle+" - "+[ElementsSafety]DescriptionCase of : (Substring(×ELMTDICT_Cat_as{$ElmIndx_L};1;1)="N")$0:=$vItmTitle+"."+$vElmTitle: (×ELMTDICT_Cat_as{$ElmIndx_L}="TRA")$0:=$vItmTitle+$vElmTitle: (Position(×ELMTDICT_Cat_as{$ElmIndx_L};";STR;ROA;CEI;SUP;CRO;EGR;UTI;")>0)$0:=$vItmTitle+"."+$vElmTitleElse $0:=$vItmTitle+" "+$vElmTitleEnd case 