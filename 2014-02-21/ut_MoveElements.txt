  `----------------------------------------------------  `User name (OS): Charles Miller  `Date and time: 03/28/11, 13:56:21  `----------------------------------------------------  `Method: ut_MoveElements  `Description  `  ` Parameters  ` ----------------------------------------------------If (False)  `Ugrade to v11  `Modified by: Charles Miller (3/28/11 13:56:22)Mods_2013_07   `r001 ` Add ability for custom where clause on clone  `Modified by: Charles Miller (7/8/13 16:36:36)  ` Modified by: Costas Manousakis-(Designer)-(2/21/14 10:01:23)Mods_2014_02   `  `Added the automatic setting of the RemoteType_al End if C_TEXT($Direction_txt;$1;$Variable_txt)$Direction_txt:=$1C_LONGINT($FromPosition_l;$InnerLoop_l;$Loop_l;$Column_l;$Row_l;$TableNumber_l;$UniqueFldNumber_l)SET VISIBLE(*;"AllowForCustomWhere@";False)Case of : ($Direction_txt=">")GET LISTBOX CELL POSITION(LocalListBox_l;$Column_l;$Row_l)SELECT LISTBOX ROW(LocalListBox_l;$Row_l)If (RemoteCount_al{$Row_l}>0)INSERT LISTBOX ROW(ProcessListBox_l;1)$TableNumber_l:=FromArray_ptr{4}->{$Row_l}ut_ReturnKeyFldandVariable ($TableNumber_l;->$UniqueFldNumber_l;->$Variable_txt;False)If ($UniqueFldNumber_l>0)RemoteKeyName_atxt{1}:=Field name($TableNumber_l;$UniqueFldNumber_l)RemoteType_al{1}:=Type(Field($TableNumber_l;$UniqueFldNumber_l)->)End if For ($InnerLoop_l;1;Size of array(FromArray_ptr))ToArray_ptr{$InnerLoop_l}->{1}:=FromArray_ptr{$InnerLoop_l}->{$Row_l}End for DELETE LISTBOX ROW(LocalListBox_l;$Row_l)SORT LISTBOX COLUMNS(ProcessListBox_l;23;>)End if : ($Direction_txt=">>")For ($Loop_l;Size of array(FromArray_ptr{1}->);1;-1)SELECT LISTBOX ROW(LocalListBox_l;$Loop_l)If (RemoteCount_al{$Row_l}>0)INSERT LISTBOX ROW(ProcessListBox_l;1)$TableNumber_l:=FromArray_ptr{4}->{$Row_l}ut_ReturnKeyFldandVariable ($TableNumber_l;->$UniqueFldNumber_l;->$Variable_txt;False)If ($UniqueFldNumber_l>0)RemoteKeyName_atxt{1}:=Field name($TableNumber_l;$UniqueFldNumber_l)RemoteType_al{1}:=Type(Field($TableNumber_l;$UniqueFldNumber_l)->)End if For ($InnerLoop_l;1;Size of array(FromArray_ptr))ToArray_ptr{$InnerLoop_l}->{1}:=FromArray_ptr{$InnerLoop_l}->{$Loop_l}End for DELETE LISTBOX ROW(LocalListBox_l;$Loop_l)End if End for SORT LISTBOX COLUMNS(ProcessListBox_l;3;>): ($Direction_txt="<")GET LISTBOX CELL POSITION(ProcessListBox_l;$Column_l;$Row_l)SELECT LISTBOX ROW(ProcessListBox_l;$Row_l)INSERT LISTBOX ROW(LocalListBox_l;1)For ($InnerLoop_l;1;Size of array(FromArray_ptr))FromArray_ptr{$InnerLoop_l}->{1}:=ToArray_ptr{$InnerLoop_l}->{$Row_l}End for DELETE LISTBOX ROW(ProcessListBox_l;$Row_l)SORT LISTBOX COLUMNS(LocalListBox_l;3;>): ($Direction_txt="<<")For ($Loop_l;Size of array(ToArray_ptr{1}->);1;-1)SELECT LISTBOX ROW(ProcessListBox_l;$Loop_l)INSERT LISTBOX ROW(LocalListBox_l;1)For ($InnerLoop_l;1;Size of array(FromArray_ptr))FromArray_ptr{$InnerLoop_l}->{1}:=ToArray_ptr{$InnerLoop_l}->{$Loop_l}End for DELETE LISTBOX ROW(ProcessListBox_l;$Loop_l)End for SORT LISTBOX COLUMNS(LocalListBox_l;3;>)End case   `End ut_MoveElements