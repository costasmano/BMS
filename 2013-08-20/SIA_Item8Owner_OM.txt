  ` Method: SIA_Item8Owner_OM  ` Description  ` New method to be called from two forms  `  `Pop up menu for Item8 OwnerCode  `   ` ParametersIf (False)  ` ----------------------------------------------------  ` User name (OS): costasmanousakis  ` User name (4D): Designer  ` Date and time: 12/22/09, 08:57:15  ` ----------------------------------------------------Mods_2009_12   ` Modified by: costasmanousakis-(Designer)-(1/8/10 11:44:04)Mods_2010_01   `  `Added code to adjust Legacy Owner field also.  ` Modified by: Costas Manousakis-(Designer)-(8/19/13 17:16:42)Mods_2013_08   `  `use element 0 to display the  "Select...." promptEnd if C_STRING(50;vIt8OwnerDes)REDRAW(aIt8OwnerDes_)Case of : ((Form event=On Load ) | (aIt8OwnerDes_=0))aIt8OwnerDes_:=Find in array(aIt8OwnerCode_;Substring([Bridge MHD NBIS]Item8;10;3))If (aIt8OwnerDes_<=0)  `Just in case nothing was found in arrayaIt8OwnerDes_:=0aIt8OwnerDes_{0}:="Select Bridge Owner..."vIt8OwnerDes:="Select Bridge Owner..."Else vIt8OwnerDes:=aIt8OwnerDes_{aIt8OwnerDes_}End if : (Form event=On Clicked )If ((aIt8OwnerCode_{aIt8OwnerDes_}="MHD") | (aIt8OwnerCode_{aIt8OwnerDes_}="MTA") | (aIt8OwnerCode_{aIt8OwnerDes_}="MHS"))ALERT("Due to the MassDOT transition cannot Assign "+aIt8OwnerCode_{aIt8OwnerDes_}+" as an Owner any more!")aIt8OwnerDes_:=Find in array(aIt8OwnerCode_;Substring([Bridge MHD NBIS]Item8;10;3))If (aIt8OwnerDes_<=0)  `Just in case nothing was found in arrayaIt8OwnerDes_:=0vIt8OwnerDes:="Select Bridge Owner..."aIt8OwnerDes_{0}:="Select Bridge Owner..."Else vIt8OwnerDes:=aIt8OwnerDes_{aIt8OwnerDes_}End if Else [Bridge MHD NBIS]Item8:=Change string([Bridge MHD NBIS]Item8;aIt8OwnerCode_{aIt8OwnerDes_};10)[Bridge MHD NBIS]Item8:=Change string([Bridge MHD NBIS]Item8;[Bridge MHD NBIS]BDEPT;1)[Bridge MHD NBIS]Item8:=Change string([Bridge MHD NBIS]Item8;[Bridge MHD NBIS]BIN;7)PushChange (1;->[Bridge MHD NBIS]Item8)C_TEXT($msg_txt)If ((aIt8OwnerCode_{aIt8OwnerDes_}="DOT") & ([Bridge MHD NBIS]Item8 Owner#"DOT"))$msg_txt:="You are changing Owner from "+[Bridge MHD NBIS]Item8 Owner+" to  DOT.  Do you also want to "If ([Bridge MHD NBIS]LegacyOwner="")$msg_txt:=$msg_txt+"set the Legacy Owner to "+[Bridge MHD NBIS]Item8 Owner+"?"Else $msg_txt:=$msg_txt+"change the Legacy Owner from "+[Bridge MHD NBIS]LegacyOwner+" to "+[Bridge MHD NBIS]Item8 Owner+"?"End if CONFIRM($msg_txt)If (OK=1)[Bridge MHD NBIS]LegacyOwner:=[Bridge MHD NBIS]Item8 OwnerPushChange (1;->[Bridge MHD NBIS]LegacyOwner)End if Else If ([Bridge MHD NBIS]LegacyOwner#"")$msg_txt:="You are changing Owner from "+[Bridge MHD NBIS]Item8 Owner+" to "+aIt8OwnerCode_{aIt8OwnerDes_}+".  Do you also want to "$msg_txt:=$msg_txt+"clear the Legacy Owner from "+[Bridge MHD NBIS]LegacyOwner+"?"CONFIRM($msg_txt)If (OK=1)[Bridge MHD NBIS]LegacyOwner:=""PushChange (1;->[Bridge MHD NBIS]LegacyOwner)End if End if End if [Bridge MHD NBIS]Item8 Owner:=aIt8OwnerCode_{aIt8OwnerDes_}PushChange (1;->[Bridge MHD NBIS]Item8 Owner)vIt8OwnerDes:=aIt8OwnerDes_{aIt8OwnerDes_}End if End case 