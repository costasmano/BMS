ÊÊ`----------------------------------------------------ÊÊ`User name (OS): Charles MillerÊÊ`Date and time: 12/29/11, 14:03:33ÊÊ`----------------------------------------------------ÊÊ`Method: LB_SetColumnWidthsÊÊ`DescriptionÊÊ`ÊÊ` ParametersÊÊ` ----------------------------------------------------If (False)Mods_2011_12 ÊÊ`r004ÊÊ`Modified by: Charles Miller (12/29/11 14:03:34)ÊÊ` Modified by: Costas Manousakis-(Designer)-(2/5/13 16:34:00)Mods_2013_10 ÊÊ`ÊÊ`Fix bug when $TotalWidth_l>($scrWdth_l-150)End if ARRAY TEXT($Widths_atxt;0)C_BOOLEAN($DisplayHorizontalScrollBar_b)$DisplayHorizontalScrollBar_b:=Falseut_TextToArray (ColumnWidths_txt;->$Widths_atxt;",")C_LONGINT($Loop_l;$TotalWidth_l;$WindowLeft_l;$OBJLeft_l;$Top_l;$OBJRight_l;$Bottom_l;$CurrentWidth_l;$NewWidth_l;$WindowRight_l;$Left_l;$scrWdth_l)$TotalWidth_l:=0For ($Loop_l;1;Size of array(arrColNames))SET LISTBOX COLUMN WIDTH(*;arrColNames{$Loop_l};Num($Widths_atxt{$Loop_l}))$TotalWidth_l:=$TotalWidth_l+Num($Widths_atxt{$Loop_l})End for $TotalWidth_l:=$TotalWidth_l+20$scrWdth_l:=Screen widthGET OBJECT RECT(*;"SelectListBox";$OBJLeft_l;$Top_l;$OBJRight_l;$Bottom_l)$CurrentWidth_l:=$OBJRight_l-$OBJLeft_lCase of : ($TotalWidth_l>($scrWdth_l-150))$NewWidth_l:=$scrWdth_l-150$NewWidth_l:=$NewWidth_l-$CurrentWidth_l: ($CurrentWidth_l>$TotalWidth_l)$NewWidth_l:=($CurrentWidth_l-$TotalWidth_l)*-1: ($CurrentWidth_l<$TotalWidth_l)$NewWidth_l:=$TotalWidth_l-$CurrentWidth_lElse $NewWidth_l:=0End case MOVE OBJECT(*;"SelectListBox";0;0;$NewWidth_l;0)GET OBJECT RECT(*;"SelectListBox";$OBJLeft_l;$Top_l;$OBJRight_l;$Bottom_l)GET WINDOW RECT($WindowLeft_l;$Top_l;$WindowRight_l;$Bottom_l)If (False)If ($OBJRight_l>($WindowRight_l-$Left_l))$CurrentWidth_l:=$OBJRight_l+20If ($CurrentWidth_l>$scrWdth_l)$CurrentWidth_l:=$scrWdth_l-100End if Else $CurrentWidth_l:=$OBJRight_l+20If ($CurrentWidth_l<800)$CurrentWidth_l:=800End if End if End if $CurrentWidth_l:=$OBJRight_l+20+($OBJLeft_l-$WindowLeft_l)If ($CurrentWidth_l>$scrWdth_l)$CurrentWidth_l:=$scrWdth_l-100$DisplayHorizontalScrollBar_b:=TrueEnd if If ($CurrentWidth_l<800)$CurrentWidth_l:=800$DisplayHorizontalScrollBar_b:=TrueEnd if SET SCROLLBAR VISIBLE(*;"SelectListBox";$DisplayHorizontalScrollBar_b;True)ut_ResizeWindow (Frontmost window;$CurrentWidth_l;$Bottom_l-$Top_l)ÊÊ`End LB_SetColumnWidths