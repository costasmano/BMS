If (False)  `fUpforInsp ($Year; $Month; $m; $leeway; $t; $Waive)  `Copyright © 1995-1996,  Albert S. Leung, All Rights Reserved.  `Determine if a bridge is due or out of frequency  `$Year - 1900..3000 year in question  `$Month - 1..12 month in question.  Month=0 takes only the year.  `$m - negative is out of frequency, 0 is what is due now.  `$leeway - positive for Out of frequency, 0 for Now.  `$t - The type of inspection:  `1=Routine  `2=Fracture Critical  `3=Other special  `4=Critical Member Inspection  `5=Closed Bridge Inspection  `6=Underwater Inspection  `7=code for Combined Inspection except for Underwater  `8=Underwater Routine  `9=Underwater Special member  `$Waive - If true consider the [Bridge MHD NBIS]InspWaiver  ` Modified by: costasmanousakis-(Designer)-(4/5/2006 16:55:29)Mods_2006_CM04   ` Modified by: costasmanousakis-(Designer)-(11/27/07 14:57:36)Mods_2007_CM_5401   ` Modified by: costasmanousakis-(Designer)-(12/30/09 13:47:14)Mods_2009_12   `Added Options $t  ` 8 = Regular UW inspection  ` 9 = UW Special Member inspection  ` Modified by: Costas Manousakis-(Designer)-(12/7/12 14:24:16)Mods_2012_12   `  `For Routine Inspection if FHWA record set freq to 24, else use Item91  ` Modified by: Costas Manousakis-(Designer)-(1/28/13 16:48:01)Mods_2013_01   `  `For UW Special member, if the UW spec memb date = !00/00/00! (ie has not had a UW Spec memb insp yet),   `  `use UW Routine Item93B  ` Modified by: Costas Manousakis-(Designer)-(9/11/13 11:34:31)Mods_2013_09   `  `added handling of Tunnel inspectionsEnd if C_INTEGER($Year;$1)C_INTEGER($Month;$2)C_INTEGER($m;$3)C_INTEGER($leeway;$4)C_BOOLEAN($Waive;$6)C_BOOLEAN($test;$0)C_INTEGER($t)C_DATE($insp)C_INTEGER($freq)C_BOOLEAN($exctrl)C_INTEGER($Iyear;$Imonth;$w)C_LONGINT($Due;$Today0;$Today1;$Today)C_INTEGER($vlUWyrR;$vlUWmoR;$vlUWyrS;$vlUWmoS;$vlUWStR;$vlUWStS;$vlUWEndR;$vlUWEndS)  `Store parameters$Year:=$1$Month:=$2$m:=$3$leeway:=$4$t:=$5$Waive:=$6$test:=False$freq:=0  `Waive the inspection?$exctrl:=((Not($Waive)) | ((Not([Bridge MHD NBIS]InspWaiver)) & $Waive))If ($t>20)  `Tunnel inspections - load the tunnel info recordQUERY([TunnelInfo];[TunnelInfo]BIN=[Bridge MHD NBIS]BIN)End if If ($exctrl)Case of : (($t=1) | ($t=21))  `Routine or All Items Tunnel$insp:=[Bridge MHD NBIS]Item90If ($insp=!00/00/00!)  `No previous routine inspection - use year built.$insp:=Date("1/1/"+String([Bridge MHD NBIS]Item27))End if If ([Bridge MHD NBIS]FHWARecord)$freq:=24Else $freq:=[Bridge MHD NBIS]Item91End if $exctrl:=True: ($t=2)  `Fracture$insp:=[Bridge MHD NBIS]Item93A$freq:=[Bridge MHD NBIS]Item92AB$exctrl:=[Bridge MHD NBIS]Item92AA: ($t=3)  `Critical Member Inspection$insp:=[Bridge MHD NBIS]Item93C$freq:=[Bridge MHD NBIS]Item92CB$exctrl:=[Bridge MHD NBIS]Item92CA: ($t=4)  `Other special$insp:=[Bridge MHD NBIS]OtherIDate$freq:=[Bridge MHD NBIS]OtherIFreq$exctrl:=[Bridge MHD NBIS]OtherInsp: ($t=5)  `Closed Bridge Inspection    $insp:=[Bridge MHD NBIS]ClosedIDate$freq:=[Bridge MHD NBIS]ClosedIFreq$exctrl:=[Bridge MHD NBIS]ClosedInsp: ($t=6)  `Underwater$insp:=[Bridge MHD NBIS]Item93B$freq:=[Bridge MHD NBIS]Item92BB$exctrl:=([Bridge MHD NBIS]Item92BA | [Bridge MHD NBIS]UWSpInsp)If ([Bridge MHD NBIS]UWSpInsp)  `All this code needed only if there a UW SpInsp is requiredIf ([Bridge MHD NBIS]UWSpInspDate>$insp)$insp:=[Bridge MHD NBIS]UWSpInspDateEnd if   `need to calculate the proper UW freq$vlUWyrR:=Year of([Bridge MHD NBIS]Item93B)$vlUWmoR:=Month of([Bridge MHD NBIS]Item93B)If ([Bridge MHD NBIS]UWSpInspDate>[Bridge MHD NBIS]Item93B)$vlUWyrS:=Year of([Bridge MHD NBIS]UWSpInspDate)$vlUWmoS:=Month of([Bridge MHD NBIS]UWSpInspDate)Else $vlUWyrS:=Year of([Bridge MHD NBIS]Item93B)$vlUWmoS:=Month of([Bridge MHD NBIS]Item93B)End if $vlUWStR:=($vlUWyrR*12)+$vlUWmoR$vlUWStS:=($vlUWyrS*12)+$vlUWmoS$vlUWEndR:=$vlUWStR+$freq$vlUWEndS:=$vlUWStS+[Bridge MHD NBIS]UWSpInspFreq$vlUWStR:=(((Year of($insp))*12)+Month of($insp))If ($vlUWEndS>$vlUWStR)$freq:=MinNum (($vlUWEndR-$vlUWStR);($vlUWEndS-$vlUWStR))End if End if : ($t=8)  `Routine Underwater 93B$insp:=[Bridge MHD NBIS]Item93B$freq:=[Bridge MHD NBIS]Item92BB$exctrl:=[Bridge MHD NBIS]Item92BA: ($t=9)  `Special Underwater$insp:=[Bridge MHD NBIS]UWSpInspDateIf ($insp=!00/00/00!)$insp:=[Bridge MHD NBIS]Item93BEnd if $freq:=[Bridge MHD NBIS]UWSpInspFreq$exctrl:=[Bridge MHD NBIS]UWSpInsp: ($t=22)  `Tunnel Overhead Items$insp:=[TunnelInfo]OverHeadInspDate_d$freq:=[TunnelInfo]OverHeadInspFreq_i$exctrl:=($freq>0)If ($insp=!00/00/00!)  `if there is nothing here assume that the overhead was coded in 93C, 92C$insp:=[Bridge MHD NBIS]Item93C$freq:=[Bridge MHD NBIS]Item92CB$exctrl:=($freq>0)End if : ($t=23)  `Tunnel Special1$insp:=[TunnelInfo]SpecialInsp1Date_d$freq:=[TunnelInfo]SpecialInsp1Freq_i$exctrl:=($freq>0): ($t=24)  `Tunnel Special 2$insp:=[TunnelInfo]SpecialInsp2Date_d$freq:=[TunnelInfo]SpecialInsp2Freq_i$exctrl:=($freq>0): ($t=25)  `Tunnel Special 3$insp:=[TunnelInfo]SpecialInsp3Date_d$freq:=[TunnelInfo]SpecialInsp3Freq_i$exctrl:=($freq>0): ($t=26)  `Tunnel Other$insp:=[Bridge MHD NBIS]OtherIDate$freq:=[Bridge MHD NBIS]OtherIFreq$exctrl:=($freq>0): ($t=27)  `Tunnel Closed$insp:=[Bridge MHD NBIS]ClosedIDate$freq:=[Bridge MHD NBIS]ClosedIFreq$exctrl:=($freq>0)End case If ($exctrl)  `If this is a brand new inspection other than a routine inspection start from the  `last routine inspection date    If ($insp=!00/00/00!)$insp:=[Bridge MHD NBIS]Item90End if $Iyear:=Year of($insp)$Imonth:=Month of($insp)$exctrl:=(($Iyear>0) & ($Imonth>0) & ($freq>0))  `Cannot allow 0's here!If ($exctrl)Case of : ($m<0)  `out of frequency$w:=-$leeway: ($m=0)  `due now$w:=0End case If ($Month#0)  `Due on exact month and year$Due:=($Iyear*12)+$Imonth+$freq$Today:=($Year*12)+$Month+$wElse   `Due in given year$Due:=($Iyear*12)+$Imonth+$freq$Today0:=($Year*12)+1$Today1:=($Year+1)*12End if Case of : ($m<0)  `Is it out of frequency?If ($Due<=$Today)$test:=TrueEnd if : ($m=0)  `Is it due Now?If ($Due=$Today)$test:=TrueEnd if End case $exctrl:=(($m=0) & (Not($test)))  `process only if not Out of frequency caseIf ($exctrl)  `Have to cycle through inspection dates and look into the futureIf ($Month=0)  `Inspection falling in a given yearWhile ($Due<=$Today1)  `Look into the futureIf ($Due>=$Today0)$test:=TrueEnd if $Due:=$Due+$freqEnd while If (Not($test))While ($Due>=$Today0)If ($Due<=$Today1)$test:=TrueEnd if $Due:=$Due-$freqEnd while End if Else   `Look into the future for a specific date the inspection falls onWhile ($Due<=$Today)If ($Due=$Today)$test:=TrueEnd if $Due:=$Due+$freqEnd while If (Not($test))  `Look into the past for a specific date the inspection falls onWhile ($Due>=$Today)If ($Due=$Today)$test:=TrueEnd if $Due:=$Due-$freqEnd while End if End if End if End if End if End if $0:=$test  `Return true or false