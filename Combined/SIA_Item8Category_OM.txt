  ` Method: SIA_Item8Category_OM  ` Description  ` Created to be called from two forms  `   ` Parameters  ` ----------------------------------------------------If (False)  ` ----------------------------------------------------  ` User name (OS): costasmanousakis  ` User name (4D): Designer  ` Date and time: 12/22/09, 09:00:47  ` ----------------------------------------------------Mods_2009_12   ` Modified by: Costas Manousakis-(Designer)-(8/19/13 17:16:42)Mods_2013_08   `  `use element 0 to display the  "Select...." promptEnd if C_STRING(60;vIt8BrCatDes)REDRAW(aIt8BrCatDes_)Case of : ((Form event=On Load ) | (aIt8BrCatDes_=0))aIt8BrCatDes_:=Find in array(aIt8BrCatCode_;Substring([Bridge MHD NBIS]Item8;13;3))If (aIt8BrCatDes_<=0)  `Just in case nothing was found in arrayaIt8BrCatDes_:=0vIt8BrCatDes:="Select Bridge Category..."aIt8BrCatDes_{0}:="Select Bridge Category..."Else vIt8BrCatDes:=aIt8BrCatDes_{aIt8BrCatDes_}End if : (Form event=On Clicked )C_STRING(3;$vsNewCode)C_BOOLEAN($vbChangeItem8;$vbChangeFHWA;$vbChangeFHWA_to)$vsNewCode:=aIt8BrCatCode_{aIt8BrCatDes_}$vbChangeItem8:=True$vbChangeFHWA:=FalseC_TEXT($msg)C_STRING(15;$vsCont;$vsChgFHWA)C_INTEGER($viPromptRes)$vsCont:="Continue"Case of : (($vsNewCode="NBI") | ($vsNewCode="634"))  `switcing to NBI type If (Not([Bridge MHD NBIS]FHWARecord))$msg:="Switching Bridge Category Code to an NBI Category Type"$msg:=$msg+◊sCR+"while Bridge Record is not on NBI List!!"$msg:=$msg+◊sCR+◊sCR+"Continue only with the Item8 Change, or"$msg:=$msg+◊sCR+"Put Bridge Record on the NBI List also?"  `$msg:=Uppercase($msg)$vsChgFHWA:="Put on NBI"$viPromptRes:=ut_3Option_Confirm ($msg;$vsCont;$vsChgFHWA)$vbChangeItem8:=($viPromptRes#3)  `cancel is 3If ($viPromptRes=2)$vbChangeFHWA:=True$vbChangeFHWA_to:=TrueEnd if End if : (($vsNewCode#"NBI") & ($vsNewCode#"634"))If ([Bridge MHD NBIS]FHWARecord)$msg:="Switching Bridge Category Code to a non-NBI category Type"$msg:=$msg+◊sCR+"while Bridge Record is on the NBI List!"$msg:=$msg+◊sCR+◊sCR+"Continue only with the Item8 Change, or"$msg:=$msg+◊sCR+"Take Record off the NBI List also?"$vsChgFHWA:="Take off NBI"$viPromptRes:=ut_3Option_Confirm ($msg;$vsCont;$vsChgFHWA)$vbChangeItem8:=($viPromptRes#3)  `cancel is 3If ($viPromptRes=2)$vbChangeFHWA:=True$vbChangeFHWA_to:=FalseEnd if End if End case If ($vbChangeItem8)[Bridge MHD NBIS]Item8:=Change string([Bridge MHD NBIS]Item8;aIt8BrCatCode_{aIt8BrCatDes_};13)PushChange (1;->[Bridge MHD NBIS]Item8)[Bridge MHD NBIS]Item8:=Change string([Bridge MHD NBIS]Item8;[Bridge MHD NBIS]BDEPT;1)PushChange (1;->[Bridge MHD NBIS]Item8)[Bridge MHD NBIS]Item8:=Change string([Bridge MHD NBIS]Item8;[Bridge MHD NBIS]BIN;7)PushChange (1;->[Bridge MHD NBIS]Item8)[Bridge MHD NBIS]Item8 BridgeCat:=aIt8BrCatCode_{aIt8BrCatDes_}PushChange (1;->[Bridge MHD NBIS]Item8 BridgeCat)vIt8BrCatDes:=aIt8BrCatDes_{aIt8BrCatDes_}Else   `Leave array the way it wasaIt8BrCatDes_:=Find in array(aIt8BrCatCode_;Substring([Bridge MHD NBIS]Item8;13;3))REDRAW(aIt8BrCatDes_)End if If ($vbChangeFHWA)[Bridge MHD NBIS]FHWARecord:=$vbChangeFHWA_toPushChange (1;->[Bridge MHD NBIS]FHWARecord)End if End case 