ÊÊ` Method: INSP_ElmSft_Input_FMÊÊ` DescriptionÊÊ` ÊÊ` ParametersÊÊ` ----------------------------------------------------If (False)ÊÊ` ----------------------------------------------------ÊÊ` User name (OS): costasmanousakisÊÊ` User name (4D): DesignerÊÊ` Date and time: 01/22/08, 12:30:16ÊÊ` ----------------------------------------------------Mods_2007_CM_5401 ÊÊ` Modified by: costasmanousakis-(Designer)-(5/15/09 10:20:34)Mods_2009_05 ÊÊ`ÊÊ`Made sure the focus is on the Rating field on the on load eventÊÊ`ÊÊ`Unload the record when in ReadOnly mode (vbInspectionLocked=true)ÊÊ` Modified by: costasmanousakis-(Designer)-(1/18/11 16:13:17)Mods_2011_01 ÊÊ`` Rail Road changesMods_2013_02 ÊÊ`r001 ` Allow for different headings on weightsÊÊ`Modified by: Charles Miller (2/14/13 16:14:45)ÊÊ` Modified by: Costas Manousakis-(Designer)-(5/1/13 08:24:18)Mods_2013_05 ÊÊ`ÊÊ`Added Tunnel Elements categoriesÊÊ` Modified by: Costas Manousakis-(Designer)-(10/24/13 11:19:39)Mods_2013_10 ÊÊ`ÊÊ`use  method  INSP_IsInspRoutine_b to check if inspection is a routine oneEnd if Case of : (Form event=On Load )INSP_SetWPHeadings C_BOOLEAN(bElmNotValidated)If (Is new record([ElementsSafety]))ÊÊ`new record - we do not allow this here..C_TEXT($alertMsg)$alertMsg:="Elements must be added using the Configure button on the main Inspection Form!"$alertMsg:=$alertMsg+×sCR+"To edit Elements double-click on a non-blank line."ALERT($alertMsg)CANCELElse C_LONGINT($k;$KParent;$ElmCat)C_INTEGER($ElmNo_i)$ElmNo_i:=[ElementsSafety]ElementNo$K:=Find in array(×ELMTDICT_ELNum_ai;$ElmNo_i)If (INSP_IsInspRoutine_b Ê|Ê([Inspections]Insp Type="CLD"))If ([ElementsSafety]SpecMemb Flag)ÊÊ`25-nov-03GOTO PAGE(2)Else GOTO PAGE(1)End if If (×ELMTDICT_Cat_as{$K}#"N59")ÊÊ`Hide Weld for non-superstructureSET VISIBLE(*;"DE Weld@";False)ÊÊ`fieldsSET VISIBLE(*;"Weld@";False)ÊÊ`labelsElse SET VISIBLE(*;"DE Weld@";True)SET VISIBLE(*;"Weld@";True)End if If (Position(×ELMTDICT_Cat_as{$K};";APP;OVR;TRA;GEN;")>0)ÊÊ`Hide Dive for App, Ovr, Tra, GENSET VISIBLE(*;"DE Dive@";False)ÊÊ`fieldsSET VISIBLE(*;"Dive@";False)ÊÊ`labelsElse SET VISIBLE(*;"DE Dive@";True)SET VISIBLE(*;"Dive@";True)If ([Inspections]Item 93b=!00/00/00!)SET VISIBLE(*;"DE Dive@";False)SET VISIBLE(*;"Dive@";False)End if End if If ([Inspections]Insp Type="CLD")SET VISIBLE(*;"DE SpecMembBox";False)End if End if ÊÊ`## Initialize transfer dataInitChangeStack (2)TimeStamp (->[ElementsSafety];->[ElementsSafety]DateCreated;->[ElementsSafety]TimeCreated;->[ElementsSafety]DateModified;->[ElementsSafety]TimeModified)Case of : (×ELMTDICT_Cat_as{$K}="N60")vItem:="Item 60 - Substructure": (×ELMTDICT_Cat_as{$K}="N61")vItem:="Item 61 - Channel & Channel Protection": (×ELMTDICT_Cat_as{$K}="N62")vItem:="Item 62 - Culverts": (×ELMTDICT_Cat_as{$K}="N58")vItem:="Item 58 - Deck": (×ELMTDICT_Cat_as{$K}="N59")vItem:="Item 59 - Superstructure": (×ELMTDICT_Cat_as{$K}="STR")vItem:="62a -  Structural": (×ELMTDICT_Cat_as{$K}="ROA")vItem:="62b -  Roadway": (×ELMTDICT_Cat_as{$K}="CEI")vItem:="62c -  Ceiling/Overhead": (×ELMTDICT_Cat_as{$K}="SUP")vItem:="62d -  Air Ducts": (×ELMTDICT_Cat_as{$K}="CRO")vItem:="62e -  Cross Passage": (×ELMTDICT_Cat_as{$K}="EGR")vItem:="62f -  Egress": (×ELMTDICT_Cat_as{$K}="UTI")vItem:="62g -  Utility Room": (×ELMTDICT_Cat_as{$K}="WET")vItem:="Wetness"Else $ElmCat:=Find in array(×aInspCod;×ELMTDICT_Cat_as{$K})If ($ElmCat>0)vItem:=×aInspType{$ElmCat}Else vItem:="????"End if End case vElmPrefix:=GetElmtNumber If (×ELMTDICT_Parent_ai{$K}>0)$KParent:=Find in array(×ELMTDICT_ELNum_ai;×ELMTDICT_Parent_ai{$K})If ($KParent>0)vItem:=vItem+" - "+×ELMTDICT_Txt_as{$KParent}End if End if If (vbInspectionLocked)ÊÊ`disable entry if inspection is lockedSET ENTERABLE(*;"DE@";False)DISABLE BUTTON(*;"DE@")WR LOCK DOCUMENT (AreaElmComments;1)ÊÊ`disable 4dWrite areaSET COLOR(*;"DE@";×Color_Not_editable)ut_UnloadRecord (->[ElementsSafety])Else ÊÊ`otherwise make sure they are enterable    SET ENTERABLE(*;"DE@";True)ENABLE BUTTON(*;"DE@")WR LOCK DOCUMENT (AreaElmComments;0)ÊÊ`enable 4dWrite areaIf ([ElementsSafety]Deficiency="N")DISABLE BUTTON(aUORCAT_)SET ENTERABLE([ElementsSafety]Priority;False)SET COLOR(*;"DE Priority@";×Color_Not_editable)Else ENABLE BUTTON(aUORCAT_)SET ENTERABLE([ElementsSafety]Priority;True)SET COLOR(*;"DE Priority@";×Color_Editable)End if If ([Inspections]Insp Type="CLD")DISABLE BUTTON(*;"DE Button Delete@")End if If (Position([Inspections]Insp Type;";CMI;OTH;FCR;DAM;")>0)If (vLoadRtgNA=1)SET ENTERABLE(*;"DE LoadRating@";False)SET COLOR(*;"DE LoadRating@";×Color_Not_editable)Else SET ENTERABLE(*;"DE LoadRating@";True)SET COLOR(*;"DE LoadRating@";×Color_editable)End if End if If ([Inspections]Insp Type#"DV@")GOTO AREA([ElementsSafety]Rating)Else GOTO AREA([ElementsSafety]AltRating)End if End if ÊÊ`This variable is set to avoid a feature of the 4D Write areaÊÊ``where an extra on data change event is generated after the on validate eventÊÊ`when moving to another elementssafety record using the record navigation keysbElmNotValidated:=TrueEnd if : (Form event=On Validate )TimeStamp (->[ElementsSafety];->[ElementsSafety]DateCreated;->[ElementsSafety]TimeCreated;->[ElementsSafety]DateModified;->[ElementsSafety]TimeModified)[ElementsSafety]Modified By:=×CurrentUser_NamePushChange (2;->[ElementsSafety]Modified By)PushChange (2;->[ElementsSafety]DateModified)PushChange (2;->[ElementsSafety]TimeModified)bElmNotValidated:=FalseÊÊ`##Save changes made to fileFlushGrpChgs (2;->[Inspections]InspID;->[ElementsSafety]InspID;->[ElementsSafety]ElmSafetyID;2)End case 