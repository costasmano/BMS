  ` ----------------------------------------------------  ` Method: QR_InspSchedInfo  ` Description  `  ` Calls QR_NextInspInfo and then uses SIA_NEXTINSPTYPECODE_TXT to find the last  `  ` matching inspection record. Then in the quick report fields from the inspection record can be used.   `   ` Parameters  ` $1 : $InfoType_txt   ` $2 : $StartDate_txt : starting date in text "MM/DD/YYYY" - if blank string the current date is used  ` ----------------------------------------------------If (False)  ` ----------------------------------------------------  ` User name (OS): costasmanousakis  ` User name (4D): Designer  ` Date and time: 10/28/11, 11:17:09  ` First ReleaseMods_2011_10   ` Modified by: Costas Manousakis-(Designer)-(9/11/13 16:49:48)Mods_2013_09   `  `Added handling of tunnel inspectionsEnd if C_TEXT($InfoType_txt)$InfoType_txt:="ANY"If (Count parameters>0)C_TEXT($1)$InfoType_txt:=$1End if If ($InfoType_txt="")$InfoType_txt:="ANY"End if C_DATE($StartDate_d)$StartDate_d:=Current date(*)If (Count parameters>1)C_TEXT($2;$StartDate_txt)$StartDate_txt:=$2$StartDate_d:=Date($StartDate_txt)If ($StartDate_d=!00/00/00!)$StartDate_d:=Current date(*)End if End if C_BOOLEAN($TNLRO_b)$TNLRO_b:=Read only state([TunnelInfo])If (Not($TNLRO_b))READ ONLY([TunnelInfo])End if QUERY([TunnelInfo];[TunnelInfo]BIN=[Bridge MHD NBIS]BIN)QR_NextInspInfo ($InfoType_txt;String($StartDate_d);"Start")C_BOOLEAN($inspRO_b)$inspRO_b:=Read only state([Inspections])If (Not($inspRO_b))READ ONLY([Inspections])End if QUERY([Inspections];[Inspections]BIN=[Bridge MHD NBIS]BIN)Case of : (SIA_NEXTINSPTYPECODE_TXT="RTN")  `we search for RTN, RTA, CULQUERY SELECTION([Inspections];[Inspections]Insp Type="RT@";*)QUERY SELECTION([Inspections]; | ;[Inspections]Insp Type="CUL"): (SIA_NEXTINSPTYPECODE_TXT="DVE")  `we search for DVE, DVSQUERY SELECTION([Inspections];[Inspections]Insp Type="DVE";*)QUERY SELECTION([Inspections]; | ;[Inspections]Insp Type="DVL"): (SIA_NEXTINSPTYPECODE_TXT="CMI")QUERY SELECTION([Inspections];[Inspections]Insp Type="RT@";*)QUERY SELECTION([Inspections]; | ;[Inspections]Insp Type="CUL";*)QUERY SELECTION([Inspections]; | ;[Inspections]Insp Type="CMI"): (SIA_NEXTINSPTYPECODE_TXT="DVS")QUERY SELECTION([Inspections];[Inspections]Insp Type="DVE";*)QUERY SELECTION([Inspections]; | ;[Inspections]Insp Type="DVL";*)QUERY SELECTION([Inspections]; | ;[Inspections]Insp Type="DVS"): (SIA_NEXTINSPTYPECODE_TXT="TOV")QUERY SELECTION([Inspections];[Inspections]Insp Type="TOV"): (SIA_NEXTINSPTYPECODE_TXT="SP1")QUERY SELECTION([Inspections];[Inspections]Insp Type="CMI"): (SIA_NEXTINSPTYPECODE_TXT="SP2")QUERY SELECTION([Inspections];[Inspections]Insp Type="CMI"): (SIA_NEXTINSPTYPECODE_TXT="SP3")QUERY SELECTION([Inspections];[Inspections]Insp Type="CMI")Else   `normal searchQUERY SELECTION([Inspections];[Inspections]Insp Type=SIA_NEXTINSPTYPECODE_TXT)End case ORDER BY([Inspections];[Inspections]Insp Date;<)FIRST RECORD([Inspections])If (Not($inspRO_b))READ WRITE([Inspections])End if If (Not($TNLRO_b))READ WRITE([TunnelInfo])End if 