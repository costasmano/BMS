  `procedure: CreateRandomSet  `purpose: create a random set of bridges  from the Search Bridge dialogIf (False)  `by: Albert Leung  `created: 5/21/97  `modified:Mods_2005_CM17   ` Modified by: costasmanousakis-(Designer)-(1/11/2006 14:43:28)Mods_2006_CM03   ` Modified by: costasmanousakis-(Designer)-(11/24/2006 17:32:45)Mods_2006_CM07   ` Modified by: costasmanousakis-(Designer)-(9/28/2007 12:21:35)Mods_2007_CM12_5301   ` Modified by: costasmanousakis-(Designer)-(10/24/2007 09:15:53)Mods_2007_CM12_5302   ` Modified by: costasmanousakis-(Designer)-(1/8/08 16:39:19)Mods_2007_CM_5401   ` Modified by: Costas Manousakis-(Designer)-(12/30/13 16:44:16)Mods_2013_12   `  `Instead of blanking the search variables,  leave them with a space as a workaround for the v13  upgrade.End if SRC_DeclareBrgVars C_STRING(30;$s)vBDEPT:=Replace string(vBDEPT;" ";"")vBDEPT:=Replace string(vBDEPT;"_";"")vBridgeKey:=Replace string(vBridgeKey;" ";"")vBIN:=Replace string(vBIN;" ";"")If (Not(SRC_NewSearchMethod_b))If ((vBIN+vBridgeKey+vBDEPT)#"")If ((vAddTo) & (Records in set("Random Set")=0))CREATE SET([Bridge MHD NBIS];"Random Set")End if DISABLE BUTTON(bFind)If (Not(SRC_HideLooking_b))SHORT_MESSAGE ("Looking…")End if If (vAddTo)If (SRC_AllowSearchAll_b)ALL RECORDS([Bridge MHD NBIS])Else USE NAMED SELECTION("UserRegionA")End if Else If (SRC_AllowSearchAll_b)ALL RECORDS([Bridge MHD NBIS])Else USE NAMED SELECTION("UserRegionA")End if End if If (vBDEPT#"")$s:=fRemoveChar (" ";vBDEPT)If (Length($s)<6)$s:=$s+"@"End if QUERY SELECTION([Bridge MHD NBIS];[Bridge MHD NBIS]BDEPT=$s)End if If (vBridgeKey#"")$s:=fRemoveChar (" ";vBridgeKey)If (Length($s)<12)$s:=$s+"@"End if QUERY SELECTION([Bridge MHD NBIS];[Bridge MHD NBIS]Bridge Key=$s)End if If (vBIN#"")$s:=fRemoveChar (" ";vBIN)If (Length($s)<3)$s:=$s+"@"End if QUERY SELECTION([Bridge MHD NBIS];[Bridge MHD NBIS]BIN=$s)End if CREATE SET([Bridge MHD NBIS];"Found Bridge Recs Set")If (Records in set("Random Set")=0)If (vAddTo=False)CREATE EMPTY SET([Bridge MHD NBIS];"Random Set")End if End if UNION("Random Set";"Found Bridge Recs Set";"Random Set")C_TEXT(vsSearchResults)vsSearchResults:="Last Find : "+String(Records in set("Found Bridge Recs Set"))+" Recs"vsSearchResults:=vsSearchResults+" - Total Recs Found : "+String(Records in set("Random Set"))CLEAR SET("Found Bridge Recs Set")ENABLE BUTTON(bFind)Case of : (vBIN#"")GOTO AREA(vBIN)SRC_StartFieldArea_s:="BI": (vBDEPT#"")GOTO AREA(vBDEPT)SRC_StartFieldArea_s:="BD": (vBridgeKey#"")GOTO AREA(vBridgeKey)SRC_StartFieldArea_s:="BK"End case vBIN:=""vBDEPT:=""vBridgeKey:=""If (Not(SRC_HideLooking_b))CLOSE WINDOWEnd if End if Else If ((vBIN+vBridgeKey+vBDEPT)#"")If ((vAddTo) & (Records in set("Random Set")=0))CREATE SET(SRC_MasterTable_ptr->;"Random Set")End if DISABLE BUTTON(bFind)If (Not(SRC_HideLooking_b))SHORT_MESSAGE ("Looking…")End if If (vAddTo)If (SRC_AllowSearchAll_b)ALL RECORDS(SRC_MasterTable_ptr->)Else USE NAMED SELECTION("UserRegionA")End if Else If (SRC_AllowSearchAll_b)ALL RECORDS(SRC_MasterTable_ptr->)Else USE NAMED SELECTION("UserRegionA")End if End if If (vBDEPT#"")$s:=Replace string(vBDEPT;" ";"")If (Length($s)<6)$s:=$s+"@"End if QUERY SELECTION(SRC_MasterTable_ptr->;SRC_BDEPTField_ptr->=$s)End if If (vBridgeKey#"")$s:=Replace string(vBridgeKey;" ";"")If (Length($s)<12)$s:=$s+"@"End if QUERY SELECTION(SRC_MasterTable_ptr->;SRC_BRKEYField_ptr->=$s)End if If (vBIN#"")$s:=Replace string(vBIN;" ";"")If (Length($s)<3)$s:=$s+"@"End if QUERY SELECTION(SRC_MasterTable_ptr->;SRC_BINField_ptr->=$s)End if CREATE SET(SRC_MasterTable_ptr->;"Found Bridge Recs Set")If (Records in set("Random Set")=0)If (vAddTo=False)CREATE EMPTY SET(SRC_MasterTable_ptr->;"Random Set")End if End if UNION("Random Set";"Found Bridge Recs Set";"Random Set")C_TEXT(vsSearchResults)vsSearchResults:="Last Find : "+String(Records in set("Found Bridge Recs Set"))+" Recs"vsSearchResults:=vsSearchResults+" - Total Recs Found : "+String(Records in set("Random Set"))CLEAR SET("Found Bridge Recs Set")If (Not(SRC_HideLooking_b))CLOSE WINDOWEnd if ENABLE BUTTON(bFind)Case of : (vBIN#"")GOTO AREA(vBIN)vBIN:=" "vBDEPT:=""vBridgeKey:=""SRC_StartFieldArea_s:="BI": (vBDEPT#"")GOTO AREA(vBDEPT)vBIN:=""vBDEPT:=" "vBridgeKey:=""SRC_StartFieldArea_s:="BD": (vBridgeKey#"")GOTO AREA(vBridgeKey)vBIN:=""vBDEPT:=""vBridgeKey:=" "SRC_StartFieldArea_s:="BK"End case End if End if 