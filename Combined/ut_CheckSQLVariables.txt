  `----------------------------------------------------  `User name (OS): Charles Miller  `Date and time: 01/28/11, 14:14:50  `----------------------------------------------------  `Method: ut_CheckSQLVariables  `Description  `  ` Parameters  ` ----------------------------------------------------If (False)  `Ugrade to v11  `Modified by: Charles Miller (1/28/11 14:14:51)End if If (Application type#4D Server )If (Not(Is compiled mode))If (User in group(Current user;"Design Access Group"))C_LONGINT($TableLoop_l;$Length_l;$FieldLoop_l;$Type_l)C_TEXT($VariablePrefix_txt;$VariableName_txt)C_POINTER($Variable_ptr)C_BOOLEAN($AllOK_b;$Indexed_b;$Unique_b;$Invisible_b)$AllOK_b:=TrueCompiler_FieldVariables For ($TableLoop_l;1;Get last table number)If (Is table number valid($TableLoop_l))$VariablePrefix_txt:="v_"+String($TableLoop_l)+"_"For ($FieldLoop_l;1;Get last field number($TableLoop_l))If (Is field number valid($TableLoop_l;$FieldLoop_l))$VariableName_txt:=$VariablePrefix_txt+String($FieldLoop_l;"000")GET FIELD PROPERTIES($TableLoop_l;$FieldLoop_l;$Type_l;$Length_l;$Indexed_b;$Unique_b;$Invisible_b)Case of : ($Type_l=7): ($Type_l=Is Alpha Field ) | ($Type_l=Is Text )$VariableName_txt:=$VariableName_txt+"_txt": ($Type_l=Is Real )$VariableName_txt:=$VariableName_txt+"_r": ($Type_l=Is Integer ) | ($Type_l=Is LongInt )$VariableName_txt:=$VariableName_txt+"_l": ($Type_l=Is Date )$VariableName_txt:=$VariableName_txt+"_d": ($Type_l=Is Time )$VariableName_txt:=$VariableName_txt+"_tm": ($Type_l=Is Boolean )$VariableName_txt:=$VariableName_txt+"_b": ($Type_l=Is Picture )$VariableName_txt:=$VariableName_txt+"_p": ($Type_l=Is BLOB )$VariableName_txt:=$VariableName_txt+"_blb"Else End case $Variable_ptr:=Get pointer($VariableName_txt)If (Undefined($Variable_ptr->)) & ($Type_l#7)$AllOK_b:=False$FieldLoop_l:=Get last field number($TableLoop_l)+10$TableLoop_l:=Get last table number+10Else Case of : ($Type_l=7): ($Type_l=Is Alpha Field ) | ($Type_l=Is Text )If (Type($Variable_ptr->)=Is Text ) | (Type($Variable_ptr->)=Is String Var )Else $AllOK_b:=False$FieldLoop_l:=Get last field number($TableLoop_l)+10$TableLoop_l:=Get last table number+10End if : ($Type_l=Is Real )If (Type($Variable_ptr->)=Is Real )Else $AllOK_b:=False$FieldLoop_l:=Get last field number($TableLoop_l)+10$TableLoop_l:=Get last table number+10End if : ($Type_l=Is Integer ) | ($Type_l=Is LongInt )If (Type($Variable_ptr->)=Is Integer ) | (Type($Variable_ptr->)=Is LongInt )Else $AllOK_b:=False$FieldLoop_l:=Get last field number($TableLoop_l)+10$TableLoop_l:=Get last table number+10End if : ($Type_l=Is Date )If (Type($Variable_ptr->)=Is Date )Else $AllOK_b:=False$FieldLoop_l:=Get last field number($TableLoop_l)+10$TableLoop_l:=Get last table number+10End if : ($Type_l=Is Time )If (Type($Variable_ptr->)=Is Time )Else $AllOK_b:=False$FieldLoop_l:=Get last field number($TableLoop_l)+10$TableLoop_l:=Get last table number+10End if : ($Type_l=Is Boolean )If (Type($Variable_ptr->)=Is Boolean )Else $AllOK_b:=False$FieldLoop_l:=Get last field number($TableLoop_l)+10$TableLoop_l:=Get last table number+10End if : ($Type_l=Is Picture )If (Type($Variable_ptr->)=Is Picture )Else $AllOK_b:=False$FieldLoop_l:=Get last field number($TableLoop_l)+10$TableLoop_l:=Get last table number+10End if : ($Type_l=Is BLOB )If (Type($Variable_ptr->)=Is BLOB )Else $AllOK_b:=False$FieldLoop_l:=Get last field number($TableLoop_l)+10$TableLoop_l:=Get last table number+10End if Else End case End if End if End for End if End for If (Not($AllOK_b))CONFIRM("There are some ill defined variables for SQL calls."+Char(Carriage return )+"Do you want to create new documents now?";"Yes";"No")If (OK=1)ut_CreateSQLVariables End if End if End if End if End if   `End ut_CheckSQLVariables