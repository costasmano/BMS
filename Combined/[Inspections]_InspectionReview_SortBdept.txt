If (False)ÊÊ` Modified by: costasmanousakis-(Designer)-(5/18/2006 15:28:06)Mods_2006_CM04 End if C_BOOLEAN($dobyfield_b)$dobyfield_b:=FalseCase of : (Form event=On Load )C_POINTER(MultiLevelTbl)MultiLevelTbl:=->[Inspections]If ((Self->=0)Ê|Ê(Self->=1))Self->:=1End if If ($dobyfield_b)C_BOOLEAN($vbShift)$vbShift:=Shift downMULTILEVEL (->[Bridge MHD NBIS]BDEPT;Self;$vbShift)SET CURSOR(0)Else INSP_SortbyBDEPT (Self->)ARRAY POINTER(aPtrSortField;0)ARRAY POINTER(aPtrSortOrder;0)SortInspType:=0SortBIN:=0SortInspDate:=0SorttmLdr:=0vbSortedHeader:=TrueEnd if REDRAW WINDOW: (Form event=On Clicked )SET CURSOR(4)If ((Self->=0)Ê|Ê(Self->=1))Self->:=1End if If ($dobyfield_b)C_BOOLEAN($vbShift)$vbShift:=Shift downMULTILEVEL (->[Bridge MHD NBIS]BDEPT;Self;$vbShift)SET CURSOR(0)SortTmLdr:=0ÊÊ`this is not part of the multilevel sort yet.REDRAW WINDOWvbSortedHeader:=TrueElse INSP_SortbyBDEPT (Self->)End if : ((Form event=On Header )Ê&ÊNot(vbSortedHeader))If (SortBdept>0)If ($dobyfield_b)Case of : (SortBdept=1)ORDER BY([Inspections];[Bridge MHD NBIS]BDEPT;>): (SortBdept=2)ORDER BY([Inspections];[Bridge MHD NBIS]BDEPT;<)End case Else INSP_SortbyBDEPT (SortBdept)End if REDRAW WINDOWEnd if End case 