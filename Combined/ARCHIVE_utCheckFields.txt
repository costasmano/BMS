  `Method: ARCHIVE_utCheckFields  `Description  `  `Verify that all fields in the master table are in the archive table  `  `Fields are named the same; verify fields exist; fields are same type; length is same for strings  ` Parameters  ` $1 : $MasterTbl_ptr  ` $2 : $ArchiveTbl_ptr  ` ----------------------------------------------------If (False)  ` ----------------------------------------------------  `User name (OS): Costas Manousakis  `User (4D) : Designer  `Date and time: 06/18/13, 10:12:23  ` ----------------------------------------------------  `Created : Mods_2013_06 End if   `If (Application type#4D Server )If (Not(Is compiled mode))If (User in group(Current user;"Design Access Group"))C_POINTER($1;$MasterTbl_ptr)$MasterTbl_ptr:=$1C_POINTER($2;$ArchiveTbl_ptr)$ArchiveTbl_ptr:=$2C_LONGINT($FieldLoop_L;$Type_L;$FieldLength_L;$TblNum_L;$MatchFiled_L;$ArchType_L;$ArchFieldLength_L;$ArchTblNum_L;$MasterTblNum_L)C_TEXT($FieldName_txt;$TypeMissmatch_txt;$LengthMissmatch_txt;$MissingFilelds_txt)ARRAY TEXT($MasterFields_atxt;Get last field number($MasterTbl_ptr))ARRAY TEXT($ArchiveFields_atxt;Get last field number($ArchiveTbl_ptr))$ArchTblNum_L:=Table($ArchiveTbl_ptr)  `Get  the archive table fields For ($FieldLoop_l;1;Get last field number($ArchiveTbl_ptr))If (Is field number valid($ArchTblNum_L;$FieldLoop_l))$ArchiveFields_atxt{$FieldLoop_l}:=Field name($ArchTblNum_L;$FieldLoop_l)End if End for C_BOOLEAN($AllOK_b;$Indexed_b;$Unique_b;$Invisible_b)  `Loop through the master fields$MasterTblNum_L:=Table($MasterTbl_ptr)$AllOK_b:=True$TypeMissmatch_txt:=""$LengthMissmatch_txt:=""$MissingFilelds_txt:=""For ($FieldLoop_l;1;Get last field number($MasterTbl_ptr))If (Is field number valid($MasterTblNum_L;$FieldLoop_l))$FieldName_txt:=Field name($MasterTblNum_L;$FieldLoop_l)$MatchFiled_L:=Find in array($ArchiveFields_atxt;$FieldName_txt)GET FIELD PROPERTIES($MasterTblNum_L;$FieldLoop_l;$Type_L;$FieldLength_L;$Indexed_b;$Unique_b;$Invisible_b)If ($MatchFiled_L>0)  `Found it ! check type and sizeGET FIELD PROPERTIES($ArchTblNum_L;$MatchFiled_L;$ArchType_L;$ArchFieldLength_L)If ($Type_L#$ArchType_L)$AllOK_b:=False$TypeMissmatch_txt:=$TypeMissmatch_txt+Char(13)+$FieldName_txt+"  main: "+fGetDataType ($Type_L)+" arch: "+fGetDataType ($ArchType_L)End if If ($FieldLength_L#$ArchFieldLength_L)$AllOK_b:=False$LengthMissmatch_txt:=$LengthMissmatch_txt+Char(13)+$FieldName_txt+"  main: "+String($FieldLength_L)+" arch: "+String($ArchFieldLength_L)End if Else   `missing field$AllOK_b:=False$MissingFilelds_txt:=$MissingFilelds_txt+Char(13)+$FieldName_txt+" type "+fGetDataType ($Type_L)+" length "+String($FieldLength_L)+" indexed:"+f_Boolean2String ($Indexed_b;"YN")+" unique:"+f_Boolean2String ($Unique_b;"YN")+" invis:"+f_Boolean2String ($Invisible_b;"YN")End if End if End for If (Not($AllOK_b))C_TEXT($AllErrors_txt)$AllErrors_txt:="Errors found comparing Master table ["+Table name($MasterTblNum_L)+"] vs Archive table ["+Table name($ArchTblNum_L)+"]"+Char(13)$AllErrors_txt:=$AllErrors_txt+Char(13)+"Missing fields : "+$MissingFilelds_txt+Char(13)$AllErrors_txt:=$AllErrors_txt+Char(13)+"MisTyped fields : "+$TypeMissmatch_txt+Char(13)$AllErrors_txt:=$AllErrors_txt+Char(13)+"Length MisMatch fields : "+$LengthMissmatch_txtut_BigAlert ($AllErrors_txt)End if End if End if End if   `End ARCHIVE_utCheckFields