If (False)ÊÊ`[Inspections];"Closed Bridge"Mods_2004_CM12 Mods_2005_CM05 Mods_2005_CM06 Mods_2005_CM08 ÊÊ` Modified by: costasmanousakis-(Designer)-(8/22/2007 15:34:48)Mods_2007_CM12_5301 ÊÊ` Modified by: costasmanousakis-(Designer)-(4/09/09 11:59:38)Mods_2009_04 ÊÊ`ÊÊ`Removed the call to G_InitInspVarsÊÊ` Modified by: Costas Manousakis-(Designer)-(5/9/12 17:16:48)Mods_2012_05 ÊÊ`ÊÊ`Renamed the format pulldowns and changed the code there to call  WRUTIL_FunctionÊÊ` Modified by: Costas Manousakis-(Designer)-(12/8/12 21:07:31)Mods_2012_12 ÊÊ`ÊÊ`Moved and resized objects in the comments page for better visual when menu is shown in 4D Write areas.ÊÊ` Modified by: Costas Manousakis-(Designer)-(1/7/13 16:32:02)Mods_2013_01 ÊÊ`ÊÊ`Minor changes in the UI Look ÊÊ`ÊÊ`Use new method Insp_SortElmtSfty and  INSP_LoadElmLabelsforReport for RR@ inspection typesMods_2013_03 ÊÊ`r001 ` Add code to display correct headings on forms based upon [Bridge MHD NBIS]InspRespÊÊ`Modified by: Charles Miller (3/12/13 13:57:14)End if C_STRING(255;vInspTitle)C_INTEGER($i;$j;$k)C_BOOLEAN(blnDBIE)Case of : (Form event=On Load )Case of : ([Bridge MHD NBIS]InspResp="MBTA")SET VISIBLE(*;"MBTAText@";True)SET VISIBLE(*;"NonMBTAText@";False)Else SET VISIBLE(*;"MBTAText@";False)SET VISIBLE(*;"NonMBTAText@";True)End case ÊÊ`try transactions for data entered in include forms and updated via buttonsSTART TRANSACTIONCase of : ([Inspections]Cld_Schedule="1")x1:=1: ([Inspections]Cld_Schedule="2")x2:=1: ([Inspections]Cld_Schedule="3")x3:=1: ([Inspections]Cld_Schedule="4")x4:=1: ([Inspections]Cld_Schedule="5")x5:=1End case ÊÊ`Only the DBIE can enter these    If (False)blnDBIE:=(Current user=×DBIED1Uname)Ê|Ê(Current user=×DBIED2Uname)Ê|Ê(Current user=×DBIED3Uname)Ê|Ê(Current user=×DBIED4Uname)Ê|Ê(Current user=×DBIED5Uname)End if blnDBIE:=User in group(Current user;"Inspection Engineers")blnDBIE:=(blnDBIEÊ|Ê(Current user="designer"))ÊÊ`## Initialize transfer dataInitChangeStack (1)C_BOOLEAN(bDiveFormValid)bDiveFormValid:=FalsevInspTitle:=[Inspection Type]Description+" Inspection"INSP_Item43Desc INSP_Item107Desc G_Insp_RelateInsp (->[ElementsSafety]InspID;->[Standard Photos]InspID;->[Field Trip]InspID)ÊÊ`Check boxes    If ([Inspections]ClosedSigns=False)CBCldPost:=1Else CBCldPost:=0End if C_STRING(3;CurCat)CurCat:="ALL"ÊÊ`ORDER BY FORMULA([ElementsSafety];[ElementDict]Category;>;(GetElmtNumber );>)INSP_LoadElmLabelsforReport ([Inspections]BaseType_s)Insp_SortElmtSfty G_Insp_ElmtArray_setup POPUPMENUC (->aPedTraffNE;->aPedTraffCode;->[Inspections]PedBarricadesNE)POPUPMENUC (->aPedTraffSW;->aPedTraffCode;->[Inspections]PedBarricadesSW)ÊÊ`ImagesG_InitInspImages ÊÊ`Check on security...G_SecureInspection If (vbInspectionLocked)ÊÊ`disable entry if inspection is lockedG_Insp_LockFormOnOff (True)Else ÊÊ`otherwise make sure they are enterable    G_Insp_LockFormOnOff (False)If ((([Inspections]InspReviewed=BMS Not Reviewed ))Ê&Ê([Inspections]Item 93b=!00/00/00!))If ([Bridge MHD NBIS]Item92BB>0)[Inspections]Item 93b:=[Bridge MHD NBIS]Item93BEnd if If ([Inspections]Item 93b#!00/00/00!)PushChange (1;->[Inspections]Item 93b)End if End if SET ENTERABLE(*;"DE Sgn@";(CBCldPost=0))ÊÊ`ASL 7-8-2003ÊÊ`Alert user to differences in dependent dataCheckDependencies G_ReplyBtnCfg If ([Inspections]ClosedSigns)CBCldPost:=0Else CBCldPost:=1End if SET ENTERABLE(*;"DE Sgn@";((CBCldPost=0)))If (CBCldPost=0)SET COLOR(*;"DE Sgn@";×Color_Editable)Else SET COLOR(*;"DE Sgn@";×Color_Not_Editable)End if End if ÊÊ`if(Locked)G_Insp_SetPersUI If (blnDBIE=True)ENABLE BUTTON(*;"DBIE@")Else DISABLE BUTTON(*;"DBIE@")End if If ([Inspections]Cld_UnderConstruction)CBCldUnderConstruction:=1Else CBCldUnderConstruction:=0End if If (([Inspections]Cld_UnderConstruction)Ê&ÊNot(vbInspectionLocked))ÊÊ`unlock fieldsSET ENTERABLE(*;"DBIE Cld @";TrueÊ&ÊblnDBIE)If (blnDBIE)SET COLOR(*;"DBIE Cld @";×Color_Editable)Else SET COLOR(*;"DBIE Cld @";×Color_Not_Editable)End if Else ÊÊ`lock fieldsSET ENTERABLE(*;"DBIE Cld @";False)SET COLOR(*;"DBIE Cld @";×Color_Not_Editable)End if : (Form event=On Close Detail )If (Current form page=2)ÊÊ`on elementssafety pageG_Insp_ElmtArray_setup End if End case 