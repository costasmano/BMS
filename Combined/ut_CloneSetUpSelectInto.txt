  `----------------------------------------------------  `User name (OS): Charles Miller  `Date and time: 07/22/13, 15:10:52  `----------------------------------------------------  `Method: ut_CloneSetUpSelectInto  `Description  `  ` Parameters  ` ----------------------------------------------------If (False)Mods_2013_07   `r001 `   `Modified by: Charles Miller (7/22/13 15:10:53)Mods_2013_09   `r001 `  Changes in cloning to use arrays whenever possible  `Modified by: Charles Miller (9/10/13 13:11:36)End if C_LONGINT($1;$TableNumber_l;$ACTLastFieldNumber_l;$Loop_l;$FieldType_l;$Length_l)$TableNumber_l:=$1C_TEXT($TableName_txt)$TableName_txt:=Table name($TableNumber_l)C_POINTER($2;$3)C_BOOLEAN($ReturnArrays_b)C_BOOLEAN($4;$UseArrays_b)$UseArrays_b:=$4SQL_Limit_L:=1$ACTLastFieldNumber_l:=Get last field number(Table($TableNumber_l))If ($UseArrays_b)C_BOOLEAN($IsTableName_b)C_LONGINT($Loc_L)$Loc_L:=Find in array(SQL_LimitNames_atxt;$TableName_txt)SQL_Limit_L:=0If ($Loc_L<1)$Loc_L:=1$ACTLastFieldNumber_l:=Get last field number($TableNumber_l)Repeat $IsTableName_b:=TrueIf (String(Num(SQL_LimitNames_atxt{$Loc_L}))=SQL_LimitNames_atxt{$Loc_L})$IsTableName_b:=FalseEnd if Case of : ($IsTableName_b): ($ACTLastFieldNumber_l>Num(SQL_LimitNames_atxt{$Loc_L}))SQL_Limit_L:=SQL_Limits_AL{$Loc_L}Else End case $Loc_L:=$Loc_L+1Until (SQL_Limit_L>0) | ($Loc_L>Size of array(SQL_Limits_AL))Else SQL_Limit_L:=SQL_Limits_AL{$Loc_L}End if If (SQL_Limit_L=0)SQL_Limit_L:=1End if End if C_TEXT($SelectFields_txt;$UpdateFields_txt;$BindToVariable_txt;$FieldName_txt)$TableName_txt:="["+Table name($TableNumber_l)+"]."C_BOOLEAN($Indexed_b;$Unique_b;$Included_b)For ($Loop_l;1;$ACTLastFieldNumber_l)If (Is field number valid($TableNumber_l;$Loop_l))GET FIELD PROPERTIES($TableNumber_l;$Loop_l;$FieldType_l;$Length_l;$Indexed_b;$Unique_b)Case of : ($FieldType_l=Is BLOB ): ($FieldType_l=7)Else ut_SQLReturnFromFileForSQL ($TableNumber_l;$Loop_l;->$FieldName_txt;->$BindToVariable_txt)If ($UseArrays_b)$BindToVariable_txt:=Replace string($BindToVariable_txt;"_txt";"_atxt")$BindToVariable_txt:=Replace string($BindToVariable_txt;"_L";"_aL")$BindToVariable_txt:=Replace string($BindToVariable_txt;"_r";"_ar")$BindToVariable_txt:=Replace string($BindToVariable_txt;"_tm";"_aL")$BindToVariable_txt:=Replace string($BindToVariable_txt;"_d";"_ad")$BindToVariable_txt:=Replace string($BindToVariable_txt;"_b";"_ab")$BindToVariable_txt:=Replace string($BindToVariable_txt;"_p";"_ap")End if If ($FieldName_txt#"")If ($FieldType_l=Is Time )$FieldName_txt:=" CAST ("+$FieldName_txt+" AS INT)"End if If ($SelectFields_txt="")$SelectFields_txt:=$FieldName_txt$UpdateFields_txt:=":"+$BindToVariable_txtElse $SelectFields_txt:=$SelectFields_txt+", "+Char(Carriage return )+$FieldName_txt$UpdateFields_txt:=$UpdateFields_txt+", "+Char(Carriage return )+":"+$BindToVariable_txtEnd if End if End case End if End for $2->:=$SelectFields_txt$3->:=$UpdateFields_txt  `End ut_CloneSetUpSelectInto