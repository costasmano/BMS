ÊÊ` Method: TNL_SIAInpForm_FMÊÊ` DescriptionÊÊ` Method for the Tunnel Inventory Input FormÊÊ` ÊÊ` ParametersÊÊ` $1 : $FormEvent_LÊÊ` ----------------------------------------------------If (False)ÊÊ` User name (OS): Costas ManousakisÊÊ` User name (4D): DesignerÊÊ` Date and time: 04/12/13, 12:42:20ÊÊ` ----------------------------------------------------ÊÊ` First ReleaseMods_2013_04 ÊÊ` Modified by: Costas Manousakis-(Designer)-(11/8/13 12:55:37)Mods_2013_11 ÊÊ`ÊÊ`Added code to catch changes in the  [Bridge MHD NBIS] tableÊÊ` Modified by: Costas Manousakis-(Designer)-(11/13/13 14:39:00)Mods_2013_11 ÊÊ`ÊÊ`if Item 92vb and 93c are 'blank' hide that stuffEnd if C_LONGINT($FormEvent_L)If (Count parameters>0)C_LONGINT($1)$FormEvent_L:=$1Else $FormEvent_L:=Form eventEnd if Case of : ($FormEvent_L=On Data Change )C_LONGINT($TunnelFlds_L;$FldLoop_L;$TunnelTbl_L)$TunnelFlds_L:=Get last field number(->[TunnelInfo])$TunnelTbl_L:=Table(->[TunnelInfo])C_POINTER($TunnelFld_ptr)For ($FldLoop_L;1;$TunnelFlds_L)$TunnelFld_ptr:=Field($TunnelTbl_L;$FldLoop_L)If ($TunnelFld_ptr->#Old($TunnelFld_ptr->))PushChange (2;$TunnelFld_ptr)End if End for $TunnelFlds_L:=Get last field number(->[Bridge MHD NBIS])$TunnelTbl_L:=Table(->[Bridge MHD NBIS])C_POINTER($TunnelFld_ptr)For ($FldLoop_L;1;$TunnelFlds_L)$TunnelFld_ptr:=Field($TunnelTbl_L;$FldLoop_L)If ($TunnelFld_ptr->#Old($TunnelFld_ptr->))PushChange (1;$TunnelFld_ptr)End if End for : ($FormEvent_L=On Load )InitChangeStack (1)ÊÊ`bridge mhd nbisInitChangeStack (2)ÊÊ`tunnel infoIf (Is new record([TunnelInfo]))[TunnelInfo]BIN:=[Bridge MHD NBIS]BIN[TunnelInfo]CreatedBy_s:=×CurrentUser_Name[TunnelInfo]CreatedTimeStamp_s:=FN_Date2DateTime (Current date(*);Current time(*))PushChange (2;->[TunnelInfo]CreatedBy_s)PushChange (2;->[TunnelInfo]CreatedTimeStamp_s)End if If (([Bridge MHD NBIS]Item92CB=0)Ê&Ê([Bridge MHD NBIS]Item93C=!00/00/00!))SET VISIBLE(*;"NBIItem93C@";False)End if : ($FormEvent_L=On Validate )If (Modified record([Bridge MHD NBIS]))[Bridge MHD NBIS]Modified By:=×CurrentUser_Name[Bridge MHD NBIS]DateModified:=Current date(*)[Bridge MHD NBIS]TimeModified:=Current time(*)PushChange (1;->[Bridge MHD NBIS]Modified By)PushChange (1;->[Bridge MHD NBIS]DateModified)PushChange (1;->[Bridge MHD NBIS]TimeModified)FlushGrpChgs (1;->[Bridge MHD NBIS]BIN;->[Bridge MHD NBIS]BIN;->[Bridge MHD NBIS]BIN;0)SAVE RECORD([Bridge MHD NBIS])End if If (Is new record([TunnelInfo]))LogNewRecord (->[TunnelInfo]BIN;->[TunnelInfo]BIN;->[TunnelInfo]BIN;0;"")End if If (Modified record([TunnelInfo]))[TunnelInfo]ModifiedBy_s:=×CurrentUser_Name[TunnelInfo]ModifiedTimeStamp_s:=FN_Date2DateTime (Current date(*);Current time(*))PushChange (2;->[TunnelInfo]ModifiedBy_s)PushChange (2;->[TunnelInfo]ModifiedTimeStamp_s)FlushGrpChgs (2;->[TunnelInfo]BIN;->[TunnelInfo]BIN;->[TunnelInfo]BIN;0)SAVE RECORD([TunnelInfo])End if ACCEPT: ($FormEvent_L=On Unload )End case 