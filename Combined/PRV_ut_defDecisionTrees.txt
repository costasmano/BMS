ÊÊ`Method: PRV_ut_defDecisionTreesÊÊ`DescriptionÊÊ`ÊÊ` ParametersÊÊ` ----------------------------------------------------If (False)ÊÊ` ----------------------------------------------------ÊÊ`User name (OS): Costas ManousakisÊÊ`User (4D) : DesignerÊÊ`Date and time: 08/22/12, 08:54:43ÊÊ` ----------------------------------------------------ÊÊ`Created : Mods_2012_08 ÊÊ` Modified by: Costas Manousakis-(Designer)-(9/25/13 15:02:54)Mods_2013_09 ÊÊ`ÊÊ`Copied to DEVEnd if ÊÊ`C_STRING(80;vsforward)C_TEXT($Tree_txt;$RowTree_txt;$TheDom_txt)$Tree_txt:=DOM Create XML Ref("PRV_ADTTable")$RowTree_txt:=DOM Create XML element($Tree_txt;"Row")DOM SET XML ATTRIBUTE($RowTree_txt;"HighLimit";999;"ValueLimit";1)$RowTree_txt:=DOM Create XML element($Tree_txt;"Row")DOM SET XML ATTRIBUTE($RowTree_txt;"HighLimit";4999;"ValueLimit";2)$RowTree_txt:=DOM Create XML element($Tree_txt;"Row")DOM SET XML ATTRIBUTE($RowTree_txt;"HighLimit";9999;"ValueLimit";3)$RowTree_txt:=DOM Create XML element($Tree_txt;"Row")DOM SET XML ATTRIBUTE($RowTree_txt;"HighLimit";19999;"ValueLimit";4)$RowTree_txt:=DOM Create XML element($Tree_txt;"Row")DOM SET XML ATTRIBUTE($RowTree_txt;"HighLimit";999999;"ValueLimit";5)DOM EXPORT TO VAR($Tree_txt;$TheDom_txt)QUERY([Parameters];[Parameters]ParamCode="PRV_ADTTABLE")If (Records in selection([Parameters])=1)If (ut_LoadRecordInteractiveV2 (->[Parameters])=1)[Parameters]Description:=$TheDom_txtLogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)SAVE RECORD([Parameters])End if Else CREATE RECORD([Parameters])[Parameters]ParamCode:="PRV_ADTTABLE"[Parameters]Description:=$TheDom_txtLogNewRecord (->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0;"")LogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)SAVE RECORD([Parameters])End if DOM CLOSE XML($Tree_txt)$Tree_txt:=DOM Create XML Ref("PRV_DetourTable")$RowTree_txt:=DOM Create XML element($Tree_txt;"Row")DOM SET XML ATTRIBUTE($RowTree_txt;"HighLimit";1;"ValueLimit";1)$RowTree_txt:=DOM Create XML element($Tree_txt;"Row")DOM SET XML ATTRIBUTE($RowTree_txt;"HighLimit";3;"ValueLimit";2)$RowTree_txt:=DOM Create XML element($Tree_txt;"Row")DOM SET XML ATTRIBUTE($RowTree_txt;"HighLimit";5;"ValueLimit";3)$RowTree_txt:=DOM Create XML element($Tree_txt;"Row")DOM SET XML ATTRIBUTE($RowTree_txt;"HighLimit";9;"ValueLimit";4)$RowTree_txt:=DOM Create XML element($Tree_txt;"Row")DOM SET XML ATTRIBUTE($RowTree_txt;"HighLimit";999999;"ValueLimit";5)DOM EXPORT TO VAR($Tree_txt;$TheDom_txt)QUERY([Parameters];[Parameters]ParamCode="PRV_DetourTable")If (Records in selection([Parameters])=1)If (ut_LoadRecordInteractiveV2 (->[Parameters])=1)[Parameters]Description:=$TheDom_txtLogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)SAVE RECORD([Parameters])End if Else CREATE RECORD([Parameters])[Parameters]ParamCode:="PRV_DetourTable"[Parameters]Description:=$TheDom_txtLogNewRecord (->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0;"")LogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)SAVE RECORD([Parameters])End if DOM CLOSE XML($Tree_txt)$Tree_txt:=DOM Create XML Ref("PRV_ClassTable")$RowTree_txt:=DOM Create XML element($Tree_txt;"Row")DOM SET XML ATTRIBUTE($RowTree_txt;"CodeList";"09,19";"ValueLimit";1)$RowTree_txt:=DOM Create XML element($Tree_txt;"Row")DOM SET XML ATTRIBUTE($RowTree_txt;"CodeList";"08";"ValueLimit";2)$RowTree_txt:=DOM Create XML element($Tree_txt;"Row")DOM SET XML ATTRIBUTE($RowTree_txt;"CodeList";"07,17";"ValueLimit";3)$RowTree_txt:=DOM Create XML element($Tree_txt;"Row")DOM SET XML ATTRIBUTE($RowTree_txt;"CodeList";"06,16";"ValueLimit";4)$RowTree_txt:=DOM Create XML element($Tree_txt;"Row")DOM SET XML ATTRIBUTE($RowTree_txt;"CodeList";"01,02,03,11,12,14";"ValueLimit";5)DOM EXPORT TO VAR($Tree_txt;$TheDom_txt)QUERY([Parameters];[Parameters]ParamCode="PRV_ClassTable")If (Records in selection([Parameters])=1)If (ut_LoadRecordInteractiveV2 (->[Parameters])=1)[Parameters]Description:=$TheDom_txtLogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)SAVE RECORD([Parameters])End if Else CREATE RECORD([Parameters])[Parameters]ParamCode:="PRV_ClassTable"[Parameters]Description:=$TheDom_txtLogNewRecord (->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0;"")LogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)SAVE RECORD([Parameters])End if DOM CLOSE XML($Tree_txt)$Tree_txt:=DOM Create XML Ref("PRV_FormulaFactors")$RowTree_txt:=DOM Create XML element($Tree_txt;"ADTFactor")DOM SET XML ELEMENT VALUE($RowTree_txt;0.3333333)$RowTree_txt:=DOM Create XML element($Tree_txt;"DetourFactor")DOM SET XML ELEMENT VALUE($RowTree_txt;0.3333333)$RowTree_txt:=DOM Create XML element($Tree_txt;"ClassFactor")DOM SET XML ELEMENT VALUE($RowTree_txt;0.3333333)$RowTree_txt:=DOM Create XML element($Tree_txt;"EmergReplPoints")DOM SET XML ELEMENT VALUE($RowTree_txt;2)$RowTree_txt:=DOM Create XML element($Tree_txt;"ActiveRRPoints")DOM SET XML ELEMENT VALUE($RowTree_txt;2)$RowTree_txt:=DOM Create XML element($Tree_txt;"EvacRoutePoints")DOM SET XML ELEMENT VALUE($RowTree_txt;1)$RowTree_txt:=DOM Create XML element($Tree_txt;"EmergReplFactor")DOM SET XML ELEMENT VALUE($RowTree_txt;1)$RowTree_txt:=DOM Create XML element($Tree_txt;"ActiveRRFactor")DOM SET XML ELEMENT VALUE($RowTree_txt;1)$RowTree_txt:=DOM Create XML element($Tree_txt;"EvacRouteFactor")DOM SET XML ELEMENT VALUE($RowTree_txt;1)$RowTree_txt:=DOM Create XML element($Tree_txt;"HWYEvalFactor")DOM SET XML ELEMENT VALUE($RowTree_txt;(0.6*2))$RowTree_txt:=DOM Create XML element($Tree_txt;"OtherFactor")DOM SET XML ELEMENT VALUE($RowTree_txt;(0.4*2))DOM EXPORT TO VAR($Tree_txt;$TheDom_txt)QUERY([Parameters];[Parameters]ParamCode="PRV_FormulaFactors")If (Records in selection([Parameters])=1)If (ut_LoadRecordInteractiveV2 (->[Parameters])=1)[Parameters]Description:=$TheDom_txtLogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)SAVE RECORD([Parameters])End if Else CREATE RECORD([Parameters])[Parameters]ParamCode:="PRV_FormulaFactors"[Parameters]Description:=$TheDom_txtLogNewRecord (->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0;"")LogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)SAVE RECORD([Parameters])End if DOM CLOSE XML($Tree_txt)C_TEXT($Recomment_txt)$Tree_txt:=DOM Create XML Ref("PRV_Recommend")$RowTree_txt:=DOM Create XML element($Tree_txt;"Choise")$Recomment_txt:="Use Conventional/Traditional construction method"DOM SET XML ELEMENT VALUE($RowTree_txt;$Recomment_txt)$RowTree_txt:=DOM Create XML element($Tree_txt;"Choise")$Recomment_txt:="Strongly Consider Prefab. Construction and/or Accelerated Procurement Methods"DOM SET XML ELEMENT VALUE($RowTree_txt;$Recomment_txt)$RowTree_txt:=DOM Create XML element($Tree_txt;"Choise")$Recomment_txt:="Strongly Consider Accelerated Construction Techniques (ABC) and/or Procurement Methods (i.e. SPMT, Heavy Lift Cranes, Sliding, etc.)"DOM SET XML ELEMENT VALUE($RowTree_txt;$Recomment_txt)DOM EXPORT TO VAR($Tree_txt;$TheDom_txt)QUERY([Parameters];[Parameters]ParamCode="PRV_Recommend")If (Records in selection([Parameters])=1)If (ut_LoadRecordInteractiveV2 (->[Parameters])=1)[Parameters]Description:=$TheDom_txtLogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)SAVE RECORD([Parameters])End if Else CREATE RECORD([Parameters])[Parameters]ParamCode:="PRV_Recommend"[Parameters]Description:=$TheDom_txtLogNewRecord (->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0;"")LogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)SAVE RECORD([Parameters])End if DOM CLOSE XML($Tree_txt)C_LONGINT($color_L)$Tree_txt:=DOM Create XML Ref("PRV_AssignColors")$RowTree_txt:=DOM Create XML element($Tree_txt;"Color")$color_L:=16776960$color_L:=Select RGB Color($color_L;"Yellow")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Yellow";"Value";$color_L)$RowTree_txt:=DOM Create XML element($Tree_txt;"Color")$color_L:=16748288$color_L:=Select RGB Color($color_L;"Orange")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Orange";"Value";$color_L)$RowTree_txt:=DOM Create XML element($Tree_txt;"Color")$color_L:=16726073$color_L:=Select RGB Color($color_L;"Red")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Red";"Value";$color_L)$RowTree_txt:=DOM Create XML element($Tree_txt;"Color")$color_L:=65280$color_L:=Select RGB Color($color_L;"Green")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Green";"Value";$color_L)$RowTree_txt:=DOM Create XML element($Tree_txt;"Color")$color_L:=16777215$color_L:=Select RGB Color($color_L;"None")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"None";"Value";$color_L)DOM EXPORT TO VAR($Tree_txt;$TheDom_txt)QUERY([Parameters];[Parameters]ParamCode="PRV_AssignColors")If (Records in selection([Parameters])=1)If (ut_LoadRecordInteractiveV2 (->[Parameters])=1)[Parameters]Description:=$TheDom_txtLogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)SAVE RECORD([Parameters])End if Else CREATE RECORD([Parameters])[Parameters]ParamCode:="PRV_AssignColors"[Parameters]Description:=$TheDom_txtLogNewRecord (->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0;"")LogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)SAVE RECORD([Parameters])End if DOM CLOSE XML($Tree_txt)$Tree_txt:=DOM Create XML Ref("PRV_ProjectStatus")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Initial Field visit done")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Initial Scope & Estimate done")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Waiting for PRC approval")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Waiting for field visit with Consultant")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Waiting for Consultant Scope & Estimate")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Waiting for 25% Review by Dist.")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Waiting for 25% Dists Review Comments by Pres. Reviewer")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Waiting for 75-90%")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Waiting for 75-90% Review by Dist.")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Waiting for 75-90% Dist's Review Comments by Pres. Reviewer")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Waiting for FHWA Apporval")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Waiting for Final PS&E")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Waiting for Final PS&E Review by District")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Waiting for Final PS&E Review by Pres. Reviewer")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Waiting for Mylar")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Waiting for Advertisement")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Advertised")$RowTree_txt:=DOM Create XML element($Tree_txt;"Status")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Other:")DOM EXPORT TO VAR($Tree_txt;$TheDom_txt)QUERY([Parameters];[Parameters]ParamCode="PRV_ProjectStatus")If (Records in selection([Parameters])=1)If (ut_LoadRecordInteractiveV2 (->[Parameters])=1)[Parameters]Description:=$TheDom_txtLogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)SAVE RECORD([Parameters])End if Else CREATE RECORD([Parameters])[Parameters]ParamCode:="PRV_ProjectStatus"[Parameters]Description:=$TheDom_txtLogNewRecord (->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0;"")LogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)SAVE RECORD([Parameters])End if DOM CLOSE XML($Tree_txt)$Tree_txt:=DOM Create XML Ref("PRV_LateActions")$RowTree_txt:=DOM Create XML element($Tree_txt;"Action")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"EMailed DBE")$RowTree_txt:=DOM Create XML element($Tree_txt;"Action")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Emailed P.M.")$RowTree_txt:=DOM Create XML element($Tree_txt;"Action")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Emailed Preservation Reviewer")$RowTree_txt:=DOM Create XML element($Tree_txt;"Action")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Emailed Scoping Engineer")$RowTree_txt:=DOM Create XML element($Tree_txt;"Action")DOM SET XML ATTRIBUTE($RowTree_txt;"Name";"Other:")DOM EXPORT TO VAR($Tree_txt;$TheDom_txt)QUERY([Parameters];[Parameters]ParamCode="PRV_LateActions")If (Records in selection([Parameters])=1)If (ut_LoadRecordInteractiveV2 (->[Parameters])=1)[Parameters]Description:=$TheDom_txtLogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)SAVE RECORD([Parameters])End if Else CREATE RECORD([Parameters])[Parameters]ParamCode:="PRV_LateActions"[Parameters]Description:=$TheDom_txtLogNewRecord (->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0;"")LogChanges (->[Parameters]Description;->[Parameters]ParamCode;->[Parameters]ParamCode;->[Parameters]ParamCode;0)SAVE RECORD([Parameters])End if DOM CLOSE XML($Tree_txt)ÊÊ`End PRV_ut_defDecisionTrees