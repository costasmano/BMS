If (False)ÊÊ` ----------------------------------------------------ÊÊ` User name (OS): costasmanousakisÊÊ` User name (4D): DesignerÊÊ` Date and time: 05/18/06, 12:34:10ÊÊ` ----------------------------------------------------ÊÊ` Method: INSP_SortbyBDEPTÊÊ` DescriptionÊÊ` Sort a list of inspections by BDEPTÊÊ` ÊÊ` ParametersÊÊ` $1 : Sort order : Integer (value of sort button)ÊÊ` ----------------------------------------------------Mods_2006_CM04 ÊÊ` Modified by: costasmanousakis-(Designer)-(8/13/08 12:15:27)Mods_2008_CM_5404 ÊÊ`ÊÊ`Removed the call to SHORT_MESSAGE for more than 500 records.ÊÊ`ÊÊ`in preparation for 2004 conversionÊÊ` Modified by: Costas Manousakis-(Designer)-(10/31/13 15:55:58)Mods_2013_10 ÊÊ`ÊÊ`loop thru the aPtrSortOrder  array to set the other sort variables to 0End if C_INTEGER($1;$SortOrder_I)$SortOrder_I:=$1If (Records in selection([Inspections])>0)SET CURSOR(128)SET AUTOMATIC RELATIONS(True;True)ARRAY LONGINT($RecordNumber_al;0)ARRAY STRING(6;$Bdept_as;0)SELECTION TO ARRAY([Inspections];$RecordNumber_al;[Bridge MHD NBIS]BDEPT;$Bdept_as)If (($SortOrder_I=0)Ê|Ê($SortOrder_I=1))SORT ARRAY($Bdept_as;$RecordNumber_al)Else SORT ARRAY($Bdept_as;$RecordNumber_al;<)End if CREATE SELECTION FROM ARRAY([Inspections];$RecordNumber_al;"SelectedInspecctions")USE NAMED SELECTION("SelectedInspecctions")CLEAR NAMED SELECTION("SelectedInspecctions")ARRAY LONGINT($RecordNumber_al;0)ARRAY STRING(6;$Bdept_as;0)If (Type(aPtrSortOrder)=Pointer array )C_LONGINT($loop_L)For ($loop_L;1;Size of array(aPtrSortOrder))aPtrSortOrder{$loop_L}->:=0End for End if ARRAY POINTER(aPtrSortField;0)ARRAY POINTER(aPtrSortOrder;0)vbSortedHeader:=TrueSET CURSOR(0)End if 