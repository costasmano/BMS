  `Method: PRV_AddNewAssignment  `Description  `  ` Parameters  ` ----------------------------------------------------If (False)  ` ----------------------------------------------------  `User name (OS): Costas Manousakis  `User (4D) : Designer  `Date and time: 02/11/13, 08:22:37  ` ----------------------------------------------------  `Created : Mods_2013_02   ` Modified by: Costas Manousakis-(Designer)-(9/25/13 15:02:54)Mods_2013_09   `  `Copied to DEVEnd if   `CREATE SET([Contract_Assignment_Maintenance];"PRV_PREADDRECORD")INPUT FORM([Contract_Assignment_Maintenance];"PreservationInput")PRV_Variables ("INIT")CREATE RECORD([Contract_Assignment_Maintenance])Inc_Sequence ("AssignMaint";->[Contract_Assignment_Maintenance]AssignID)C_LONGINT($WinID_L)$WinID_L:=Open form window([Contract_Assignment_Maintenance];"PRVAddAssignment")DIALOG([Contract_Assignment_Maintenance];"PRVAddAssignment")CLOSE WINDOW($WinID_L)If (OK=1)SAVE RECORD([Contract_Assignment_Maintenance])ut_LoadRecord (->[Contract_Assignment_Maintenance])MODIFY RECORD([Contract_Assignment_Maintenance])If (OK=1)C_LONGINT($CurrRecID_L;$RecOrder_L)ADD TO SET([Contract_Assignment_Maintenance];"PRV_PREADDRECORD")$CurrRecID_L:=Record number([Contract_Assignment_Maintenance])USE SET("PRV_PREADDRECORD")ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByBRGINFO_s ("BDEPT");>)LB_SetWindowTitle   `this one clears the SelectedRecordsSetLB_ClearHeaders ARRAY LONGINT($AllRecIDs_aL;Records in selection([Contract_Assignment_Maintenance]))SELECTION TO ARRAY([Contract_Assignment_Maintenance];$AllRecIDs_aL)$RecOrder_L:=Find in array($AllRecIDs_aL;$CurrRecID_L)ARRAY LONGINT($AllRecIDs_aL;0)GOTO SELECTED RECORD([Contract_Assignment_Maintenance];$RecOrder_L)SELECT LISTBOX ROW(*;"SelectListBox";Selected record number([Contract_Assignment_Maintenance]);Replace listbox selection )ADD TO SET([Contract_Assignment_Maintenance];"SelectedRecordsSet")SCROLL LINES(*;"SelectListBox";Selected record number([Contract_Assignment_Maintenance]))REDRAW(SelectListBox)End if End if CLEAR SET("PRV_PREADDRECORD")  `End PRV_AddNewAssignment