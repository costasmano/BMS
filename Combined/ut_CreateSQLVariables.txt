  ` ----------------------------------------------------  ` User name (OS): Charles Miller  ` Date and time: 04/20/10, 16:10:40  ` ----------------------------------------------------  ` Method: ut_CreateSQLVariables  ` Description  `   `  ` Parameters  ` ----------------------------------------------------  `None  ` Modified by: Charles Miller (4/20/10)If (False)Mods_OPNToSQLUpgrade   `4D Open to SQL conversion  `Modified by: Charles Miller (8/11/10 11:06:12)   ` Modified by: Costas Manousakis-(Designer)-(5/4/12 11:17:42)Mods_2012_05   `  `Save the text files to a selected folder and name the files  ` Modified by: Costas Manousakis-(Designer)-(1/14/13 10:01:19)Mods_2013_01   `  `Added the complete 'wrapper' code as part of generated method text.  ` Modified by: Costas Manousakis-(Designer)-(2/7/13 08:38:47)Mods_2013_02   `  `Added complete method code including comments and date of update.  `  `Also can update the methods themselves   ` Modified by: Costas Manousakis-(Designer)-(3/13/13 09:44:36)Mods_2013_03   `  `Decreased the limit of the text variable to 20000 from 25000 to avoid reaching the limit of a text var before adding the info for a table  `Clone_ArrayToSelection   `Clear_FieldVariables   `Compiler_FieldVariables Mods_2013_09   `r001 `  Changes in cloning to use arrays whenever possible  `Modified by: Charles Miller (9/10/13 13:06:19)End if C_TEXT($TableName_txt;$VariablePrefix_txt;$VariableName_txt;$ArrayToSelect_txt)C_STRING(1;$Comment_s)$Comment_s:="`"C_LONGINT($TableLoop_l;$FieldLoop_l;$Type_l;$Length_l)C_TEXT($CompilerDocument_txt;$ClearDocument_txt)C_BOOLEAN($CaseMade_b;$Indexed_b;$Unique_b;$Invisible_b)C_BOOLEAN($FIRST_b)$FIRST_b:=TrueARRAY TEXT($CompiilerOuput_atxt;0)ARRAY TEXT($ClearOuput_atxt;0)ARRAY TEXT($ArrayToSelectOuput_atxt;0)C_STRING(2;$QuoteMark_s)$QuoteMark_s:=Char(34)$CompilerDocument_txt:=""$ClearDocument_txt:=""For ($TableLoop_l;1;Get last table number)$ArrayToSelect_txt:=""If (Is table number valid($TableLoop_l))$TableName_txt:=Table name($TableLoop_l)ARRAY TEXT($BooleanVariables_atxt;0)ARRAY TEXT($LongVariables_atxt;0)ARRAY TEXT($RealVariables_atxt;0)ARRAY TEXT($DateVariables_atxt;0)ARRAY TEXT($TextVariables_atxt;0)ARRAY TEXT($TimeVariables_atxt;0)ARRAY TEXT($BlobVariables_atxt;0)ARRAY TEXT($PictureVariables_atxt;0)ARRAY TEXT($IntegerVariables_atxt;0)ARRAY TEXT($Unique_atxt;0)C_TEXT($UniqueSelection_txt)C_TEXT($FirstArray_txt)$VariablePrefix_txt:="v_"+String($TableLoop_l)+"_"For ($FieldLoop_l;1;Get last field number($TableLoop_l))If (Is field number valid($TableLoop_l;$FieldLoop_l))$VariableName_txt:=$VariablePrefix_txt+String($FieldLoop_l;"000")GET FIELD PROPERTIES($TableLoop_l;$FieldLoop_l;$Type_l;$Length_l;$Indexed_b;$Unique_b;$Invisible_b)If ($Unique_b)APPEND TO ARRAY($Unique_atxt;$VariableName_txt)End if Case of : ($Type_l=Is Alpha Field ) | ($Type_l=Is Text )APPEND TO ARRAY($TextVariables_atxt;$VariableName_txt): ($Type_l=Is Real )APPEND TO ARRAY($RealVariables_atxt;$VariableName_txt): ($Type_l=Is Integer )  ` APPEND TO ARRAY($LongVariables_atxt;$VariableName_txt)APPEND TO ARRAY($IntegerVariables_atxt;$VariableName_txt): ($Type_l=Is LongInt )APPEND TO ARRAY($LongVariables_atxt;$VariableName_txt): ($Type_l=Is Date )APPEND TO ARRAY($DateVariables_atxt;$VariableName_txt): ($Type_l=Is Time )APPEND TO ARRAY($TimeVariables_atxt;$VariableName_txt): ($Type_l=Is Boolean )APPEND TO ARRAY($BooleanVariables_atxt;$VariableName_txt): ($Type_l=Is Picture )APPEND TO ARRAY($PictureVariables_atxt;$VariableName_txt): ($Type_l=Is BLOB )APPEND TO ARRAY($BlobVariables_atxt;$VariableName_txt)Else End case End if End for C_TEXT($FinalName_txt;$ArraytoSelectionsDoc_txt;$CaseArrayLine_txt)If ($FIRST_b)$CompilerDocument_txt:=$CompilerDocument_txt+"   ` ----------------------------------------------------"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   ` User name (OS): Charles Miller"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   ` Date and time: 05/06/10, 11:58:58"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   ` ----------------------------------------------------"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   ` Method: Compiler_FieldVariables"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   ` Description"+Char(Carriage return )$ArraytoSelectionsDoc_txt:=$CompilerDocument_txt$ArraytoSelectionsDoc_txt:=Replace string($ArraytoSelectionsDoc_txt;"Compiler_FieldVariables";"Clone_ArrayToSelection")$ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+"`This method is used to do array to selection during clone of tables with no Pict and blob fields"+Char(Carriage return )$ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+"If(false)"+Char(Carriage return )+"Mods_"+String(Year of(Current date))+"_"+String(Month of(Current date);"00")+" ` recreated on "+String(Current date;7)+Char(Carriage return )+"end if"+Char(Carriage return )$ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+"C_LONGINT($1)"+Char(Carriage return )+"C_Pointer($Array_Ptr)"+Char(Carriage return )+"Case of"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `This method is used to define variables in a non compiled db"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `It should be recreated any time a new table or field is added or a type is changed"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `Remember to keep the following as a wrapper"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `If (Not(Is compiled mode))"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `If (Count parameters=0)"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `C_LONGINT($Loop_l)"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `For ($Loop_l;1;Get last table number)"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `If (Is table number valid($Loop_l))"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `Compiler_FieldVariables ($Loop_l)"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `end if"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `End for "+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `Else "+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `C_LONGINT($1)"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `End if "+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+" "+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   ` Parameters"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   ` ----------------------------------------------------"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `$1 table number"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+" "+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   ` Modified by: Charles Miller (5/6/10)"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+" If (False)"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"   `Modified by: Charles Miller (8/11/10 11:06:44) "+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+" ` Updated by "+Current method name+" on "+String(Current date)+" - "+String(Current time)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+" End if "+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+" ` "+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"If (Count parameters=0)"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"C_LONGINT($Loop_l)"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"For ($Loop_l;1;Get last table number)"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"If (Is table number valid($Loop_l))"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"Compiler_FieldVariables ($Loop_l)"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"End if "+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"End for "+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"Else "+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"C_LONGINT($1)"+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"CASE OF"+Char(Carriage return )+":($1="+String($TableLoop_l)+")`"+$TableName_txt+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"  ` ----------------------------------------------------"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"  ` User name (OS): Charles Miller"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"  ` Date and time: 05/06/10, 11:56:42"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"  ` ----------------------------------------------------"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"  ` Method: Clear_FieldVariables"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"  ` Description"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"  ` This method is used to clear variable for sql updates"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"  `It should be recreated any time a new table or field is added or a type is changed"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"  `"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"  ` Parameters"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"  ` ----------------------------------------------------"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"  `$1 is the table number"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+""+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"  ` Modified by: Charles Miller (5/6/10)"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"If (False)"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"  `Modified by: Charles Miller (8/11/10 11:34:45) "+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+" ` Updated by "+Current method name+" on "+String(Current date)+" - "+String(Current time)+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"End if "+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+" ` "+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"If (Count parameters=0)"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"C_LONGINT($Loop_l)"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"For ($Loop_l;1;Get last table number)"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"If (Is table number valid($Loop_l))"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"Clear_FieldVariables ($Loop_l)"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"End if "+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"End for "+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"Else"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"C_LONGINT($1)"+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+"CASE OF"+Char(Carriage return )+":($1="+String($TableLoop_l)+")`"+$TableName_txt+Char(Carriage return )APPEND TO ARRAY($ArrayToSelectOuput_atxt;$ArraytoSelectionsDoc_txt)$CaseArrayLine_txt:=":($1="+String($TableLoop_l)+")`"+$TableName_txt+Char(Carriage return )$ArraytoSelectionsDoc_txt:=""$FIRST_b:=FalseElse $CompilerDocument_txt:=$CompilerDocument_txt+": ($1="+String($TableLoop_l)+")`"+$TableName_txt+Char(Carriage return )$ClearDocument_txt:=$ClearDocument_txt+":($1="+String($TableLoop_l)+")`"+$TableName_txt+Char(Carriage return )$CaseArrayLine_txt:=":($1="+String($TableLoop_l)+")`"+$TableName_txt+Char(Carriage return )End if C_BOOLEAN($CreateArrays_b;$HasaBlob_b)$CreateArrays_b:=True$HasaBlob_b:=FalseCase of   ` : (Size of array($PictureVariables_atxt)>0): (Size of array($BlobVariables_atxt)>0)$HasaBlob_b:=TrueElse End case C_LONGINT($FieldNumber_l)If (Size of array($TextVariables_atxt)>0)For ($FieldLoop_l;1;Size of array($TextVariables_atxt))If (Length($CompilerDocument_txt)>20000)APPEND TO ARRAY($CompiilerOuput_atxt;$CompilerDocument_txt)$CompilerDocument_txt:=""End if If (Length($ClearDocument_txt)>20000)APPEND TO ARRAY($ClearOuput_atxt;$ClearDocument_txt)$ClearDocument_txt:=""End if $FinalName_txt:=$TextVariables_atxt{$FieldLoop_l}+"_txt"$FieldNumber_l:=Num(Replace string($TextVariables_atxt{$FieldLoop_l};$VariablePrefix_txt;""))$ClearDocument_txt:=$ClearDocument_txt+"CLEAR VARIABLE ("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"C_TEXT("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )If ($CreateArrays_b)$FinalName_txt:=Replace string($FinalName_txt;"_txt";"_atxt")$ClearDocument_txt:=$ClearDocument_txt+"CLEAR VARIABLE ("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"array text("+$FinalName_txt+";0)`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )If (Find in array($Unique_atxt;$TextVariables_atxt{$FieldLoop_l})>0)$UniqueSelection_txt:=$UniqueSelection_txt+$FinalName_txt+";["+$TableName_txt+"]"+Field name($TableLoop_l;$FieldNumber_l)+";"Else $ArrayToSelect_txt:=$ArrayToSelect_txt+$FinalName_txt+";["+$TableName_txt+"]"+Field name($TableLoop_l;$FieldNumber_l)+";"End if If (Length($ArrayToSelect_txt)>1000)$ArrayToSelect_txt:=Substring($ArrayToSelect_txt;1;Length($ArrayToSelect_txt)-1)$ArrayToSelect_txt:=$ArrayToSelect_txt+")"+Char(Carriage return )If (Position("array to selection(";$ArrayToSelect_txt)=1)$ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+$ArrayToSelect_txtElse $ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+"array to selection("+$ArrayToSelect_txtEnd if $ArrayToSelect_txt:=""End if If ($FirstArray_txt="")$FirstArray_txt:=$FinalName_txtEnd if End if End for End if If (Size of array($IntegerVariables_atxt)>0)For ($FieldLoop_l;1;Size of array($IntegerVariables_atxt))If (Length($CompilerDocument_txt)>20000)APPEND TO ARRAY($CompiilerOuput_atxt;$CompilerDocument_txt)$CompilerDocument_txt:=""End if If (Length($ClearDocument_txt)>20000)APPEND TO ARRAY($ClearOuput_atxt;$ClearDocument_txt)$ClearDocument_txt:=""End if $FinalName_txt:=$IntegerVariables_atxt{$FieldLoop_l}+"_l"$FieldNumber_l:=Num(Replace string($IntegerVariables_atxt{$FieldLoop_l};$VariablePrefix_txt;""))$ClearDocument_txt:=$ClearDocument_txt+"CLEAR VARIABLE ("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"C_LONGINT("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )If ($CreateArrays_b)$FinalName_txt:=Replace string($FinalName_txt;"_L";"_aL")$ClearDocument_txt:=$ClearDocument_txt+"CLEAR VARIABLE ("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"array Integer("+$FinalName_txt+";0)`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )If (Find in array($Unique_atxt;$IntegerVariables_atxt{$FieldLoop_l})>0)$UniqueSelection_txt:=$UniqueSelection_txt+$FinalName_txt+";["+$TableName_txt+"]"+Field name($TableLoop_l;$FieldNumber_l)+";"Else $ArrayToSelect_txt:=$ArrayToSelect_txt+$FinalName_txt+";["+$TableName_txt+"]"+Field name($TableLoop_l;$FieldNumber_l)+";"End if If (Length($ArrayToSelect_txt)>1000)$ArrayToSelect_txt:=Substring($ArrayToSelect_txt;1;Length($ArrayToSelect_txt)-1)$ArrayToSelect_txt:=$ArrayToSelect_txt+")"+Char(Carriage return )If (Position("array to selection(";$ArrayToSelect_txt)=1)$ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+$ArrayToSelect_txtElse $ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+"array to selection("+$ArrayToSelect_txtEnd if $ArrayToSelect_txt:=""End if If ($FirstArray_txt="")$FirstArray_txt:=$FinalName_txtEnd if End if End for End if If (Size of array($LongVariables_atxt)>0)For ($FieldLoop_l;1;Size of array($LongVariables_atxt))If (Length($CompilerDocument_txt)>20000)APPEND TO ARRAY($CompiilerOuput_atxt;$CompilerDocument_txt)$CompilerDocument_txt:=""End if If (Length($ClearDocument_txt)>20000)APPEND TO ARRAY($ClearOuput_atxt;$ClearDocument_txt)$ClearDocument_txt:=""End if $FinalName_txt:=$LongVariables_atxt{$FieldLoop_l}+"_l"$FieldNumber_l:=Num(Replace string($LongVariables_atxt{$FieldLoop_l};$VariablePrefix_txt;""))$ClearDocument_txt:=$ClearDocument_txt+"CLEAR VARIABLE ("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"C_LONGINT("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )If ($CreateArrays_b)$FinalName_txt:=Replace string($FinalName_txt;"_L";"_aL")$ClearDocument_txt:=$ClearDocument_txt+"CLEAR VARIABLE ("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"array Longint("+$FinalName_txt+";0)`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )If (Find in array($Unique_atxt;$LongVariables_atxt{$FieldLoop_l})>0)$UniqueSelection_txt:=$UniqueSelection_txt+$FinalName_txt+";["+$TableName_txt+"]"+Field name($TableLoop_l;$FieldNumber_l)+";"Else $ArrayToSelect_txt:=$ArrayToSelect_txt+$FinalName_txt+";["+$TableName_txt+"]"+Field name($TableLoop_l;$FieldNumber_l)+";"End if If (Length($ArrayToSelect_txt)>1000)$ArrayToSelect_txt:=Substring($ArrayToSelect_txt;1;Length($ArrayToSelect_txt)-1)$ArrayToSelect_txt:=$ArrayToSelect_txt+")"+Char(Carriage return )If (Position("array to selection(";$ArrayToSelect_txt)=1)$ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+$ArrayToSelect_txtElse $ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+"array to selection("+$ArrayToSelect_txtEnd if $ArrayToSelect_txt:=""End if If ($FirstArray_txt="")$FirstArray_txt:=$FinalName_txtEnd if End if End for End if If (Size of array($RealVariables_atxt)>0)For ($FieldLoop_l;1;Size of array($RealVariables_atxt))If (Length($CompilerDocument_txt)>20000)APPEND TO ARRAY($CompiilerOuput_atxt;$CompilerDocument_txt)$CompilerDocument_txt:=""End if If (Length($ClearDocument_txt)>20000)APPEND TO ARRAY($ClearOuput_atxt;$ClearDocument_txt)$ClearDocument_txt:=""End if $FinalName_txt:=$RealVariables_atxt{$FieldLoop_l}+"_r"$FieldNumber_l:=Num(Replace string($RealVariables_atxt{$FieldLoop_l};$VariablePrefix_txt;""))$ClearDocument_txt:=$ClearDocument_txt+"CLEAR VARIABLE ("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"C_REAL("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )If ($CreateArrays_b)$FinalName_txt:=Replace string($FinalName_txt;"_r";"_ar")$ClearDocument_txt:=$ClearDocument_txt+"CLEAR VARIABLE ("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"array real("+$FinalName_txt+";0)`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )If (Find in array($Unique_atxt;$RealVariables_atxt{$FieldLoop_l})>0)$UniqueSelection_txt:=$UniqueSelection_txt+$FinalName_txt+";["+$TableName_txt+"]"+Field name($TableLoop_l;$FieldNumber_l)+";"Else $ArrayToSelect_txt:=$ArrayToSelect_txt+$FinalName_txt+";["+$TableName_txt+"]"+Field name($TableLoop_l;$FieldNumber_l)+";"End if If (Length($ArrayToSelect_txt)>1000)$ArrayToSelect_txt:=Substring($ArrayToSelect_txt;1;Length($ArrayToSelect_txt)-1)$ArrayToSelect_txt:=$ArrayToSelect_txt+")"+Char(Carriage return )If (Position("array to selection(";$ArrayToSelect_txt)=1)$ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+$ArrayToSelect_txtElse $ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+"array to selection("+$ArrayToSelect_txtEnd if $ArrayToSelect_txt:=""End if If ($FirstArray_txt="")$FirstArray_txt:=$FinalName_txtEnd if End if End for End if If (Size of array($BooleanVariables_atxt)>0)For ($FieldLoop_l;1;Size of array($BooleanVariables_atxt))If (Length($CompilerDocument_txt)>20000)APPEND TO ARRAY($CompiilerOuput_atxt;$CompilerDocument_txt)$CompilerDocument_txt:=""End if If (Length($ClearDocument_txt)>20000)APPEND TO ARRAY($ClearOuput_atxt;$ClearDocument_txt)$ClearDocument_txt:=""End if $FinalName_txt:=$BooleanVariables_atxt{$FieldLoop_l}+"_b"$FieldNumber_l:=Num(Replace string($BooleanVariables_atxt{$FieldLoop_l};$VariablePrefix_txt;""))$ClearDocument_txt:=$ClearDocument_txt+"CLEAR VARIABLE ("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"C_BOOLEAN("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )If ($CreateArrays_b)$FinalName_txt:=Replace string($FinalName_txt;"_b";"_ab")$ClearDocument_txt:=$ClearDocument_txt+"CLEAR VARIABLE ("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"array boolean("+$FinalName_txt+";0)`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )If (Find in array($Unique_atxt;$BooleanVariables_atxt{$FieldLoop_l})>0)$UniqueSelection_txt:=$UniqueSelection_txt+$FinalName_txt+";["+$TableName_txt+"]"+Field name($TableLoop_l;$FieldNumber_l)+";"Else $ArrayToSelect_txt:=$ArrayToSelect_txt+$FinalName_txt+";["+$TableName_txt+"]"+Field name($TableLoop_l;$FieldNumber_l)+";"End if If (Length($ArrayToSelect_txt)>1000)$ArrayToSelect_txt:=Substring($ArrayToSelect_txt;1;Length($ArrayToSelect_txt)-1)$ArrayToSelect_txt:=$ArrayToSelect_txt+")"+Char(Carriage return )If (Position("array to selection(";$ArrayToSelect_txt)=1)$ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+$ArrayToSelect_txtElse $ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+"array to selection("+$ArrayToSelect_txtEnd if $ArrayToSelect_txt:=""End if If ($FirstArray_txt="")$FirstArray_txt:=$FinalName_txtEnd if End if End for End if If (Size of array($DateVariables_atxt)>0)For ($FieldLoop_l;1;Size of array($DateVariables_atxt))If (Length($CompilerDocument_txt)>20000)APPEND TO ARRAY($CompiilerOuput_atxt;$CompilerDocument_txt)$CompilerDocument_txt:=""End if If (Length($ClearDocument_txt)>20000)APPEND TO ARRAY($ClearOuput_atxt;$ClearDocument_txt)$ClearDocument_txt:=""End if $FinalName_txt:=$DateVariables_atxt{$FieldLoop_l}+"_d"$FieldNumber_l:=Num(Replace string($DateVariables_atxt{$FieldLoop_l};$VariablePrefix_txt;""))$ClearDocument_txt:=$ClearDocument_txt+"CLEAR VARIABLE ("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"C_DATE("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )If ($CreateArrays_b)$FinalName_txt:=Replace string($FinalName_txt;"_d";"_ad")$ClearDocument_txt:=$ClearDocument_txt+"CLEAR VARIABLE ("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"array date("+$FinalName_txt+";0)`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )If (Find in array($Unique_atxt;$DateVariables_atxt{$FieldLoop_l})>0)$UniqueSelection_txt:=$UniqueSelection_txt+$FinalName_txt+";["+$TableName_txt+"]"+Field name($TableLoop_l;$FieldNumber_l)+";"Else $ArrayToSelect_txt:=$ArrayToSelect_txt+$FinalName_txt+";["+$TableName_txt+"]"+Field name($TableLoop_l;$FieldNumber_l)+";"End if If (Length($ArrayToSelect_txt)>1000)$ArrayToSelect_txt:=Substring($ArrayToSelect_txt;1;Length($ArrayToSelect_txt)-1)$ArrayToSelect_txt:=$ArrayToSelect_txt+")"+Char(Carriage return )If (Position("array to selection(";$ArrayToSelect_txt)=1)$ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+$ArrayToSelect_txtElse $ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+"array to selection("+$ArrayToSelect_txtEnd if $ArrayToSelect_txt:=""End if If ($FirstArray_txt="")$FirstArray_txt:=$FinalName_txtEnd if End if End for End if If (Size of array($BlobVariables_atxt)>0)For ($FieldLoop_l;1;Size of array($BlobVariables_atxt))If (Length($CompilerDocument_txt)>20000)APPEND TO ARRAY($CompiilerOuput_atxt;$CompilerDocument_txt)$CompilerDocument_txt:=""End if If (Length($ClearDocument_txt)>20000)APPEND TO ARRAY($ClearOuput_atxt;$ClearDocument_txt)$ClearDocument_txt:=""End if $FinalName_txt:=$BlobVariables_atxt{$FieldLoop_l}+"_blb"$FieldNumber_l:=Num(Replace string($BlobVariables_atxt{$FieldLoop_l};$VariablePrefix_txt;""))$ClearDocument_txt:=$ClearDocument_txt+"SET BLOB SIZE ("+$FinalName_txt+";0)`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"C_BLOB("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )End for End if If (Size of array($PictureVariables_atxt)>0)For ($FieldLoop_l;1;Size of array($PictureVariables_atxt))$FinalName_txt:=$PictureVariables_atxt{$FieldLoop_l}+"_p"$FieldNumber_l:=Num(Replace string($PictureVariables_atxt{$FieldLoop_l};$VariablePrefix_txt;""))$ClearDocument_txt:=$ClearDocument_txt+$FinalName_txt+":="+$FinalName_txt+"*0`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"C_PICTURE("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )If ($CreateArrays_b)$FinalName_txt:=Replace string($FinalName_txt;"_p";"_ap")$ClearDocument_txt:=$ClearDocument_txt+"CLEAR VARIABLE ("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"array picture("+$FinalName_txt+";0)`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )If (Find in array($Unique_atxt;$PictureVariables_atxt{$FieldLoop_l})>0)$UniqueSelection_txt:=$UniqueSelection_txt+$FinalName_txt+";["+$TableName_txt+"]"+Field name($TableLoop_l;$FieldNumber_l)+";"Else $ArrayToSelect_txt:=$ArrayToSelect_txt+$FinalName_txt+";["+$TableName_txt+"]"+Field name($TableLoop_l;$FieldNumber_l)+";"End if If (Length($ArrayToSelect_txt)>1000)$ArrayToSelect_txt:=Substring($ArrayToSelect_txt;1;Length($ArrayToSelect_txt)-1)$ArrayToSelect_txt:=$ArrayToSelect_txt+")"+Char(Carriage return )If (Position("array to selection(";$ArrayToSelect_txt)=1)$ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+$ArrayToSelect_txtElse $ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+"array to selection("+$ArrayToSelect_txtEnd if $ArrayToSelect_txt:=""End if If ($FirstArray_txt="")$FirstArray_txt:=$FinalName_txtEnd if End if End for End if If (Size of array($TimeVariables_atxt)>0)For ($FieldLoop_l;1;Size of array($TimeVariables_atxt))If (Length($CompilerDocument_txt)>20000)APPEND TO ARRAY($CompiilerOuput_atxt;$CompilerDocument_txt)$CompilerDocument_txt:=""End if If (Length($ClearDocument_txt)>20000)APPEND TO ARRAY($ClearOuput_atxt;$ClearDocument_txt)$ClearDocument_txt:=""End if $FinalName_txt:=$TimeVariables_atxt{$FieldLoop_l}+"_tm"$FieldNumber_l:=Num(Replace string($TimeVariables_atxt{$FieldLoop_l};$VariablePrefix_txt;""))$ClearDocument_txt:=$ClearDocument_txt+"CLEAR VARIABLE ("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"C_TIME("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )If ($CreateArrays_b)$FinalName_txt:=Replace string($FinalName_txt;"_tm";"_aL")$ClearDocument_txt:=$ClearDocument_txt+"CLEAR VARIABLE ("+$FinalName_txt+")`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )$CompilerDocument_txt:=$CompilerDocument_txt+"array Longint("+$FinalName_txt+";0)`"+Field name($TableLoop_l;$FieldNumber_l)+Char(Carriage return )If (Find in array($Unique_atxt;$TimeVariables_atxt{$FieldLoop_l})>0)$UniqueSelection_txt:=$UniqueSelection_txt+$FinalName_txt+";["+$TableName_txt+"]"+Field name($TableLoop_l;$FieldNumber_l)+";"Else $ArrayToSelect_txt:=$ArrayToSelect_txt+$FinalName_txt+";["+$TableName_txt+"]"+Field name($TableLoop_l;$FieldNumber_l)+";"End if If (Length($ArrayToSelect_txt)>1000)$ArrayToSelect_txt:=Substring($ArrayToSelect_txt;1;Length($ArrayToSelect_txt)-1)$ArrayToSelect_txt:=$ArrayToSelect_txt+")"+Char(Carriage return )If (Position("array to selection(";$ArrayToSelect_txt)=1)$ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+$ArrayToSelect_txtElse $ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+"array to selection("+$ArrayToSelect_txtEnd if $ArrayToSelect_txt:=""End if If ($FirstArray_txt="")$FirstArray_txt:=$FinalName_txtEnd if End if End for End if C_TEXT($BeginDoc_txt;$ArrayStuff_txt)If ($ArrayToSelect_txt#"")$ArrayStuff_txt:="$Array_Ptr:=->"+$FirstArray_txt+Char(Carriage return )+"If (Size of array($Array_Ptr->)>0)"+Char(Carriage return )  ` `SET TEXT TO PASTEBOARD($ArrayStuff_txt)If ($UniqueSelection_txt#"")$UniqueSelection_txt:=Substring($UniqueSelection_txt;1;Length($UniqueSelection_txt)-1)$UniqueSelection_txt:="Array to selection("+$UniqueSelection_txt+") `Unique keys must come first"+Char(Carriage return )End if   `SET TEXT TO PASTEBOARD($UniqueSelection_txt)$ArrayToSelect_txt:=Substring($ArrayToSelect_txt;1;Length($ArrayToSelect_txt)-1)If (Position("array to selection(";$ArrayToSelect_txt)=1)$ArrayToSelect_txt:=$ArrayToSelect_txt+")"+Char(Carriage return )Else $ArrayToSelect_txt:="array to selection("+$ArrayToSelect_txt+")"+Char(Carriage return )End if If (Size of array($BlobVariables_atxt)>0)$ArrayToSelect_txt:=$ArrayToSelect_txt+"ut_GetBlobs($1)"+Char(Carriage return )End if   `SET TEXT TO PASTEBOARD($ArrayToSelect_txt)$ArrayToSelect_txt:=$ArrayToSelect_txt+"end if"+Char(Carriage return )If ($ArraytoSelectionsDoc_txt="")If (Position("array to selection";$ArrayToSelect_txt)=1)$ArraytoSelectionsDoc_txt:=$CaseArrayLine_txt+$ArrayStuff_txt+$BeginDoc_txt+$UniqueSelection_txt+$ArrayToSelect_txt+Char(Carriage return )Else $ArraytoSelectionsDoc_txt:=$CaseArrayLine_txt+$ArrayStuff_txt+$BeginDoc_txt+$UniqueSelection_txt+"array to selection("+$ArrayToSelect_txt+Char(Carriage return )End if   `SET TEXT TO PASTEBOARD($ArraytoSelectionsDoc_txt)Else If (Position("array to selection";$ArraytoSelectionsDoc_txt)=1)Else $ArraytoSelectionsDoc_txt:="array to selection("+$ArraytoSelectionsDoc_txtEnd if   `SET TEXT TO PASTEBOARD($ArraytoSelectionsDoc_txt)If (Position("array to selection";$ArrayToSelect_txt)=1)$ArraytoSelectionsDoc_txt:=$CaseArrayLine_txt+$ArrayStuff_txt+$BeginDoc_txt+$UniqueSelection_txt+$ArraytoSelectionsDoc_txt+$ArrayToSelect_txtElse $ArraytoSelectionsDoc_txt:=$CaseArrayLine_txt+$ArrayStuff_txt+$BeginDoc_txt+$UniqueSelection_txt+$ArraytoSelectionsDoc_txt+"array to selection("+$ArrayToSelect_txtEnd if   `SET TEXT TO PASTEBOARD($ArraytoSelectionsDoc_txt)End if $FirstArray_txt:=""$UniqueSelection_txt:=""APPEND TO ARRAY($ArrayToSelectOuput_atxt;$ArraytoSelectionsDoc_txt)$ArraytoSelectionsDoc_txt:=""$ArrayToSelect_txt:=""Else End if APPEND TO ARRAY($CompiilerOuput_atxt;$CompilerDocument_txt)$CompilerDocument_txt:=""APPEND TO ARRAY($ClearOuput_atxt;$ClearDocument_txt)$ClearDocument_txt:=""End if End for $ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+Char(Carriage return )+"End case"+Char(Carriage return )$ArraytoSelectionsDoc_txt:=$ArraytoSelectionsDoc_txt+"if (size of array($Array_Ptr->)#SQL_Limit_