  ` Method: LB_ProcessContracAssigns  ` Description  `   `   ` Parameters  ` $0 : $Result_L  ` $1 : $FormEvent_L  ` ----------------------------------------------------If (False)  ` User name (OS): Costas Manousakis  ` User name (4D): Designer  ` Date and time: 06/12/12, 08:27:23  ` ----------------------------------------------------  ` First ReleaseMods_2012_06   ` Modified by: Costas Manousakis-(Designer)-(9/25/13 15:02:54)Mods_2013_09   `  `Copied to DEVEnd if C_LONGINT($0)$0:=0C_LONGINT($FormEvent_L)If (Count parameters>0)C_LONGINT($1)$FormEvent_L:=$1Else $FormEvent_L:=Form eventEnd if Case of : ($FormEvent_L=On Close Detail ): ($FormEvent_L=On Display Detail )PRV_Variables ("RELATEBRIDGEINFO")LB_Detail4_txt:=PRV_Dist_txtLB_Detail5_txt:=PRV_BDEPT_txtLB_Detail6_txt:=PRV_OverUnder_txtPRV_Variables ("RELATEPINFO")LB_Detail7_txt:=PRV_ProjDescr_txtLB_Detail8_txt:=PRV_ProjMgr_txtLB_Detail9_txt:=PRV_SortByPINFO_txt ("PROJCONS";False)  `C_TEXT($phone_txt)  `LB_Detail10_txt:=""  `PERS_GetInfo ([Contract_Assignment_Maintenance]ProjectManagerID_L;"FULLNAME";->LB_Detail10_txt;"PHONE";->$phone_txt)  `If ($phone_txt#"")  `LB_Detail10_txt:=LB_Detail10_txt+" ("+$phone_txt+")"  `End if LB_Detail10_txt:=PRV_SortByPINFO_txt ("PRESREVIEWER";False)  `LB_Detail11_d:=PRV_SchedAdDate_d  `If (PRV_ActualAdDate_d#!00/00/00!)  `LB_Detail11_d:=PRV_ActualAdDate_d  `End if LB_Detail11_d:=PRV_SortByPINFO_d ("ADDATE";False)LB_Detail13_txt:=PRV_OnOff_txt  `Bridge InfoLB_Detail16_txt:=[Contract_Assignment_Maintenance]LateAction_s+" "+String([Contract_Assignment_Maintenance]LateActionDate_d;Blank if null date )  `Action Taken: ($FormEvent_L=On Header Click )C_TEXT($NameofObj_txt)C_LONGINT($dumTbl_L;$dumFld_L)RESOLVE POINTER(Self;$NameofObj_txt;$dumTbl_L;$dumFld_L)Case of : ($nameofObj_txt="LB_Header4_l")If (LB_SortDirection4_l=0)ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByBRGINFO_s ("DIST");>)LB_SortDirection4_l:=1Self->:=1Else ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByBRGINFO_s ("DIST");<)LB_SortDirection4_l:=0Self->:=2End if $0:=-1: ($nameofObj_txt="LB_Header5_l")If (LB_SortDirection5_l=0)ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByBRGINFO_s ("BDEPT");>)LB_SortDirection5_l:=1Self->:=1Else ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByBRGINFO_s ("BDEPT");<)LB_SortDirection5_l:=0Self->:=2End if $0:=-1: ($nameofObj_txt="LB_Header6_l")If (LB_SortDirection6_l=0)ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByBRGINFO_s ("OVERUNDER");>)LB_SortDirection6_l:=1Self->:=1Else ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByBRGINFO_s ("OVERUNDER");<)LB_SortDirection6_l:=0Self->:=2End if $0:=-1: ($nameofObj_txt="LB_Header7_l")If (LB_SortDirection7_l=0)ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByPINFO_txt ("PROJDESC");>)LB_SortDirection7_l:=1Self->:=1Else ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByPINFO_txt ("PROJDESC");<)LB_SortDirection7_l:=0Self->:=2End if $0:=-1: ($nameofObj_txt="LB_Header8_l")If (LB_SortDirection8_l=0)ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByPINFO_txt ("PROJMGR");>)LB_SortDirection8_l:=1Self->:=1Else ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByPINFO_txt ("PROJMGR");<)LB_SortDirection8_l:=0Self->:=2End if $0:=-1: ($nameofObj_txt="LB_Header9_l")If (LB_SortDirection9_l=0)ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByPINFO_txt ("PROJCONS");>)LB_SortDirection9_l:=1Self->:=1Else ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByPINFO_txt ("PROJCONS");<)LB_SortDirection9_l:=0Self->:=2End if $0:=-1: ($nameofObj_txt="LB_Header10_l")If (LB_SortDirection10_l=0)ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByPINFO_txt ("PRESREVIEWER");>)LB_SortDirection10_l:=1Self->:=1Else ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByPINFO_txt ("PRESREVIEWER");<)LB_SortDirection10_l:=0Self->:=2End if $0:=-1: ($nameofObj_txt="LB_Header11_l")If (LB_SortDirection11_l=0)ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByPINFO_d ("ADDATE");>)LB_SortDirection11_l:=1Self->:=1Else ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByPINFO_d ("ADDATE");<)LB_SortDirection11_l:=0Self->:=2End if $0:=-1: ($nameofObj_txt="LB_Header13_l")If (LB_SortDirection13_l=0)ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByBRGINFO_s ("ONOFF");>)LB_SortDirection13_l:=1Self->:=1Else ORDER BY FORMULA([Contract_Assignment_Maintenance];PRV_SortByBRGINFO_s ("ONOFF");<)LB_SortDirection13_l:=0Self->:=2End if $0:=-1: ($nameofObj_txt="LB_Header14_l")If (LB_SortDirection14_l=0)ORDER BY FORMULA([Contract_Assignment_Maintenance];Find in array(PRV_ProjectStatus_atxt;[Contract_Assignment_Maintenance]ProjectStatus_s);>)LB_SortDirection14_l:=1Self->:=1Else ORDER BY FORMULA([Contract_Assignment_Maintenance];Find in array(PRV_ProjectStatus_atxt;[Contract_Assignment_Maintenance]ProjectStatus_s);<)LB_SortDirection14_l:=0Self->:=2End if $0:=-1: ($nameofObj_txt="LB_Header16_l")If (LB_SortDirection16_l=0)ORDER BY FORMULA([Contract_Assignment_Maintenance];Find in array(PRV_LateAction_atxt;[Contract_Assignment_Maintenance]LateAction_s);>)LB_SortDirection16_l:=1Self->:=1Else ORDER BY FORMULA([Contract_Assignment_Maintenance];Find in array(PRV_LateAction_atxt;[Contract_Assignment_Maintenance]LateAction_s);<)LB_SortDirection16_l:=0Self->:=2End if $0:=-1End case : ($FormEvent_L=On Double Clicked )C_LONGINT($LBCol_L;$LBRow_L)  `ALERT("doubleClicked on "+$LBName_txt)GET LISTBOX CELL POSITION(*;"SelectListBox";$LBCol_L;$LBRow_L)C_BOOLEAN($ReSetWinBox_b)If ($LBRow_L>0)C_LONGINT($FM_W_L;$FM_W_H;$W_L_L;$W_T_L;$W_R_L;$W_B_L;$W_W_L;$W_H_L)GET WINDOW RECT($W_L_L;$W_T_L;$W_R_L;$W_B_L)$W_W_L:=$W_R_L-$W_L_L$W_H_L:=$W_B_L-$W_T_LGET FORM PROPERTIES([Contract_Assignment_Maintenance];"PreservationInput";$FM_W_L;$FM_W_H)$ReSetWinBox_b:=FalseC_LONGINT($WL_L;$WT_L;$WR_L;$WB_L;$OL_L;$OT_L;$OR_L;$OB_L)C_LONGINT($ForDesVertMar_L;$BotBtnVertMar_L;$LBVertMar_L)GET OBJECT RECT(*;"ForDesigner@";$OL_L;$OT_L;$OR_L;$OB_L)$ForDesVertMar_L:=$W_H_L-$OB_LGET OBJECT RECT(*;"BottomBtn_@";$OL_L;$OT_L;$OR_L;$OB_L)$BotBtnVertMar_L:=$W_H_L-$OB_LGET OBJECT RECT(*;"SelectListBox@";$OL_L;$OT_L;$OR_L;$OB_L)$LBVertMar_L:=$W_H_L-$OB_LIf (($FM_W_L>$W_W_L) | ($FM_W_H>$W_H_L))SET WINDOW RECT($W_L_L;$W_T_L;$W_L_L+MaxNum ($FM_W_L;$W_W_L);$W_T_L+MaxNum ($FM_W_H;$W_H_L))$ReSetWinBox_b:=TrueEnd if INPUT FORM([Contract_Assignment_Maintenance];"PreservationInput")GOTO SELECTED RECORD([Contract_Assignment_Maintenance];$LBRow_L)If ((GRP_UserInGroup ("PreservationEdit")=1) | User in group(Current user;"Design Access Group"))C_LONGINT($LoadRecord_L)$LoadRecord_L:=ut_LoadRecordInteractiveV2 (->[Contract_Assignment_Maintenance])Case of : ($LoadRecord_L=1)PRV_LockedAssignment_b:=FalseMODIFY RECORD([Contract_Assignment_Maintenance]): ($LoadRecord_L=2)PRV_LockedAssignment_b:=TrueREAD ONLY([Contract_Assignment_Maintenance])DIALOG([Contract_Assignment_Maintenance];"PreservationInput")End case Else PRV_LockedAssignment_b:=TrueREAD ONLY([Contract_Assignment_Maintenance])DIALOG([Contract_Assignment_Maintenance];"PreservationInput")End if If (Record number([Contract_Assignment_Maintenance])>0)SELECT LISTBOX ROW(*;"SelectListBox";Selected record number([Contract_Assignment_Maintenance]);Replace listbox selection )SCROLL LINES(*;"SelectListBox";Selected record number([Contract_Assignment_Maintenance]))Else   `deleted a recordARRAY LONGINT($RecordNumbers_aL;Records in selection([Contract_Assignment_Maintenance]))SELECTION TO ARRAY([Contract_Assignment_Maintenance];$RecordNumbers_aL)C_LONGINT($loop_L)For ($loop_L;Size of array($RecordNumbers_aL);1;-1)If ($RecordNumbers_aL{$loop_L}<=0)DELETE FROM ARRAY($RecordNumbers_aL;$loop_L;1)End if End for CREATE SELECTION FROM ARRAY([Contract_Assignment_Maintenance];$RecordNumbers_aL)LB_SetWindowTitle   `this one clears the SelectedRecordSetEnd if ut_Send2Clipboard ("Obje event before set size "+ut_ReturnTimeStampFromDate (Current date(*);Current time(*))+Char(13))GET WINDOW RECT($WL_L;$WT_L;$WR_L;$WB_L)ut_Send2Clipboard ("W : "+String($WL_L)+" ; "+String($WT_L)+" ; "+String($WR_L)+" ; "+String($WB_L)+Char(13))GET OBJECT RECT(*;"SelectListBox";$OL_L;$OT_L;$OR_L;$OB_L)ut_Send2Clipboard ("LB : "+String($OL_L)+" ; "+String($OT_L)+" ; "+String($OR_L)+" ; "+String($OB_L)+Char(13))GET OBJECT RECT(*;"ForDesigner@";$OL_L;$OT_L;$OR_L;$OB_L)ut_Send2Clipboard ("ForDes : "+String($OL_L)+" ; "+String($OT_L)+" ; "+String($OR_L)+" ; "+String($OB_L)+Char(13))GET OBJECT RECT(*;"BottomBtn_@";$OL_L;$OT_L;$OR_L;$OB_L)ut_Send2Clipboard ("Buttons  : "+String($OL_L)+" ; "+String($OT_L)+" ; "+String($OR_L)+" ; "+String($OB_L)+Char(13))SET WINDOW RECT($W_L_L;$W_T_L;$W_L_L+MaxNum ($FM_W_L;$W_W_L);$W_T_L+$W_H_L)ut_Send2Clipboard ("Obje event after set size "+ut_ReturnTimeStampFromDate (Current date(*);Current time(*))+Char(13))GET WINDOW RECT($WL_L;$WT_L;$WR_L;$WB_L)ut_Send2Clipboard ("W : "+String($WL_L)+" ; "+String($WT_L)+" ; "+String($WR_L)+" ; "+String($WB_L)+Char(13))GET OBJECT RECT(*;"SelectListBox";$OL_L;$OT_L;$OR_L;$OB_L)ut_Send2Clipboard ("LB  before resize :"+String($OL_L)+" ; "+String($OT_L)+" ; "+String($OR_L)+" ; "+String($OB_L)+Char(13))C_LONGINT($LBResize;$BottObjMove_L)$LBResize:=($WB_L-$WT_L)-$LBVertMar_L-$OB_LMOVE OBJECT(*;"SelectListBox";0;0;0;$LBResize)GET OBJECT RECT(*;"SelectListBox";$OL_L;$OT_L;$OR_L;$OB_L)ut_Send2Clipboard ("LB  after resize :"+String($OL_L)+" ; "+String($OT_L)+" ; "+String($OR_L)+" ; "+String($OB_L)+Char(13))GET OBJECT RECT(*;"ForDesigner@";$OL_L;$OT_L;$OR_L;$OB_L)ut_Send2Clipboard ("ForDes before move : "+String($OL_L)+" ; "+String($OT_L)+" ; "+String($OR_L)+" ; "+String($OB_L)+Char(13))$BottObjMove_L:=($WB_L-$WT_L)-$ForDesVertMar_L-$OB_LMOVE OBJECT(*;"ForDesigner@";0;$BottObjMove_L;0;0)GET OBJECT RECT(*;"ForDesigner@";$OL_L;$OT_L;$OR_L;$OB_L)ut_Send2Clipboard ("ForDes after move : "+String($OL_L)+" ; "+String($OT_L)+" ; "+String($OR_L)+" ; "+String($OB_L)+Char(13))GET OBJECT RECT(*;"BottomBtn_@";$OL_L;$OT_L;$OR_L;$OB_L)ut_Send2Clipboard ("Buttons before move : "+String($OL_L)+" ; "+String($OT_L)+" ; "+String($OR_L)+" ; "+String($OB_L)+Char(13))$BottObjMove_L:=($WB_L-$WT_L)-$BotBtnVertMar_L-$OB_LMOVE OBJECT(*;"BottomBtn_@";0;$BottObjMove_L;0;0)GET OBJECT RECT(*;"BottomBtn_@";$OL_L;$OT_L;$OR_L;$OB_L)ut_Send2Clipboard ("Buttons after move : "+String($OL_L)+" ; "+String($OT_L)+" ; "+String($OR_L)+" ; "+String($OB_L)+Char(13))REDRAW(SelectListBox)End if : ($FormEvent_L=On Clicked )C_LONGINT($LBCol_L;$LBRow_L;$SelectedRow_L;$Ret_L;$MinRet_L;$MaxRet_L)  `ALERT("doubleClicked on "+$LBName_txt)GET LISTBOX CELL POSITION(*;"SelectListBox";$LBCol_L;$LBRow_L)If ($LBRow_L>0)If ((Right click) | (Macintosh control down))READ ONLY([Contract_Assignment_Maintenance])GOTO SELECTED RECORD([Contract_Assignment_Maintenance];$LBRow_L)LOAD RECORD([Contract_Assignment_Maintenance])$SelectedRow_L:=Find in array(PRV_ProjectColors_atxt;[Contract_Assignment_Maintenance]ProjectColor_s)$MinRet_L:=3$MaxRet_L:=2+Size of array(PRV_ProjectColors_atxt)If ($SelectedRow_L>0)$SelectedRow_L:=$SelectedRow_L+2Else $SelectedRow_L:=0End if C_LONGINT($Ret_L)$Ret_L:=Pop up menu(PRV_ColorMenuPopup_txt;$SelectedRow_L)If (($Ret_L>=$MinRet_L) & ($Ret_L<=$MaxRet_L))$Ret_L:=$Ret_L-2If (Records in set("SelectedRecordsSet")=1)If (ut_LoadRecordInteractive (->[Contract_Assignment_Maintenance]))[Contract_Assignment_Maintenance]ProjectColor_s:=PRV_ProjectColors_atxt{$Ret_L}LogChanges (->[Contract_Assignment_Maintenance]ProjectColor_s;->[Contract_Maintenance]ContractID;->[Contract_Assignment_Maintenance]ContractNo;->[Contract_Assignment_Maintenance]AssignID;1)SAVE RECORD([Contract_Assignment_Maintenance])End if Else FIRST RECORD([Contract_Assignment_Maintenance])While (Not(End selection([Contract_Assignment_Maintenance])))If (Is in set("SelectedRecordsSet"))If (ut_LoadRecordInteractive (->[Contract_Assignment_Maintenance]))[Contract_Assignment_Maintenance]ProjectColor_s:=PRV_ProjectColors_atxt{$Ret_L}LogChanges (->[Contract_Assignment_Maintenance]ProjectColor_s;->[Contract_Maintenance]ContractID;->[Contract_Assignment_Maintenance]ContractNo;->[Contract_Assignment_Maintenance]AssignID;1)SAVE RECORD([Contract_Assignment_Maintenance])End if End if NEXT RECORD([Contract_Assignment_Maintenance])End while SELECT LISTBOX ROW(*;"SelectListBox";0;Remove from listbox selection )End if REDRAW(SelectListBox)End if End if End if : ($FormEvent_L=On Load )SET AUTOMATIC RELATIONS(False;False)C_LONGINT($ColumnNumber_l)C_TEXT($ColumnName_txt)SET LISTBOX TABLE SOURCE(*;"SelectListBox";Table(->[Contract_Assignment_Maintenance]))C_POINTER($HeaderVar_ptr;$ColumnVar_ptr)C_TEXT($HeaderVarName_txt)  `Column 1$ColumnNumber_l:=1LB_SetUPFieldColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$HeaderVar_ptr;->$ColumnName_txt)INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;[Contract_Assignment_Maintenance]ProjectIS;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(*;$HeaderVarName_txt;"File No.")SET ALIGNMENT(*;$ColumnName_txt;Center )  `Column 2$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPFieldColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$HeaderVar_ptr;->$ColumnName_txt)INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;[Contract_Assignment_Maintenance]ContractNo;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(*;$HeaderVarName_txt;"Contract")SET ALIGNMENT(*;$ColumnName_txt;Center )  `Column 3$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPFieldColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$HeaderVar_ptr;->$ColumnName_txt)INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;[Contract_Assignment_Maintenance]AssignNo;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(*;$HeaderVarName_txt;"Assignment")SET ALIGNMENT(*;$ColumnName_txt;Center )  `Column 5$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPVariableColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$ColumnVar_ptr;->$HeaderVar_ptr;->$ColumnName_txt;"txt")INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;$ColumnVar_ptr->;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(*;$HeaderVarName_txt;"Dist.")SET ALIGNMENT(*;$ColumnName_txt;Center )  `Column 5$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPVariableColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$ColumnVar_ptr;->$HeaderVar_ptr;->$ColumnName_txt;"txt")INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;$ColumnVar_ptr->;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(*;$HeaderVarName_txt;"Bridge No.")SET ALIGNMENT(*;$ColumnName_txt;Align left )  `Column 6$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPVariableColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$ColumnVar_ptr;->$HeaderVar_ptr;->$ColumnName_txt;"txt")INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;$ColumnVar_ptr->;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(*;$HeaderVarName_txt;"Location")  `SET ALIGNMENT(*;$ColumnName_txt;Center )  `Column 7$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPVariableColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$ColumnVar_ptr;->$HeaderVar_ptr;->$ColumnName_txt;"txt")INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;$ColumnVar_ptr->;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(*;$HeaderVarName_txt;"Project Description")  `SET ALIGNMENT(*;$ColumnName_txt;Center )  `Column 8$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPVariableColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$ColumnVar_ptr;->$HeaderVar_ptr;->$ColumnName_txt;"txt")INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;$ColumnVar_ptr->;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(*;$HeaderVarName_txt;"Boston P.M.")  `Column 9$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPVariableColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$ColumnVar_ptr;->$HeaderVar_ptr;->$ColumnName_txt;"txt")INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;$ColumnVar_ptr->;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(*;$HeaderVarName_txt;"Designer")  `  `Column 10$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPVariableColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$ColumnVar_ptr;->$HeaderVar_ptr;->$ColumnName_txt;"txt")INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;$ColumnVar_ptr->;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(*;$HeaderVarName_txt;"Preservation Reviewer")  `  `Column 11$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPVariableColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$ColumnVar_ptr;->$HeaderVar_ptr;->$ColumnName_txt;"d")INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;$ColumnVar_ptr->;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(*;$HeaderVarName_txt;"Ad Date")SET ALIGNMENT(*;$ColumnName_txt;Center )SET FORMAT(*;$ColumnName_txt;Char(System date short +Blank if null date ))  `  `Column 12$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPFieldColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$HeaderVar_ptr;->$ColumnName_txt)INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;[Contract_Assignment_Maintenance]Funding_s;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(*;$HeaderVarName_txt;"FA/NFA")SET ALIGNMENT(*;$ColumnName_txt;Center )  `  `Column 13$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPVariableColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$ColumnVar_ptr;->$HeaderVar_ptr;->$ColumnName_txt;"txt")INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;$ColumnVar_ptr->;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(*;$HeaderVarName_txt;"Item26")SET ALIGNMENT(*;$ColumnName_txt;Center )  `  `Column 14$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPFieldColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$HeaderVar_ptr;->$ColumnName_txt)INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;[Contract_Assignment_Maintenance]ProjectStatus_s;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(*;$HeaderVarName_txt;"Status")  `Column 15$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPVariableColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$ColumnVar_ptr;->$HeaderVar_ptr;->$ColumnName_txt;"d")INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;[Contract_Assignment_Maintenance]DeadLine_d;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(*;$HeaderVarName_txt;"Deadline")SET ALIGNMENT(*;$ColumnName_txt;Center )SET FORMAT(*;$ColumnName_txt;Char(System date short +Blank if null date ))  `Column 16$ColumnNumber_l:=$ColumnNumber_l+1LB_SetUPVariableColumn ($ColumnNumber_l;->$HeaderVarName_txt;->$ColumnVar_ptr;->$HeaderVar_ptr;->$ColumnName_txt;"txt")INSERT LISTBOX COLUMN(*;"SelectListBox";$ColumnNumber_l;$ColumnName_txt;$ColumnVar_ptr->;$HeaderVarName_txt;$HeaderVar_ptr->)BUTTON TEXT(*;$HeaderVarName_txt;"Action Taken")  `FONT SIZE(*;"LB_Header@";11)FONT STYLE(*;"LB_Header@";Bold )SET ENTERABLE(*;"Column_@";False)  `$ColumnNumber_l:=Get listbox rows height(*;"SelectListBox")  `SET LISTBOX ROWS HEIGHT(*;"SelectListBox";$ColumnNumber_l*2)PRV_Variables ("INIT"): ($FormEvent_L=On Unload ): ($FormEvent_L=On Resize )C_LONGINT($WL_L;$WT_L;$WR_L;$WB_L;$OL_L;$OT_L;$OR_L;$OB_L)GET WINDOW RECT($WL_L;$WT_L;$WR_L;$WB_L)If (False)ut_Send2Clipboard ("Object event "+ut_ReturnTimeStampFromDate (Current date(*);Current time(*))+Char(13))ut_Send2Clipboard ("W : "+String($WL_L)+" ; "+String($WT_L)+" ; "+String($WR_L)+" ; "+String($WB_L)+Char(13))GET OBJECT RECT(*;"SelectListBox";$OL_L;$OT_L;$OR_L;$OB_L)ut_Send2Clipboard ("LB : "+String($OL_L)+" ; "+String($OT_L)+" ; "+String($OR_L)+" ; "+String($OB_L)+Char(13))GET OBJECT RECT(*;"ForDesigner@";$OL_L;$OT_L;$OR_L;$OB_L)ut_Send2Clipboard ("ForDes : "+String($OL_L)+" ; "+String($OT_L)+" ; "+String($OR_L)+" ; "+String($OB_L)+Char(13))End if End case   `End LB_ProcessContracAssigns