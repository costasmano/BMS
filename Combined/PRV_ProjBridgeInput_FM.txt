ÊÊ` Method: PRV_ProjBridgeInput_FMÊÊ` DescriptionÊÊ` ÊÊ` ÊÊ` ParametersÊÊ` $1 : $FormEvent_LÊÊ` ----------------------------------------------------If (False)ÊÊ` User name (OS): Costas ManousakisÊÊ` User name (4D): DesignerÊÊ` Date and time: 06/07/12, 17:31:10ÊÊ` ----------------------------------------------------ÊÊ` First ReleaseMods_2012_06 ÊÊ` Modified by: Costas Manousakis-(Designer)-(9/25/13 15:02:54)Mods_2013_09 ÊÊ`ÊÊ`Copied to DEVEnd if C_LONGINT($FormEvent_L)If (Count parameters>0)C_LONGINT($1)$FormEvent_L:=$1Else $FormEvent_L:=Form eventEnd if C_LONGINT(PRV_GETBRIDGEBININFO_L)PRV_GETBRIDGEBININFO_L:=15002Case of : ($FormEvent_L=On Close Detail ): ($FormEvent_L=On Load )If (Is new record([Contract_Project_Maintenance]))If ([Contract_Assignment_Maintenance]AssignID=0)CANCELElse Inc_Sequence ("ProjMaint";->[Contract_Project_Maintenance]ProjectID)ÊÊ`initialize all variables[Contract_Project_Maintenance]ContractNo:=[Contract_Assignment_Maintenance]ContractNo[Contract_Project_Maintenance]AssignNo:=[Contract_Assignment_Maintenance]AssignNo[Contract_Project_Maintenance]AssignID:=[Contract_Assignment_Maintenance]AssignID[Contract_Project_Maintenance]Project Type:=""[Contract_Project_Maintenance]BIN:=""vBridgeNo:=""vDistrict:=""vTown:=""vLocation:=""End if Else vBridgeNo:=[Contract_Project_Maintenance]BridgeNovDistrict:=[Contract_Project_Maintenance]DistrictvTown:=[Contract_Project_Maintenance]TownvLocation:=[Contract_Project_Maintenance]LocationIf ([Contract_Project_Maintenance]BridgeNo="Various")SET ENTERABLE([Contract_Project_Maintenance]BIN;False)SET COLOR([Contract_Project_Maintenance]BIN;×color_not_editable)SET ENTERABLE([Contract_Project_Maintenance]Town;True)SET ENTERABLE([Contract_Project_Maintenance]District;True)SET ENTERABLE([Contract_Project_Maintenance]Location;True)SET COLOR([Contract_Project_Maintenance]Town;×color_editable)SET COLOR([Contract_Project_Maintenance]District;×color_editable)SET COLOR([Contract_Project_Maintenance]Location;×color_editable)End if End if If (PRV_LockedAssignment_b)SET ENTERABLE(*;"@";False)SET COLOR(*;"@";×color_not_editable)SET VISIBLE(*;"DE@btn";False)End if PRV_CTRLListBoxes ("INSPECT"): ($FormEvent_L=On Validate ): ($FormEvent_L=On Unload ): ($FormEvent_L=PRV_GETBRIDGEBININFO_L)vBridgeNo:=[Bridge MHD NBIS]BDEPT[Contract_Project_Maintenance]Location:=[Bridge MHD NBIS]Item7+" / "+[Bridge MHD NBIS]Item6A[Contract_Project_Maintenance]Location:=Replace string([Contract_Project_Maintenance]Location;"OTHER";"")[Contract_Project_Maintenance]Location:=Replace string([Contract_Project_Maintenance]Location;"WATER";"")[Contract_Project_Maintenance]Location:=Replace string([Contract_Project_Maintenance]Location;"HWY  ";"")[Contract_Project_Maintenance]Location:=Replace string([Contract_Project_Maintenance]Location;"RR   ";"")[Contract_Project_Maintenance]Location:=Replace string([Contract_Project_Maintenance]Location;"TR   ";"")[Contract_Project_Maintenance]Location:=Replace string([Contract_Project_Maintenance]Location;"COMB ";"")C_LONGINT($DblSpacePos_L)$DblSpacePos_L:=Position("  ";[Contract_Project_Maintenance]Location)While ($DblSpacePos_L>0)[Contract_Project_Maintenance]Location:=Replace string([Contract_Project_Maintenance]Location;"  ";" ")$DblSpacePos_L:=Position("  ";[Contract_Project_Maintenance]Location)End while [Contract_Project_Maintenance]Location:=f_TrimStr ([Contract_Project_Maintenance]Location;True;True)[Contract_Project_Maintenance]Location:=f_CapitalizeTxt ([Contract_Project_Maintenance]Location)[Contract_Project_Maintenance]District:=[Bridge MHD NBIS]Item2[Contract_Project_Maintenance]Town:=[Bridge MHD NBIS]Town NameEnd case 