  ` Method: M_SearchPontisElmts  ` Description  ` Copied from M_SearchDefElement  `  ` Parameters  ` ----------------------------------------------------If (False)  ` ----------------------------------------------------  ` User name (OS): costasmanousakis  ` User name (4D): Designer  ` Date and time: 09/10/05, 19:59:18  ` ----------------------------------------------------Mods_2005_CM17   ` Modified by: costasmanousakis-(Designer)-(4/4/08 17:00:33)Mods_2008_CM_5403   `Apply sort  ` Modified by: Costas Manousakis-(Designer)-(11/1/13 13:26:10)Mods_2013_11   `  `Added  option to open a new window with the result set of cond unitsEnd if C_LONGINT(elmtSrchStateStat;elmtSrchPCatStat;elmtSrchQtyStat;elmtSrchEnvStat;cbOpenList)C_LONGINT($vlWinW;$vlWinHt)READ ONLY([BMS Inspections])READ ONLY([Cond Units])READ ONLY([BMS Elements])READ ONLY([BMS Categories])READ ONLY([Inspections])READ ONLY([Combined Inspections])COPY NAMED SELECTION([Bridge MHD NBIS];"StartSearch")SRCP_LoadElmArrays (True)SRCP_LoadElmCat GET FORM PROPERTIES([Dialogs];"SearchPontisElmts";$vlWinW;$vlWinHt)CENTER_WINDOW ($vlWinW;$vlWinHt;Movable dialog box )DIALOG([Dialogs];"SearchPontisElmts")CLOSE WINDOWelmtSrchStateStat:=cbElmtStateelmtSrchPCatStat:=cbPonElementCatelmtSrchQtyStat:=cbElmtQtyelmtSrchEnvStat:=cbElmtEnvIf (Ok=1)If (Records in set("Random Set")=0)If ((vElmtStateOp#"") | (cboElmtState>0))CreateRandomSetForPontisElmt USE SET("Random Set")End if Else USE SET("Random Set")End if REDRAW WINDOWC_TEXT(GEN_SORTLISTCMD_txt)If (GEN_SORTLISTCMD_txt#"")EXECUTE FORMULA(GEN_SORTLISTCMD_txt)End if RegionTitle If (cbPrintNow=1)C_TEXT($msg)$msg:="Print Reports for "+String(Records in selection([Bridge MHD NBIS]))+" BIN records ?"CONFIRM($msg)If (OK=1)M_PontisElementRpt End if End if If (cbOpenList=1)C_TEXT($NamedSelectionName_txt;$ProcessName_txt;$Seq_txt;$WinTitle_txt;$QueryName_txt)$ProcessName_txt:="CondUnitLB"$NamedSelectionName_txt:="◊CondUnitSelect"$WinTitle_txt:="Bridge Elements"$QueryName_txt:="CondUnitsQuery1"C_POINTER($Tbl_ptr)$Tbl_ptr:=->[Cond Units]C_LONGINT($pid)$Seq_txt:=String(LNextView ($ProcessName_txt)+1)$ProcessName_txt:=$ProcessName_txt+" "+$Seq_txt$NamedSelectionName_txt:=$NamedSelectionName_txt+"_"+$Seq_txt$WinTitle_txt:=$WinTitle_txt+" ["+$Seq_txt+"]"USE SET("TotalElmtsFound")COPY NAMED SELECTION($Tbl_ptr->;$NamedSelectionName_txt)$pid:=New Process("LB_ControlListBoxDisplay";256*1024;$ProcessName_txt;$QueryName_txt;Table($Tbl_ptr);$WinTitle_txt;$NamedSelectionName_txt)End if Else USE NAMED SELECTION("StartSearch")End if CLEAR NAMED SELECTION("StartSearch")CLEAR SET("Random Set")CLEAR SET("TotalElmtsFound")  ` set of elements found.G_CloseAllTables (->[Bridge MHD NBIS])  `Release all tables except the main one.READ WRITE([BMS Inspections])READ WRITE([Cond Units])READ WRITE([BMS Elements])READ WRITE([BMS Categories])READ WRITE([Inspections])READ WRITE([Combined Inspections])RegionTitle 