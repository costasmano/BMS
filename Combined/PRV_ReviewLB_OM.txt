  ` Method: PRV_ReviewLB_OM  ` Description  `   `   ` Parameters  ` $1 : $FormEvent_L  ` ----------------------------------------------------If (False)  ` User name (OS): Costas Manousakis  ` User name (4D): Designer  ` Date and time: 06/04/12, 15:54:39  ` ----------------------------------------------------  ` First ReleaseMods_2012_06   ` Modified by: Costas Manousakis-(Designer)-(9/25/13 15:02:54)Mods_2013_09   `  `Copied to DEVEnd if C_LONGINT($FormEvent_L)C_TEXT($LBName_txt)C_LONGINT($1)$FormEvent_L:=$1C_TEXT($2)$LBName_txt:=$2C_POINTER($3;$Tbl_ptr)$Tbl_ptr:=$3C_TEXT($4;$FormName_txt)$FormName_txt:=$4Case of : ($FormEvent_L=On Load ): ($FormEvent_L=On Data Change ): ($FormEvent_L=On Clicked ): ($FormEvent_L=On Display Detail )Case of : ($LBName_txt="INVOICES")  `Variable LB_Detail5_r total TLFLB_INVOICES_Det05_r:=[Invoice_Maintenance]TotalLimFeeConstr+[Invoice_Maintenance]TotalLimFeeDesLB_INVOICES_Det07_r:=[Invoice_Maintenance]TotalLimFeeConstr+[Invoice_Maintenance]TotalLimFeeDes+[Invoice_Maintenance]DirectExpensesEnd case : ($FormEvent_L=On Double Clicked )C_TEXT($LBName_txt;$SetName_txt;PRV_NEWREVIEWTYPE_s;$LBSelection_txt)C_LONGINT($Dumm_L;$LBCol_L;$LBRow_L;$LbTableNum_L)  `ALERT("doubleClicked on "+$LBName_txt)PRV_NEWREVIEWTYPE_s:=$LBName_txt$SetName_txt:="PRV_"+$LBName_txt+"_HS"$LBName_txt:="PRV_"+$LBName_txt+"_LB"If (Records in set($SetName_txt)>0)GET LISTBOX TABLE SOURCE(*;$LBName_txt;$LbTableNum_L;$LBSelection_txt)If ($LBSelection_txt#"")USE NAMED SELECTION($LBSelection_txt)End if GET LISTBOX CELL POSITION(*;$LBName_txt;$LBCol_L;$LBRow_L)If ($LBRow_L>0)GOTO SELECTED RECORD($Tbl_ptr->;$LBRow_L)INPUT FORM($Tbl_ptr->;$FormName_txt)If (Read only state([Contract_Assignment_Maintenance]))READ ONLY($Tbl_ptr->)LOAD RECORD($Tbl_ptr->)DIALOG($Tbl_ptr->;$FormName_txt)Else C_LONGINT($LoadRecResult_L)$LoadRecResult_L:=ut_LoadRecordInteractiveV2 ($Tbl_ptr)Case of : ($LoadRecResult_L=1)MODIFY RECORD($Tbl_ptr->): ($LoadRecResult_L=2)LOAD RECORD($Tbl_ptr->)DIALOG($Tbl_ptr->;$FormName_txt)End case End if PRV_CTRLSelections (PRV_NEWREVIEWTYPE_s)Case of : ((PRV_NEWREVIEWTYPE_s="ADDENDUMS") | (PRV_NEWREVIEWTYPE_s="INVOICES"))PRV_Variables ("TOTALCOSTS")PRV_Variables ("TOTALHRS")Else PRV_Variables ("SUMM"+PRV_NEWREVIEWTYPE_s)End case End if Else   `ALERT("Nothing")End if End case   `End PRV_ReviewLB_OM