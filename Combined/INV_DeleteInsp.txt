If (False)  ` ----------------------------------------------------  ` User name (OS): costasmanousakis  ` User name (4D): Designer  ` Date and time: 10/27/06, 19:48:33  ` ----------------------------------------------------  ` Method: INV_DeleteInsp  ` Description  ` Delete an Inventory inspection  `   ` Parameters  ` ----------------------------------------------------Mods_2007_CM02   ` Modified by: CJMiller-(Designer)-(8/12/13 )Mods_2013_08   `  `Added  parameter to  skip canceling out of the current formEnd if C_BOOLEAN($1;$CancelForm_b)$CancelForm_b:=$1C_TEXT($msg)C_LONGINT($numPhotos_L)$numPhotos_L:=Records in selection([InventoryPhotos])Case of : ($numPhotos_L>1)$msg:=" and "+String($numPhotos_L)+" photos": ($numPhotos_L=1)$msg:=" and "+String($numPhotos_L)+" photo"Else End case $msg:="Delete this Inventory Photo Inspection"+$msg+"?"CONFIRM($msg;"Delete")If (OK=1)  `First delete related photosIf (Not(Is new record([InventoryPhotoInsp])))FIRST RECORD([InventoryPhotos])While (Not(End selection([InventoryPhotos])))PushGrpDelete (->[InventoryPhotos]InvPhoto_ID)NEXT RECORD([InventoryPhotos])End while FlushGrpDeletions (->[InventoryPhotoInsp]InvPhotoInspID_L;->[InventoryPhotos]InvPhotoInsp_ID;->[InventoryPhotos]InvPhotoInsp_ID;2)DELETE SELECTION([InventoryPhotos])LogDeletion (->[Bridge MHD NBIS]BIN;->[InventoryPhotoInsp]BIN;->[InventoryPhotoInsp]InvPhotoInspID_L;1)DELETE RECORD([InventoryPhotoInsp])VALIDATE TRANSACTIONIf ($CancelForm_b)CANCELEnd if Else   `just cancel trans if new recordIf ($CancelForm_b)CANCELEnd if CANCEL TRANSACTIONEnd if End if 