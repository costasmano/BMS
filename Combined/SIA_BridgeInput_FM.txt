If (False)ÊÊ` ----------------------------------------------------ÊÊ` User name (OS): costasmanousakisÊÊ` User name (4D): DesignerÊÊ` Date and time: 02/15/10, 11:30:43ÊÊ` ----------------------------------------------------ÊÊ` Method: SIA_BridgeInput_FMÊÊ` DescriptionÊÊ`ÊÊ` Method for the [Bridge MHD NBIS];"Bridge Input" formÊÊ` ÊÊ` ParametersÊÊ` $1 : $FormEvent_L (Optional)ÊÊ` ----------------------------------------------------Mods_2010_02 ÊÊ` Modified by: costasmanousakis-(Administrator)-(4/5/10 12:36:40)Mods_2010_04 ÊÊ`ÊÊ`Added Variable $currUser_txt; Also allow users in BMS Admin to override the MDC restrictions ÊÊ` Modified by: costasmanousakis-(Designer)-(9/2/10 15:47:54)Mods_2010_09 ÊÊ`ÊÊ`Use method BMSUtil_BelongToBridge for MDC usersÊÊ` Modified by: costasmanousakis-(Designer)-(1/18/11 15:22:49)Mods_2011_01 ÊÊ`` Rail Road changesÊÊ` Modified by: costasmanousakis-(Designer)-(6/6/11 14:18:28)Mods_2011_06 ÊÊ`ÊÊ`After the On Load release any other records loaded during the load eventÊÊ` Modified by: Costas Manousakis-(Designer)-(5/9/12 11:04:06)Mods_2012_05 ÊÊ`ÊÊ`Changed method of adjusting window size. Now the size is adjusted in the on  load form method of the input form.ÊÊ`ÊÊ`sized back to the original in the close detail of this form. keep track by setting a variable in the On Open Detail of the ÊÊ`ÊÊ`Output formMods_2013_02 ÊÊ`r001 ` Add [ScourCriticalInfo] to maintain new table recordsÊÊ`Modified by: Charles Miller (2/12/13 13:16:23)Mods_2013_03 ÊÊ`r001 ` Add code to display correct headings on forms based upon [Bridge MHD NBIS]InspRespÊÊ`Modified by: Charles Miller (3/12/13 11:55:46)ÊÊ` Modified by: Costas Manousakis-(Designer)-(3/18/13 14:00:22)Mods_2013_03 ÊÊ`ÊÊ`Added code to enable MBTA users access to Rail Info buttonÊÊ` Modified by: Costas Manousakis-(Designer)-(5/16/13 10:19:01)Mods_2013_05 ÊÊ`ÊÊ`Added cases for Tunnel  recordsÊÊ` Modified by: Costas Manousakis-(Designer)-(10/21/13 10:19:23)Mods_2013_10 ÊÊ`ÊÊ`Include BLD records for TunnelsÊÊ` Modified by: Costas Manousakis-(Designer)-(10/28/13 10:00:07)Mods_2013_10 ÊÊ`ÊÊ`Allow Ext designers and inspectors access to the SIA button ÊÊ` Modified by: Costas Manousakis-(Designer)-(11/6/13 16:22:47)Mods_2013_11 ÊÊ`ÊÊ`Fixed bug in hiding the ScourCritical button when there is a record in the tableEnd if C_LONGINT($FormEvent_L)If (Count parameters>0)C_LONGINT($1)$FormEvent_L:=$1Else $FormEvent_L:=Form eventEnd if Case of : ($FormEvent_L=On Load )Case of : ([Bridge MHD NBIS]InspResp="MBTA")SET VISIBLE(*;"MBTAText@";True)SET VISIBLE(*;"NonMBTAText@";False)Else SET VISIBLE(*;"MBTAText@";False)SET VISIBLE(*;"NonMBTAText@";True)End case SET VISIBLE(*;"BridgeTemplate_@";True)C_TEXT($currUser_txt)$currUser_txt:=×CurrentUser_NameC_LONGINT(bRailRoad)DISABLE BUTTON(bRailRoad)SET VISIBLE(bRailRoad;False)If ((User in group($currUser_txt;"MDC"))Ê&ÊNot(User in group($currUser_txt;"BMS Admin")))If (([Bridge MHD NBIS]InspResp="MDC")Ê|Ê([Bridge MHD NBIS]LegacyOwner="MDC"))Else C_BOOLEAN($Access_b)$Access_b:=BMSUtil_BelongToBridge ($CurrUser_txt;[Bridge MHD NBIS]InspResp)If (Not($Access_b))DISABLE BUTTON(bMisc)DISABLE BUTTON(bMaint)DISABLE BUTTON(bSecond)DISABLE BUTTON(bRatingRep)DISABLE BUTTON(bCsltRating)DISABLE BUTTON(bCsltInsp)DISABLE BUTTON(bDesign)DISABLE BUTTON(bID)End if End if End if SCPOA_POABtnCtrl ÊÊ`Added to change Forward address per maintenance responsibility      If (Structure file="MHD BMS External@")If ([Bridge MHD NBIS]InspResp="DIST@")vsForward:="District "+Substring([Bridge MHD NBIS]InspResp;5;1)+" BMS"End if End if Case of : ([Bridge MHD NBIS]Item8 BridgeCat="DUM")DISABLE BUTTON(bMaint)DISABLE BUTTON(bSecond)DISABLE BUTTON(bRatingRep)DISABLE BUTTON(bCsltRating)DISABLE BUTTON(bCsltInsp)DISABLE BUTTON(bDesign)DISABLE BUTTON(bInventory)DISABLE BUTTON(bInspection)DISABLE BUTTON(bScourPOA)DISABLE BUTTON(bScourCritical)DISABLE BUTTON(bRailRoad)DISABLE BUTTON(bTunnelSIA)DISABLE BUTTON(bTunnelInsp): ([Bridge MHD NBIS]Item8 BridgeCat="REM")DISABLE BUTTON(bCsltRating)DISABLE BUTTON(bCsltInsp)DISABLE BUTTON(bDesign)DISABLE BUTTON(bScourPOA)DISABLE BUTTON(bDesign): ([Bridge MHD NBIS]Item8 BridgeCat="@RO")If (User in group($currUser_txt;"RRBridgeEdit")Ê|ÊUser in group($currUser_txt;"BMS Admin")Ê|ÊUser in group($currUser_txt;"Application Admin"))ENABLE BUTTON(bRailRoad)SET VISIBLE(bRailRoad;True)ENABLE BUTTON(bSIA)End if If (([Bridge MHD NBIS]InspResp="MBTA")Ê&ÊUser in group($currUser_txt;"MBTA"))ENABLE BUTTON(bRailRoad)SET VISIBLE(bRailRoad;True)End if End case If (([Bridge MHD NBIS]Item8 BridgeCat="TNL")Ê|Ê([Bridge MHD NBIS]Item8 BridgeCat="BTS")Ê|Ê([Bridge MHD NBIS]Item8 BridgeCat="BLD"))SET VISIBLE(*;"bTunnel@";True)Else SET VISIBLE(*;"bTunnel@";False)End if C_LONGINT($Count_l)C_BOOLEAN($EditScourCritical_b;$Visible_b)SET QUERY DESTINATION(Into variable ;$Count_l)QUERY([ScourCriticalInfo];[ScourCriticalInfo]BIN=[Bridge MHD NBIS]BIN)SET QUERY DESTINATION(Into current selection )$Visible_b:=FalseCase of : ($Count_l=1)$Visible_b:=True: (User in group($CurrUser_txt;"ScourCritical")Ê|ÊUser in group($CurrUser_txt;"Design Access Group"))$Visible_b:=TrueElse $Visible_b:=FalseEnd case SET VISIBLE(bScourCritical;$Visible_b)If ((User in group($currUser_txt;"ExternalInspectors"))Ê|Ê(User in group($currUser_txt;"ExternalDesigners")))ÊÊ`For external Inspectors disable access to other modulesÊÊ`DISABLE BUTTON(bSIA)DISABLE BUTTON(bMisc)DISABLE BUTTON(bMaint)DISABLE BUTTON(bSecond)DISABLE BUTTON(bRatingRep)DISABLE BUTTON(bCsltRating)DISABLE BUTTON(bCsltInsp)DISABLE BUTTON(bDesign)DISABLE BUTTON(bID)DISABLE BUTTON(bTunnelSIA)End if vTown:=[Bridge MHD NBIS]Town NamevTown:=vTown+" (D-"+String(Num([Bridge MHD NBIS]Item2))+")"SIA_ReleaseBridgeRec G_CloseAllTables (->[Bridge MHD NBIS])ÊÊ`close all tables except the main one.SET VISIBLE(*;"ForDesigner@";False)If (Current form page#1)SIA_BridgeInpNavCTRL (Current form page)End if C_LONGINT($vlWL;$vlWT;$vlWR;$vlWB;vlNBIStckWinW;vlNBIStckWinH;$fw;$fH)C_LONGINT(vNBIOPENDETAIL_L)If (vNBIOPENDETAIL_L=1)If (vlNBIStckWinW=0)GET WINDOW RECT($vlWL;$vlWT;$vlWR;$vlWB)vlNBIStckWinW:=$vlWR-$vlWLvlNBIStckWinH:=$vlWB-$vlWTGET FORM PROPERTIES([Bridge MHD NBIS];"Bridge Input";$fW;$FH)SET WINDOW RECT($vlWL;$vlWT;$vlWL+$fW;$vlWT+$FH)End if vNBIOPENDETAIL_L:=0End if : ($FormEvent_L=On Unload )G_CloseAllTables (->[Bridge MHD NBIS])ÊÊ`close all tables except the main one.ÊÊ`restore Forward to global variablevsForward:=×Forward: ($FormEvent_L=On Outside Call )If (×fQuit)CANCELEnd if End case 