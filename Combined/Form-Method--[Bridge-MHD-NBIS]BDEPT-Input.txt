If (False)ÊÊ`LP [Bridge MHD NBIS];"BDEPT Input"Mods_2005_CM05 ÊÊ` Modified by: costasmanousakis-(Designer)-(5/19/2006 08:37:22)Mods_2006_CM04 ÊÊ` Modified by: costasmanousakis-(Designer)-(4/30/08 15:54:02)Mods_2008_CM_5403 ÊÊ`Added Tab control ; removed record navigation btns; re-arranged location of objects on page 1;ÊÊ`for the Facility carried and Feature intersected use the new SIA_@_OM project methods.ÊÊ` Modified by: costasmanousakis-(Designer)-(5/13/08 16:54:49)Mods_2008_CM_5403 ÊÊ`Removed the next/prev page buttons.ÊÊ` Modified by: costasmanousakis-(Designer)-(6/30/08 09:50:04)Mods_2008_CM_5404 ÊÊ`Added the objects and  to implement the assigning of newly created BINs to projectsÊÊ` Modified by: costasmanousakis-(Designer)-(6/3/10 16:59:39)Mods_2010_06 ÊÊ`Added additional fields from the existing recordsÊÊ`Added a new Blue bar at the header. Made form adjustable in ht and fixed moving and growing of objects on page 1ÊÊ` Modified by: costasmanousakis-(Designer)-(8/12/10 10:28:04)Mods_2010_08 ÊÊ`ÊÊ`Fixed Move preferences of some objects.ÊÊ` Modified by: costasmanousakis-(Designer)-(8/27/10 15:43:24)Mods_2010_08 ÊÊ`ÊÊ`Added Item 8 OwnerÊÊ` Modified by: costasmanousakis-(Designer)-(10/20/10 12:13:28)Mods_2010_10 ÊÊ`ÊÊ`Added [Bridge MHD NBIS]LegacyOwnerÊÊ` Modified by: costasmanousakis-(Designer)-(5/27/11 09:26:33)Mods_2011_05 ÊÊ`ÊÊ`ReLabeled 1st Tab to MassDOT ItemsÊÊ` Modified by: costasmanousakis-(Designer)-(6/20/11 10:43:47)Mods_2011_06 ÊÊ`ÊÊ`Added RR info, Agency Bridge noÊÊ` Modified by: costasmanousakis-(Designer)-(12/14/11 09:53:17)Mods_2011_12 ÊÊ`ÊÊ`Switched from aItem7 to RefBINSelector_atxtÊÊ` Modified by: Costas Manousakis-(Designer)-(11/5/12 11:32:09)Mods_2012_11 ÊÊ`ÊÊ`Changed label from Replacement BDEPT to BDEPT being ReplacedÊÊ` Modified by: Costas Manousakis-(Designer)-(3/29/13 13:43:20)Mods_2013_03 ÊÊ`ÊÊ`Increased width of [Bridge MHD NBIS]RRBranch fielldÊÊ` Modified by: Costas Manousakis-(Designer)-(8/19/13 13:22:33)Mods_2013_08 ÊÊ`ÊÊ`Added  code to include creation of Townline Records on the Validate eventÊÊ`ÊÊ`Changed display of initial values from pulldowns : use element 0 of the puuldown to display the prompt to ÊÊ`ÊÊ`select a value instead of a variable over the pulldown. Deleted variables over the item8 dropdownsÊÊ`ÊÊ`Re arranged tab controls, form size properties, objectsEnd if Case of : (Form event=On Load )ARRAY STRING(12;abrkey;0)ARRAY STRING(9;aItem5;0)ARRAY STRING(24;aItem6;0)ARRAY BOOLEAN(aItem6b;0)ARRAY STRING(18;aItem7;0)ARRAY STRING(25;aItem9;0)ARRAY REAL(aItem11;0)ARRAY INTEGER(aItem16a;0)ARRAY INTEGER(aItem16b;0)ARRAY REAL(aItem16c;0)ARRAY INTEGER(aItem17a;0)ARRAY INTEGER(aItem17b;0)ARRAY REAL(aItem17c;0)ARRAY STRING(3;aItem98a;0)ARRAY STRING(2;aItem98b;0)ARRAY STRING(15;aItem99;0)ARRAY STRING(5;aInspResp;0)ARRAY STRING(2;Item42_as;0)ARRAY LONGINT(Item29_aL;0)ARRAY INTEGER(Item30_ai;0)ARRAY INTEGER(Item109_ai;0)ARRAY INTEGER(Item19_ai;0)ARRAY STRING(2;Item38_as;0)ARRAY BOOLEAN(Item104_ab;0)ARRAY STRING(2;Item26_as;0)ARRAY STRING(2;Item100_as;0)ARRAY STRING(2;Item101_as;0)ARRAY STRING(2;Item102_as;0)ARRAY STRING(2;Item105_as;0)ARRAY BOOLEAN(Item110_ab;0)ARRAY STRING(2;Item20_as;0)ARRAY STRING(2;Item21_as;0)ARRAY STRING(2;Item22_as;0)ARRAY STRING(80;BridgeName_as;0)ARRAY STRING(3;ParBIN_as;0)ARRAY STRING(3;Item8Owner_as;0)ARRAY STRING(3;Item8LegacyOwner_as;0)ARRAY STRING(20;RRBranch_as;0)ARRAY REAL(RRBridgeNo_ar;0)ARRAY STRING(20;AgencyBrNo_as;0)ARRAY BOOLEAN(aTownLineb;0)ARRAY TEXT(RefBINSelector_atxt;0)If (OnServer=False)Inc_Sequence ("BIN";->vBIN_Dec)[Bridge MHD NBIS]BIN:=ConvertBIN (vBIN_Dec)DISABLE BUTTON(bGetRBIN)Else [Bridge MHD NBIS]BIN:=""End if [Bridge MHD NBIS]DateCreated:=Current date(*)ÊÊ`+×LDifferenceÊÊ`Add the difference between the server date[Bridge MHD NBIS]TimeCreated:=Current time(*)ÊÊ`+×hDifferenceÊÊ`Add the difference between the server time[Bridge MHD NBIS]Modified By:=Current userRefBINSelector_atxt{0}:="No reference bridge ...."RefBINSelector_atxt:=0ÊÊ`## Initialize transfer dataInitChangeStack (1): (Form event=On Validate )ÊÊ`##Save changes made to tableLogNewRecord (->[Bridge MHD NBIS]BIN;->[Bridge MHD NBIS]BIN;->[Bridge MHD NBIS]BIN;0;"BIN")PushChange (1;->[Bridge MHD NBIS]DateCreated)PushChange (1;->[Bridge MHD NBIS]TimeCreated)PushChange (1;->[Bridge MHD NBIS]Modified By)FlushGrpChgs (1;->[Bridge MHD NBIS]BIN;->[Bridge MHD NBIS]BIN;->[Bridge MHD NBIS]BIN;0)If ([Bridge MHD NBIS]OnTwnLine)C_LONGINT($Select_L)$Select_L:=RefBINSelector_atxtIf ($Select_L>0)ÊÊ`Selected a bridge - get the BINC_TEXT(BIN_txt)BIN_txt:=RefBINSelector_atxt{$Select_L}BIN_txt:=Substring(BIN_txt;(Length(BIN_txt)-8);3)ÊÊ`find the records in [TownLineInfo] tableARRAY TEXT(TownLineBdepts_atxt;0)Begin SQLSelect [TownLineInfo].BDEPT from [TownLineInfo] WHERE [TownLineInfo].BIN = :BIN_txt into :TownLineBdepts_atxt ;End SQLIf (Size of array(TownLineBdepts_atxt)>0)C_LONGINT($loop_L)For ($loop_L;1;Size of array(TownLineBdepts_atxt))If (TownLineBdepts_atxt{$loop_L}#"")CREATE RECORD([TownLineInfo])Inc_Sequence ("TownLine";->[TownLineInfo]RefID)[TownLineInfo]BIN:=[Bridge MHD NBIS]BINLogNewRecord (->[Bridge MHD NBIS]BIN;->[TownLineInfo]BIN;->[TownLineInfo]RefID;1;"TownLine")[TownLineInfo]BDEPT:=TownLineBdepts_atxt{$loop_L}LogChanges (->[TownLineInfo]BDEPT;->[Bridge MHD NBIS]BIN;->[TownLineInfo]BIN;->[TownLineInfo]RefID;1)SAVE RECORD([TownLineInfo])End if End for End if End if End if End case 