If (False)ÊÊ` ----------------------------------------------------ÊÊ` User name (OS): costasmanousakisÊÊ` User name (4D): DesignerÊÊ` Date and time: 04/14/08, 11:51:53ÊÊ` ----------------------------------------------------ÊÊ` Method: SIA_SecureInputFormÊÊ` DescriptionÊÊ` Handle security settings in the SIA Input form.ÊÊ` ÊÊ` ParametersÊÊ` $1 : Action type ("APPLY" | "RELEASE" | "LOCK")ÊÊ` ----------------------------------------------------Mods_2008_CM_5403 ÊÊ` Modified by: costasmanousakis-(Designer)-(10/30/09 12:55:24)Mods_2009_10 ÊÊ`ÊÊ`Added code to secure Item 113 ÊÊ` Modified by: costasmanousakis-(Designer)-(12/8/09 10:32:28)Mods_2009_12 ÊÊ`Added Bridge insp Engineer and Area Engineers to edit UW inspection infoÊÊ` Modified by: costasmanousakis-(Designer)-(9/1/10 12:34:38)Mods_2010_09 ÊÊ`ÊÊ`Added more color changes to fields being set to editable/noneditableÊÊ` Modified by: costasmanousakis-(Designer)-(11/30/11 16:33:55)Mods_2011_11 ÊÊ`ÊÊ`For non_NBI records unlock Item91 Inspection frequencyÊÊ` Modified by: Costas Manousakis-(Designer)-(12/7/12 14:31:08)Mods_2012_12 ÊÊ`ÊÊ`For ALL non_NBI records unlock Item91 Inspection frequencyÊÊ` Modified by: Costas Manousakis-(Designer)-(9/6/13 16:52:50)Mods_2013_09 ÊÊ`ÊÊ`For tunnel records lock all inspection fields - must be entered in the Tunnel SIA input formÊÊ` Modified by: Costas Manousakis-(Designer)-(10/24/13 16:03:10)Mods_2013_10 ÊÊ`ÊÊ`added special action for users to edit LatLon fields onlyEnd if C_TEXT($1)C_TEXT($currentuser_txt)$currentuser_txt:=×CurrentUser_NameCase of : ($1="APPLY")If (User in group($currentuser_txt;"Jointless Bridge"))SET ENTERABLE([Bridge MHD NBIS]JointlessBridge;True)SET COLOR([Bridge MHD NBIS]JointlessBridge;×Color_Editable)ENABLE BUTTON(aIntegralD_)Else SET ENTERABLE([Bridge MHD NBIS]JointlessBridge;False)SET COLOR([Bridge MHD NBIS]JointlessBridge;×Color_not_editable)DISABLE BUTTON(aIntegralD_)End if If (User in group($currentuser_txt;"Historical Significance"))SET ENTERABLE([Bridge MHD NBIS]Item37;True)SET COLOR([Bridge MHD NBIS]Item37;×Color_Editable)Else SET ENTERABLE([Bridge MHD NBIS]Item37;False)SET COLOR([Bridge MHD NBIS]Item37;×Color_not_editable)End if If ([Bridge MHD NBIS]Item103=True)SET ENTERABLE([Bridge MHD NBIS]Item70;True)SET COLOR([Bridge MHD NBIS]Item70;×Color_Editable)Else SET ENTERABLE([Bridge MHD NBIS]Item70;False)SET COLOR([Bridge MHD NBIS]Item70;×Color_not_editable)End if C_BOOLEAN($UWInfoEdit_b)$UWInfoEdit_b:=(User in group($currentuser_txt;"Dive Inspection")Ê|ÊUser in group($currentuser_txt;"MDC"))$UWInfoEdit_b:=$UWInfoEdit_bÊ|Ê(User in group($currentuser_txt;"Bridge Insp Engineer"))$UWInfoEdit_b:=$UWInfoEdit_bÊ|Ê(User in group($currentuser_txt;"Area Engineers"))If ($UWInfoEdit_b)SET ENTERABLE([Bridge MHD NBIS]Item92BA;True)SET ENTERABLE([Bridge MHD NBIS]Item92BB;True)SET ENTERABLE([Bridge MHD NBIS]Item93B;True)SET COLOR([Bridge MHD NBIS]Item92BA;×Color_Editable)SET COLOR([Bridge MHD NBIS]Item92BB;×Color_Editable)SET COLOR([Bridge MHD NBIS]Item93B;×Color_Editable)SET ENTERABLE(*;"UW Inspection Item@";True)SET COLOR(*;"UW Inspection Item@";×Color_Editable)Else SET ENTERABLE([Bridge MHD NBIS]Item92BA;False)SET ENTERABLE([Bridge MHD NBIS]Item92BB;False)SET ENTERABLE([Bridge MHD NBIS]Item93B;False)SET COLOR([Bridge MHD NBIS]Item92BA;×Color_not_editable)SET COLOR([Bridge MHD NBIS]Item92BB;×Color_not_editable)SET COLOR([Bridge MHD NBIS]Item93B;×Color_not_editable)SET ENTERABLE(*;"UW Inspection Item@";False)SET COLOR(*;"UW Inspection Item@";×Color_not_editable)End if ÊÊ`Per request from F. Rastegari Dec-24-2001 Lock Feat. Over UnderIf (User in group($currentuser_txt;"Key Access"))SET ENTERABLE(*;"Features@";True)ENABLE BUTTON(*;"Features@")Else SET ENTERABLE(*;"Features@";False)DISABLE BUTTON(*;"Features@")End if ÊÊ`Per request from F. Rastegari Aug-24-2001If (User in group($currentuser_txt;"Ratings and Overloads"))SET ENTERABLE([Bridge MHD NBIS]Item64;True)SET ENTERABLE([Bridge MHD NBIS]Item66;True)ENABLE BUTTON(aORatMethD_)ENABLE BUTTON(aIRatMethD_)Else SET ENTERABLE([Bridge MHD NBIS]Item64;False)SET ENTERABLE([Bridge MHD NBIS]Item66;False)DISABLE BUTTON(aORatMethD_)DISABLE BUTTON(aIRatMethD_)SET COLOR([Bridge MHD NBIS]Item66;-Green )SET COLOR([Bridge MHD NBIS]Item64;-Green )SET COLOR(aORatMethD_;-Dark Green )SET COLOR(aIRatMethD_;-Dark Green )End if ÊÊ`Also per request from F. Rastegari Aug-24-2001If ((User in group($currentuser_txt;"Bridge Engineer"))Ê|Ê(User in group($currentuser_txt;"Bridge Insp Engineer"))Ê|Ê($currentuser_txt="designer"))SET ENTERABLE([Bridge MHD NBIS]PostingDate;True)SET ENTERABLE([Bridge MHD NBIS]Complex Bridge;True)SET ENTERABLE([Bridge MHD NBIS]Complex Rating;True)ÊÊ`Req. from F. Rastegari Mar-03ENABLE BUTTON(aPostStat_)ENABLE BUTTON(vDesRating)SET VISIBLE(vDesRating;True)Else SET ENTERABLE([Bridge MHD NBIS]PostingDate;False)SET ENTERABLE([Bridge MHD NBIS]Complex Bridge;False)SET ENTERABLE([Bridge MHD NBIS]Complex Rating;False)DISABLE BUTTON(aPostStat_)SET COLOR([Bridge MHD NBIS]PostingDate;-Green )SET COLOR(aPostStat_;-Dark Green )DISABLE BUTTON(vDesRating)SET VISIBLE(vDesRating;False)End if ÊÊ`Added to enable Entry for Item 91 for  NonNBI recordsIf (Not([Bridge MHD NBIS]FHWARecord))SET ENTERABLE([Bridge MHD NBIS]Item91;True)SET COLOR([Bridge MHD NBIS]Item91;×Color_Editable)End if If ((User in group($currentuser_txt;"Inspection Engineers"))Ê|Ê(User in group($currentuser_txt;"Bridge Insp Engineer"))Ê|ÊUser in group($currentuser_txt;"Area Engineers"))SET ENTERABLE(*;"DE FreezeThawList";True)ENABLE BUTTON(*;"DE FreezeThawList")SET COLOR(*;"DE FreezeThawList";×Color_Editable)Else SET ENTERABLE(*;"DE FreezeThawList";False)DISABLE BUTTON(*;"DE FreezeThawList")SET COLOR(*;"DE FreezeThawList";×Color_not_editable)End if If (User in group($currentuser_txt;"ITEM113EDIT"))SET ENTERABLE([Bridge MHD NBIS]Item113;True)SET COLOR([Bridge MHD NBIS]Item113;×Color_Editable)Else SET ENTERABLE([Bridge MHD NBIS]Item113;False)SET COLOR([Bridge MHD NBIS]Item113;×Color_not_editable)End if SIA_Feature_OM (->[Bridge MHD NBIS]Item7;->a7FDescr_;->v7FDescr;->a7FCodes_;->v7RteNum;->v7Suffix;->v7Descr;On Load )SIA_Feature_OM (->[Bridge MHD NBIS]Item6A;->aFeatDescr_;->vFeatDescr;->aFeatCodes_;->vRteNum;->vsuffix;->v6Descr;On Load )If ([Bridge MHD NBIS]FHWARecord)SET ENTERABLE([Bridge MHD NBIS]Item91;False)SET COLOR([Bridge MHD NBIS]Item91;×Color_not_editable)Else SET ENTERABLE([Bridge MHD NBIS]Item91;True)SET COLOR([Bridge MHD NBIS]Item91;×Color_Editable)End if If (([Bridge MHD NBIS]Item8 BridgeCat="TNL")Ê|Ê([Bridge MHD NBIS]Item8 BridgeCat="BTS"))ÊÊ`Lock all inspection for Boat and Tunnel recordsSET ENTERABLE(*;"DE BridgeInsp@";False)SET COLOR(*;"DE BridgeInsp@";×Color_not_editable)SET ENTERABLE(*;"UW @";False)SET COLOR(*;"UW @";×Color_not_editable)SET ENTERABLE([Bridge MHD NBIS]Item91;False)SET COLOR([Bridge MHD NBIS]Item91;×Color_not_editable)SET VISIBLE(*;"TUNNELNotice";True)End if : ($1="EDITLATLONG")SIA_SecureInputForm ("LOCK")LOAD RECORD([Bridge MHD NBIS])ENABLE BUTTON(*;"SaveBtn")ENABLE BUTTON(*;"VariableCopyLatLon")SET ENTERABLE([Bridge MHD NBIS]Item16A;True)SET ENTERABLE([Bridge MHD NBIS]Item16B;True)SET ENTERABLE([Bridge MHD NBIS]Item16C;True)SET ENTERABLE([Bridge MHD NBIS]Item17A;True)SET ENTERABLE([Bridge MHD NBIS]Item17B;True)SET ENTERABLE([Bridge MHD NBIS]Item17C;True)SET COLOR([Bridge MHD NBIS]Item16A;×Color_editable)SET COLOR([Bridge MHD NBIS]Item16B;×Color_editable)SET COLOR([Bridge MHD NBIS]Item16C;×Color_editable)SET COLOR([Bridge MHD NBIS]Item17A;×Color_editable)SET COLOR([Bridge MHD NBIS]Item17B;×Color_editable)SET COLOR([Bridge MHD NBIS]Item17C;×Color_editable): ($1="LOCK")SET ENTERABLE(*;"Field@";False)SET ENTERABLE(*;"DE BridgeInsp@";False)SET ENTERABLE(*;"Featur@";False)SET ENTERABLE(*;"UW @";False)SET ENTERABLE(*;"DE @";False)SET COLOR(*;"Field@";×Color_not_editable)SET COLOR(*;"DE BridgeInsp@";×Color_not_editable)SET COLOR(*;"Featur@";×Color_not_editable)SET COLOR(*;"UW @";×Color_not_editable)SET COLOR(*;"DE @";×Color_not_editable)SET ENTERABLE(*;"Variable@";False)DISABLE BUTTON(*;"Variable@")DISABLE BUTTON(*;"Featur@")SET VISIBLE(*;"SIALockBtn";False)SIA_ReleaseBridgeRec If ((Not(User in group($currentuser_txt;"SIA Access")))Ê|Ê(Not(BRG_RWAccess )))SET VISIBLE(*;"SIALockBtn";False)Else SET VISIBLE(*;"SIALockBtn";True)End if : ($1="RELEASE")SET ENTERABLE(*;"Field@";True)SET ENTERABLE(*;"DE BridgeInsp@";True)SET ENTERABLE(*;"Featur@";True)SET ENTERABLE(*;"UW @";True)SET ENTERABLE(*;"DE @";True)SET COLOR(*;"Field@";×Color_editable)SET COLOR(*;"DE BridgeInsp@";×Color_editable)SET COLOR([Bridge MHD NBIS]JointlessBridge;-White )SET COLOR(*;"Featur@";×Color_editable)SET COLOR(*;"UW @";×Color_editable)SET COLOR(*;"DE @";×Color_editable)SET ENTERABLE(*;"Variable@";True)ENABLE BUTTON(*;"Variable@")ENABLE BUTTON(*;"Featur@")SET VISIBLE(*;"SIALockBtn";True)End case 