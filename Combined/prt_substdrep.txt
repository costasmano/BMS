If (False)  ` ----------------------------------------------------  ` prt_substdrep  ` User name (OS): cjmiller  ` Date and time: 03/29/05, 16:05:57  ` ----------------------------------------------------  ` Description  `   `  ` Parameters  ` ----------------------------------------------------Mods_2005_CJM02   `03/29/05, 16:06:12 Mods_2005_CM16   ` Modified by: ManousakisC (11/1/2005)Mods_2005_CM18   ` Modified by: costasmanousakis-(Designer)-(6/6/2006 15:52:34)Mods_2006_CMy4   ` Modified by: costasmanousakis-(Designer)-(1/10/2007 14:35:43)Mods_2007_CM01   ` Modified by: costasmanousakis-(Designer)-(9/12/2007 11:21:05)Mods_2007_CM12_5301   ` Modified by: costasmanousakis-(Designer)-(11/1/09 08:40:33)Mods_2009_10 ("MASSDOT")  `  `modified to give multiple print form options to designerDIALOG([Status Report];"P_StatusReport")DIALOG([Status Report];"P_StatusReport_HI")DIALOG([Status Report];"P_StatusReport_MDOT")DIALOG([Status Report];"P_StatusReport_MDOT_5D")DIALOG([Status Report];"P_StatusReport_new")DIALOG([Status Report];"P_StatusReport_HI_old")DIALOG([Status Report];"P_StatusReport_MDOT_old")DIALOG([Status Report];"P_StatusReport_MDOT_5D_old")  ` Modified by: costasmanousakis-(Designer)-(4/22/10 08:48:55)Mods_2010_04   `  `use STATREP_ReportType to determine which is the default form to print when not Designer  ` Modified by: costasmanousakis-(Designer)-(8/2/10 05:35:24)Mods_2010_08   `  `Changed Parameter 1 to Longint to have more than two options of print form selection  ` Modified by: costasmanousakis-(Designer)-(3/7/11 17:49:41)Mods_2011_03   `  `use method STATREP_DefaultPrintFormMods_2011_04   `r002 CJ Miller`04/11/11, 11:06:11      `Add code to delay when on serverMods_2011_04   `r002 CJ Miller`04/12/11, 11:59:39      `Change from  `Get indexed string to substring of date;5 to get 3 character month  ` Modified by: Costas Manousakis-(Designer)-(3/13/13 16:08:53)Mods_2013_03   `  `Added to the list the _old reports  ` Modified by: Costas Manousakis-(Designer)-(10/21/13 13:20:59)Mods_2013_10   `  `Added the default formEnd if   `GP: prt_substdrepC_STRING(40;$printform)C_LONGINT($1;$PrintHIRpt_L)C_BOOLEAN($2;$Batchmode_b;$ReportModeOn_b)$ReportModeOn_b:=FalseC_TEXT(ReportError_txt)If (Count parameters=2) | (Count parameters=3)$PrintHIRpt_L:=$1$Batchmode_b:=$2Case of : ($PrintHIRpt_L=1)$ReportModeOn_b:=True$printform:="P_StatusReport_MDOT_5D": ($PrintHIRpt_L=2)$ReportModeOn_b:=True$printform:="P_StatusReport_HI": ($PrintHIRpt_L=3)$printform:="P_StatusReport_MDOT"$ReportModeOn_b:=TrueReportError_txt:=ReportError_txt+$printform+" set "+Char(Carriage return )End case If (Count parameters=3)C_TEXT($3;$Filename)$Filename:=$3End if Else C_TEXT($reportType_txt)$reportType_txt:=STATREP_ReportType $printform:=STATREP_DefaultPrintForm ($reportType_txt;[Status Report]Date_Created)C_TEXT($CurUser_txt)$CurUser_txt:=Current userIf (User in group($CurUser_txt;"BMS Admin"))ARRAY TEXT($ListofForms_atxt;0)APPEND TO ARRAY($ListofForms_atxt;"P_StatusReport")APPEND TO ARRAY($ListofForms_atxt;"P_StatusReport_HI")APPEND TO ARRAY($ListofForms_atxt;"P_StatusReport_MDOT")APPEND TO ARRAY($ListofForms_atxt;"P_StatusReport_MDOT_5D")APPEND TO ARRAY($ListofForms_atxt;"P_StatusReport_new")APPEND TO ARRAY($ListofForms_atxt;"P_StatusReport_HI_old")APPEND TO ARRAY($ListofForms_atxt;"P_StatusReport_MDOT_old")APPEND TO ARRAY($ListofForms_atxt;"P_StatusReport_MDOT_5D_old")APPEND TO ARRAY($ListofForms_atxt;$printform+" - Default")C_LONGINT($pick_L)$pick_L:=G_PickFromList (->$ListofForms_atxt;"Select Print Form - Cancel for "+$printform)If ($pick_L>0)$printform:=$ListofForms_atxt{$pick_L}$printform:=Replace string($printform;" - Default";"")End if ARRAY TEXT($ListofForms_atxt;0)End if $Batchmode_b:=FalseEnd if G_PrintOptions (2)If (Application type#4D Server )C_TEXT($Filename)$Filename:="Bridge Status "+String(Day of([Status Report]Date_Created);"00")+"-"C_TEXT($ReportMonth_txt)$ReportMonth_txt:=Substring(String([Status Report]Date_Created;Internal date long );1;3)$Filename:=$Filename+$ReportMonth_txt+"-"$Filename:=$Filename+String(Year of([Status Report]Date_Created))SET PRINT OPTION(Spooler document name option ;$Filename)End if   `PAGE SETUP([Status Report];$printform)If (Not($Batchmode_b))PRINT SETTINGS$Batchmode_b:=(OK=1)Else End if If ($Batchmode_b)If ($ReportModeOn_b)ReportError_txt:=ReportError_txt+$printform+" print "+" tick:"+String(Tickcount)+"]"+Char(Carriage return )End if Print form([Status Report];$printform)If ($ReportModeOn_b)ReportError_txt:=ReportError_txt+$printform+" printed "+"OK:"+String(OK)+" tick:"+String(Tickcount)+"]"+Char(Carriage return )End if PAGE BREAKIf ($ReportModeOn_b)ReportError_txt:=ReportError_txt+$printform+" page break "+"OK:"+String(OK)+" tick:"+String(Tickcount)+"]"+Char(Carriage return )End if C_LONGINT($Count_l)$Count_l:=0If (Application type=4D Server )Repeat If ($Count_l=0)DELAY PROCESS(Current process;60*10)  `delay 10 seconds$Count_l:=1Else DELAY PROCESS(Current process;60*10)  `delay 10 seconds$Count_l:=$Count_l+1End if Until ($Count_l>3) | (Test path name($Filename)=Is a document )End if If ($ReportModeOn_b)If ($Count_l>0)If (Test path name($Filename)=Is a document )ReportError_txt:=ReportError_txt+"prt_substdrep : Tried to find document "+String($Count_l)+" times "+" tick:"+String(Tickcount)+"]"+Char(Carriage return )ReportError_txt:=ReportError_txt+$printform+" printed "+" tick:"+String(Tickcount)+"]"+Char(Carriage return )Else ReportError_txt:=ReportError_txt+"prt_substdrep : Could not find document named "+$Filename+" after "+String($Count_l)+" delays "+" tick:"+String(Tickcount)+"]"+Char(Carriage return )End if End if End if End if If (Application type#4D Server )SET PRINT OPTION(Spooler document name option ;"")End if   `End prt_substdrep