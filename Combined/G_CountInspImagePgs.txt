ÊÊ`G_CountInspImagePgsÊÊ`Count pages of Inspection Images.ÊÊ`Also build arrays with page numbers for each Image.If (False)ÊÊ`Sep-2003 : CreatedEnd if C_INTEGER(viNumCmtsPgs;viCmtsPgStart;viSkPgStart;viChPgStart;viPhPgStart)C_INTEGER(viNumSkPgs;viNumChPgs;viNumPhPgs)C_INTEGER($i;$viNumPhotos)ARRAY INTEGER($aiSeqNos;0)ARRAY BOOLEAN($abPhotoperPage;0)COPY NAMED SELECTION([Standard Photos];"InspectImagesCount")viSkPgStart:=viCmtsPgStart+viNumCmtsPgsÊÊ`SET QUERY DESTINATION(Into variable ;viNumSkPgs)QUERY SELECTION([Standard Photos];[Standard Photos]PictType=BMS Sketch )viNumSkPgs:=Records in selection([Standard Photos])ARRAY INTEGER(aiSketchPage;viNumSkPgs)ARRAY INTEGER(aiSketchSeqNo;viNumSkPgs)viChPgStart:=viSkPgStart+viNumSkPgsIf (viNumSkPgs>0)SELECTION TO ARRAY([Standard Photos]SeqNum;aiSketchSeqNo)SORT ARRAY(aiSketchSeqNo)For ($i;1;viNumSkPgs)aiSketchPage{$i}:=viSkPgStart+($i-1)End for End if USE NAMED SELECTION("InspectImagesCount")ÊÊ`SET QUERY DESTINATION(Into variable ;viNumChPgs)QUERY SELECTION([Standard Photos];[Standard Photos]PictType=BMS Chart )viNumChPgs:=Records in selection([Standard Photos])ARRAY INTEGER(aiChartPage;viNumChPgs)ARRAY INTEGER(aiChartSeqNo;viNumChPgs)viPhPgStart:=viChPgStart+viNumChPgsIf (viNumChPgs>0)SELECTION TO ARRAY([Standard Photos]SeqNum;aiChartSeqNo)SORT ARRAY(aiChartSeqNo)For ($i;1;viNumChPgs)aiChartPage{$i}:=viChPgStart+($i-1)End for End if USE NAMED SELECTION("InspectImagesCount")ÊÊ`SET QUERY DESTINATION(Into current selection )QUERY SELECTION([Standard Photos];[Standard Photos]PictType=BMS Photo )$viNumPhotos:=Records in selection([Standard Photos])ARRAY INTEGER(aiPhotoPage;$viNumPhotos)ARRAY INTEGER(aiPhotoSeqNo;$viNumPhotos)If ($viNumPhotos>0)SELECTION TO ARRAY([Standard Photos]SeqNum;aiPhotoSeqNo;[Standard Photos]Portrait;$abPhotoPerPage)SORT ARRAY(aiPhotoSeqNo;$abPhotoPerPage)ARRAY INTEGER(aiPhotoPage;$viNumPhotos)viNumPhPgs:=0For ($i;1;$viNumPhotos)aiPhotoPage{$i}:=viPhPgStart+viNumPhPgsviNumPhPgs:=viNumPhPgs+1If (($i<$viNumPhotos)Ê&Ê($abPhotoPerPage{$i}))If ($abPhotoPerPage{($i+1)})$i:=$i+1aiPhotoPage{$i}:=aiPhotoPage{($i-1)}End if End if End for Else viNumPhPgs:=0End if USE NAMED SELECTION("InspectImagesCount")CLEAR NAMED SELECTION("InspectImagesCount")