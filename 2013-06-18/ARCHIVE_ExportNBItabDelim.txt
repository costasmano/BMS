  `Method: ARCHIVE_ExportNBItabDelim  `Description  `  ` Export an NBI tape from the current list of [BridgeMHDNBISArchive] records  `  ` to a tab delim file.  No error checks are done  ` Parameters  ` ----------------------------------------------------If (False)  ` ----------------------------------------------------  `User name (OS): Costas Manousakis  `User (4D) : Designer  `Date and time: 04/17/12, 11:15:05  ` ----------------------------------------------------  `Created : Mods_2012_04   ` Modified by: Costas Manousakis-(Designer)-(6/18/13 09:54:36)Mods_2013_06  `  `Added $item8_txt to get fhwaItem8 field if it is populatedEnd if   `C_TIME($dExportFile)C_TIME($dErrFile)  `Added 4/3/2000 CMC_STRING(80;$NBfile)C_STRING(80;$NBErrfile)C_STRING(255;$fill)C_STRING(255;$vsOutputFolder;◊vsNBIExportOutF)C_TEXT($t)C_TEXT($et)  ` added 3/21/2001C_LONGINT($i;$j;$k;$Recs;$Interval)C_LONGINT($l)  `Added 4/3/2000 cm - error record counterC_INTEGER($y;$m)C_STRING(3;$crit)C_STRING(24;$Item6A)  `Added 3/6/98 by Tom Nee.C_STRING(1;$Item6B)C_STRING(18;$Item7)  `Added 3/6/98 by Tom Nee.C_STRING(25;$Item9)  `Added 3/6/98 by Tom Nee.C_STRING(4;$Item10)C_STRING(7;$Item11)C_STRING(1;$Item12)C_STRING(8;$Item16)C_STRING(9;$Item17)C_STRING(3;$Item19)C_STRING(4;$Item27;$Item28)C_STRING(6;$Item29)C_STRING(4;$Item30;$Item32)C_STRING(2;$Item34)C_STRING(1;$Item35;$Item37)  `C_STRING(11;$Item37FHWA;$Item37Code) ` Replaced by call to GP HistoricalTrans.C_STRING(4;$Item39)C_STRING(5;$Item40)C_STRING(3;$Item45)C_STRING(4;$Item46)C_STRING(3;$Item47)C_STRING(5;$Item48)C_STRING(6;$Item49)C_STRING(6;$Item50)C_STRING(4;$Item51;$Item52;$Item53)C_STRING(5;$Item54)C_STRING(4;$Item55)C_STRING(3;$Item56;$Item64;$Item66)C_STRING(6;$Item76)C_STRING(4;$Item90)C_STRING(2;$Item91)C_STRING(9;$Item92)C_STRING(4;$Item93A;$Item93B;$Item93C)C_STRING(6;$Item94;$Item95;$Item96)C_STRING(4;$Item97)C_STRING(1;$Item103;$Item104)C_STRING(4;$Item106)C_STRING(2;$Item109)C_STRING(1;$Item110;$Item112;$Item113)C_STRING(6;$Item114)C_STRING(4;$Item115)C_STRING(4;$Item116)  `C_STRING(2;$Item2)C_STRING(12;$Item13)  `C_STRING(2;$Item21;$Item22)   `C_STRING(1;$Item31;$Item33;$Item36;$Item38;$Item41)C_STRING(3;$Item44)  `C_STRING(1;$Item58;$Item59;$Item60;$Item61;$Item62); C_STRING(1;$Item63;$Item65)  `C_STRING(1;$Item67;$Item68;$Item69;$Item70;$Item71;$Item72)C_STRING(3;$Item75)  `C_STRING(5;$Item98);  `C_STRING(15;$Item99)C_STRING(1;$Item105)  `C_STRING(1;$Item107);  `C_STRING(3;$Item108)C_STRING(1;$Item111)C_BOOLEAN($igItem97;$igItem92a)C_STRING(1;$tab_c)$tab_c:=Char(9)  `Get only FHWA records  `SEARCH([BridgeMHDNBISArchive];[BridgeMHDNBISArchive]FHWARecord=True)  `  changed by CM to do it for records in selection$Recs:=Records in selection([BridgeMHDNBISArchive])CONFIRM("Export "+String($Recs;"##,##0")+" records to an NBI file (fixed length, 434 characters per record)?")If (OK=1)CENTER_WINDOW (250;190)DIALOG([Dialogs];"SuppressErrors")CLOSE WINDOWIf (Ok=1)$igItem97:=(CBItem97=1)$igItem92a:=(CBItem92a=1)End if   `  $Item37FHWA:="12235334435" ` Replaced by call to GP HistoricalTrans.  `  $Item37Code:="HEPANCR ?XZ" ` Replaced by call to GP HistoricalTrans.$fill:=" "*43$t:="Select folder for Export files."If (◊vsNBIExportOutF#"")$t:=$t+"  (Press Cancel for "+◊vsNBIExportOutF+")"End if $vsOutputFolder:=Select folder($t)If (OK=1)◊vsNBIExportOutF:=$vsOutputFolderElse $vsOutputFolder:=◊vsNBIExportOutFEnd if $NBfile:="MFINPUT.TXT"$dExportFile:=Create document($vsOutputFolder+$NBfile;"TEXT")$NBErrfile:="MFINPUTERR.TXT"$dErrFile:=Create document($vsOutputFolder+$NBErrfile;"TEXT")If (Ok=1)  `TRACE◊ProgressPID:=StartProgress ("NBIExport";"None";"Exporting NBI Records")UpdateProgress (0;$Recs)  `Start the progress$Interval:=MaxNum (MinNum (Int($Recs/40);20);2)  ` get an update interval between 2 and 20$t:=""$t:="StateCode"+$tab_c+"Item8"+$tab_c+"Item5"+$tab_c+"Item2"+$tab_c$t:=$t+"Item3"+$tab_c+"Item4"+$tab_c+"Item6A"+$tab_c+"Item6B"+$tab_c+"Item7"+$tab_c$t:=$t+"Item9"+$tab_c+"Item10"+$tab_c+"Item11"+$tab_c+"Item12"+$tab_c+"Item13"+$tab_c$t:=$t+"Item16"+$tab_c+"Item17"+$tab_c+"Item19"+$tab_c+"Item20"+$tab_c+"Item21"+$tab_c+"Item22"+$tab_c$t:=$t+"Item26"+$tab_c+"Item27"+$tab_c+"Item28"+$tab_c+"Item29"+$tab_c+"Item30"+$tab_c+"Item31"+$tab_c+"Item32"+$tab_c$t:=$t+"Item33"+$tab_c+"Item34"+$tab_c+"Item35"+$tab_c+"Item36"+$tab_c$t:=$t+"Item37"+$tab_c+"Item38"+$tab_c+"Item39"+$tab_c+"Item40"+$tab_c+"Item41"+$tab_c+"Item42"+$tab_c$t:=$t+"Item43"+$tab_c+"Item44"+$tab_c+"Item45"+$tab_c+"Item46"+$tab_c+"Item47"+$tab_c+"Item48"+$tab_c+"Item49"+$tab_c$t:=$t+"Item50"+$tab_c+"Item51"+$tab_c+"Item52"+$tab_c+"Item53"+$tab_c+"Item54"+$tab_c+"Item55"+$tab_c+"Item56"+$tab_c+"Item58"+$tab_c+"Item59"+$tab_c$t:=$t+"Item60"+$tab_c+"Item61"+$tab_c+"Item62"+$tab_c+"Item63"+$tab_c+"Item64"+$tab_c$t:=$t+"Item65"+$tab_c+"Item66"+$tab_c+"Item67"+$tab_c+"Item68"+$tab_c$t:=$t+"Item69"+$tab_c+"Item70"+$tab_c+"Item71"+$tab_c+"Item72"+$tab_c$t:=$t+"Item75"+$tab_c+"Item76"+$tab_c+"Item90"+$tab_c+"Item91"+$tab_c+"Item92"+$tab_c+"Item93"+$tab_c$t:=$t+"Item94"+$tab_c+"Item95"+$tab_c+"Item96"+$tab_c+"Item97"+$tab_c+"Item98"+$tab_c+"Item99"+$tab_c$t:=$t+"Item100"+$tab_c+"Item101"+$tab_c+"Item102"+$tab_c+"Item103"+$tab_c+"Item104"+$tab_c+"Item105"+$tab_c$t:=$t+"Item106"+$tab_c+"Item107"+$tab_c+"Item108"+$tab_c$t:=$t+"Item109"+$tab_c+"Item110"+$tab_c+"Item111"+$tab_c+"Item112"+$tab_c+"Item113"+$tab_c+"Item114"+$tab_c+"Item115"+$tab_c+"Item116"+$tab_c+$fill+◊sCR+◊sLFSEND PACKET($dExportFile;$t)$t:=""$k:=0$l:=0FIRST RECORD([BridgeMHDNBISArchive])For ($i;1;$Recs)$Item6A:=" "*24$Item6A:=Change string($Item6A;[BridgeMHDNBISArchive]Item6A;1)  `Added 3/6/98 by Tom Nee.If ([BridgeMHDNBISArchive]Item6B=True)$Item6B:="*"Else $Item6B:=" "End if $Item7:=" "*18$Item7:=Change string($Item7;[BridgeMHDNBISArchive]Item7;1)  `Added 3/6/98 by Tom Nee.$Item9:=" "*25$Item9:=Change string($Item9;[BridgeMHDNBISArchive]Item9;1)  `Added 3/6/98 by Tom Nee.$Item10:=String([BridgeMHDNBISArchive]Item10*100;"0000")$Item11:=String([BridgeMHDNBISArchive]Item11*1000;"0000000")If ([BridgeMHDNBISArchive]Item12=True)$Item12:="1"Else $Item12:="0"End if $Item13:=" "*12  `Added 3/10/98 by Tom Nee.$Item13:=Change string($Item13;[BridgeMHDNBISArchive]Item 13A;11-Length([BridgeMHDNBISArchive]Item 13A))  `Right justified, 10 chars.$Item13:=Change string($Item13;[BridgeMHDNBISArchive]Item 13B;13-Length([BridgeMHDNBISArchive]Item 13B))  `Right justified, 2 chars.$Item16:=String([BridgeMHDNBISArchive]Item16A;"00")+String([BridgeMHDNBISArchive]Item16B;"00")+String([BridgeMHDNBISArchive]Item16C*100;"0000")$Item17:=String([BridgeMHDNBISArchive]Item17A;"000")+String([BridgeMHDNBISArchive]Item17B;"00")+String([BridgeMHDNBISArchive]Item17C*100;"0000")$Item19:=String([BridgeMHDNBISArchive]Item19;"000")$Item27:=String([BridgeMHDNBISArchive]Item27;"0000")$Item28:=String([BridgeMHDNBISArchive]Item28A;"00")+String([BridgeMHDNBISArchive]Item28B;"00")$Item29:=String([BridgeMHDNBISArchive]Item29;"000000")$Item30:=String([BridgeMHDNBISArchive]Item30;"0000")$Item32:=String([BridgeMHDNBISArchive]Item32*10;"0000")$Item34:=String([BridgeMHDNBISArchive]Item34;"00")If ([BridgeMHDNBISArchive]Item35=True)$Item35:="1"Else $Item35:="0"End if   `These four lines are now in  HistoricalTrans.  TDN 12/24/98.       `      $Item37:=$Item37FHWA≤Position([BridgeMHDNBISArchive]Item37;$Item37code)≥  `      If (Position($Item37;$Item37FHWA)<1)  `        $Item37:="4"  `      End if $Item37:=HistoricalTrans ([BridgeMHDNBISArchive]Item37)$Item39:=String([BridgeMHDNBISArchive]Item39*10;"0000")$Item40:=String([BridgeMHDNBISArchive]Item40*10;"00000")$Item44:=" "*3$Item44:=Change string($Item44;[BridgeMHDNBISArchive]Item44;1)  `Added 3/10/98 by Tom Nee.$Item45:=String([BridgeMHDNBISArchive]Item45;"000")$Item46:=String([BridgeMHDNBISArchive]Item46;"0000")$Item47:=String([BridgeMHDNBISArchive]Item47*10;"000")$Item48:=String([BridgeMHDNBISArchive]Item48*10;"00000")  `3/21/01 Rounding before truncating  `$Item49:=String([BridgeMHDNBISArchive]Item49*10;"000000")$Item49:=String(Round([BridgeMHDNBISArchive]Item49;1)*10;"000000")  `End of change$Item50:=String([BridgeMHDNBISArchive]Item50A*10;"000")+String([BridgeMHDNBISArchive]Item50B*10;"000")  `3/21/01 Rounding before truncating  `$Item51:=String([BridgeMHDNBISArchive]Item51*10;"0000")$Item51:=String(Round([BridgeMHDNBISArchive]Item51;1)*10;"0000")  ` End of change$Item52:=String([BridgeMHDNBISArchive]Item52*10;"0000")$Item53:=String([BridgeMHDNBISArchive]Item53*100;"0000")$Item54:=" "$Item54:=Change string($Item54;[BridgeMHDNBISArchive]Item54A;1)$Item54:=$Item54+String([BridgeMHDNBISArchive]Item54B*100;"0000")$Item55:=" "$Item55:=Change string($Item55;[BridgeMHDNBISArchive]Item55A;1)$Item55:=$Item55+String([BridgeMHDNBISArchive]Item55B*10;"000")$Item56:=String([BridgeMHDNBISArchive]Item56*10;"000")$Item63:=" "$Item63:=Change string($Item63;[BridgeMHDNBISArchive]Item 63;1)If (Position($Item63;"-6-7-8-")>0)$Item64:=String([BridgeMHDNBISArchive]Item64*100;"000")Else $Item64:=String([BridgeMHDNBISArchive]Item64*10;"000")End if $Item65:=" "$Item65:=Change string($Item65;[BridgeMHDNBISArchive]Item 65;1)If (Position($Item65;"-6-7-8-")>0)$Item66:=String([BridgeMHDNBISArchive]Item66*100;"000")Else $Item66:=String([BridgeMHDNBISArchive]Item66*10;"000")End if $Item75:=" "*3  `Added 3/10/98 by Tom Nee.$Item75:=Change string($Item75;[BridgeMHDNBISArchive]Item75A;1)$Item75:=Change string($Item75;[BridgeMHDNBISArchive]Item75B;3)$Item76:=String([BridgeMHDNBISArchive]Item76*10;"000000")$m:=Month of([BridgeMHDNBISArchive]Item90)$y:=Year of([BridgeMHDNBISArchive]Item90)If ($y>1999)$y:=$y-2000Else $y:=$y-1900End if $Item90:=String($m;"00")+String($y;"00")$Item91:=String([BridgeMHDNBISArchive]Item91;"00")$Item92:=""If ([BridgeMHDNBISArchive]Item92AA=True)If (($igItem92a=True) & ([BridgeMHDNBISArchive]Item92AB>24))$crit:="Y24"Else $crit:="Y"+String([BridgeMHDNBISArchive]Item92AB;"00")End if $m:=Month of([BridgeMHDNBISArchive]Item93A)$y:=Year of([BridgeMHDNBISArchive]Item93A)Case of : ($y>1999)$y:=$y-2000$Item93A:=String($m;"00")+String($y;"00"): ($y>1900)$y:=$y-1900$Item93A:=String($m;"00")+String($y;"00"): ($y=0)$Item93A:=" "*4End case Else $crit:="N  "$Item93A:="    "End if $Item92:=$critIf ([BridgeMHDNBISArchive]Item92BA=True)$crit:="Y"+String([BridgeMHDNBISArchive]Item92BB;"00")$m:=Month of([BridgeMHDNBISArchive]Item93B)$y:=Year of([BridgeMHDNBISArchive]Item93B)Case of : ($y>1999)$y:=$y-2000$Item93B:=String($m;"00")+String($y;"00"): ($y>1900)$y:=$y-1900$Item93B:=String($m;"00")+String($y;"00"): ($y=0)$Item93B:=" "*4End case Else $crit:="N  "$Item93B:="    "End if $Item92:=$Item92+$critIf ([BridgeMHDNBISArchive]Item92CA=True)$crit:="Y"+String([BridgeMHDNBISArchive]Item92CB;"00")$m:=Month of([BridgeMHDNBISArchive]Item93C)$y:=Year of([BridgeMHDNBISArchive]Item93C)Case of : ($y>1999)$y:=$y-2000$Item93C:=String($m;"00")+String($y;"00"): ($y>1900)$y:=$y-1900$Item93C:=String($m;"00")+String($y;"00"): ($y=0)$Item93C:=" "*4End case Else $crit:="N  "$Item93C:="    "End if $Item92:=$Item92+$crit$Item94:=String([BridgeMHDNBISArchive]Item94;"000000")$Item95:=String([BridgeMHDNBISArchive]Item95;"000000")$Item96:=String([BridgeMHDNBISArchive]Item96;"000000")$Item97:=String([BridgeMHDNBISArchive]Item97;"0000")If (($igItem97=True) & ($Item97="0000"))$Item97:=String(Year of(Current date(*));"0000")End if If ([BridgeMHDNBISArchive]Item103=True)$Item103:="T"Else $Item103:=" "End if If ([BridgeMHDNBISArchive]Item104=True)$Item104:="1"Else $Item104:="0"End if $Item105:=" "  `Added 3/10/98 by Tom Nee.$Item105:=Change string($Item105;[BridgeMHDNBISArchive]Item 105;1)$Item106:=String([BridgeMHDNBISArchive]Item106;"0000")$Item109:=String([BridgeMHDNBISArchive]Item109;"00")If ([BridgeMHDNBISArchive]Item110=True)$Item110:="1"Else $Item110:="0"End if $Item111:=" "  `Added 3/10/98 by Tom Nee.$Item111:=Change string($Item111;[BridgeMHDNBISArchive]Item111;1)If ([BridgeMHDNBISArchive]Item112=True)$Item112:="Y"Else $Item112:="N"End if $Item113:=[BridgeMHDNBISArchive]Item113If ($Item113="D")$Item113:="6"End if $Item114:=String([BridgeMHDNBISArchive]Item114;"000000")$Item115:=String([BridgeMHDNBISArchive]Item115;"0000")$Item116:=String([BridgeMHDNBISArchive]Item116*10;"0000")C_TEXT($item8_txt)$item8_txt:=[BridgeMHDNBISArchive]Item8If ([BridgeMHDNBISArchive]FHWAItem8#"")$item8_txt:=[BridgeMHDNBISArchive]FHWAItem8End if $t:="251"+$tab_c+$item8_txt+$tab_c+[BridgeMHDNBISArchive]Item5+$tab_c+[BridgeMHDNBISArchive]Item2$t:=$t+$tab_c+[BridgeMHDNBISArchive]Item3+$tab_c+[BridgeMHDNBISArchive]Item4+$tab_c+$Item6A+$tab_c+$Item6B+$tab_c+$Item7$t:=$t+$tab_c+$Item9+$tab_c+$Item10+$tab_c+$Item11+$tab_c+$Item12+$tab_c+$Item13$t:=$t+$tab_c+$Item16+$tab_c+$Item17+$tab_c+$Item19+$tab_c+[BridgeMHDNBISArchive]Item20+$tab_c+[BridgeMHDNBISArchive]Item21+$tab_c+[BridgeMHDNBISArchive]Item22+$tab_c$t:=$t+$tab_c+[BridgeMHDNBISArchive]Item26+$tab_c+$Item27+$tab_c+$Item28+$tab_c+$Item29+$tab_c+$Item30+$tab_c+SIA_DesignLoadTrans ([BridgeMHDNBISArchive]Item31)+$tab_c+$Item32+$tab_c$t:=$t+[BridgeMHDNBISArchive]Item33+$tab_c+$Item34+$tab_c+$Item35+$tab_c+[BridgeMHDNBISArchive]Item36A+[BridgeMHDNBISArchive]Item36B+[BridgeMHDNBISArchive]Item36C+[BridgeMHDNBISArchive]Item36D+$tab_c$t:=$t+$Item37+$tab_c+[BridgeMHDNBISArchive]Item38+$tab_c+$Item39+$tab_c+$Item40+$tab_c+[BridgeMHDNBISArchive]Item41+$tab_c+[BridgeMHDNBISArchive]Item42+$tab_c$t:=$t+[BridgeMHDNBISArchive]Item43+$tab_c+$Item44+$tab_c+$Item45+$tab_c+$Item46+$tab_c+$Item47+$tab_c+$Item48+$tab_c+$Item49+$tab_c$t:=$t+$Item50+$tab_c+$Item51+$tab_c+$Item52+$tab_c+$Item53+$tab_c+$Item54+$tab_c+$Item55+$tab_c+$Item56+$tab_c+[BridgeMHDNBISArchive]Item58+$tab_c+[BridgeMHDNBISArchive]Item59+$tab_c$t:=$t+[BridgeMHDNBISArchive]Item60+$tab_c+[BridgeMHDNBISArchive]Item61+$tab_c+[BridgeMHDNBISArchive]Item62+$tab_c+$Item63+$tab_c+$Item64+$tab_c$t:=$t+$Item65+$tab_c+$Item66+$tab_c+[BridgeMHDNBISArchive]Item67+$tab_c+[BridgeMHDNBISArchive]Item68+$tab_c$t:=$t+[BridgeMHDNBISArchive]Item69+$tab_c+[BridgeMHDNBISArchive]Item70+$tab_c+[BridgeMHDNBISArchive]Item71+$tab_c+[BridgeMHDNBISArchive]Item72+$tab_c$t:=$t+$Item75+$tab_c+$Item76+$tab_c+$Item90+$tab_c+$Item91+$tab_c+$Item92+$tab_c+$Item93A+$Item93B+$Item93C+$tab_c$t:=$t+$Item94+$tab_c+$Item95+$tab_c+$Item96+$tab_c+$Item97+$tab_c+[BridgeMHDNBISArchive]Item98A+[BridgeMHDNBISArchive]Item98B+$tab_c+[BridgeMHDNBISArchive]Item99+$tab_c$t:=$t+[BridgeMHDNBISArchive]Item100+$tab_c+[BridgeMHDNBISArchive]Item101+$tab_c+[BridgeMHDNBISArchive]Item102+$tab_c+$Item103+$tab_c+$Item104+$tab_c+$Item105+$tab_c$t:=$t+$Item106+$tab_c+[BridgeMHDNBISArchive]Item107+$tab_c+[BridgeMHDNBISArchive]Item108A+[BridgeMHDNBISArchive]Item108B+[BridgeMHDNBISArchive]Item108C+$tab_c$t:=$t+$Item109+$tab_c+$Item110+$tab_c+$Item111+$tab_c+$Item112+$tab_c+$Item113+$tab_c+$Item114+$tab_c+$Item115+$tab_c+$Item116+$tab_c+$fill+◊sCR+◊sLFSEND PACKET($dExportFile;$t)$k:=$k+1  `Check to see if there is a secondary recordQUERY([NBISSecondaryArchive];[NBISSecondaryArchive]ArchiveReason_s=[BridgeMHDNBISArchive]ArchiveReason_s;*)QUERY([NBISSecondaryArchive]; & ;[NBISSecondaryArchive]ArchiveDate_d=[BridgeMHDNBISArchive]ArchiveDate_d)QUERY SELECTION([NBISSecondaryArchive];[NBISSecondaryArchive]BIN=[BridgeMHDNBISArchive]BIN)FIRST RECORD([NBISSecondaryArchive])For ($j;1;Records in selection([NBISSecondaryArchive]))$Item6A:=" "*24$Item6A:=Change string($Item6A;[NBISSecondaryArchive]Item6A;1)If ([NBISSecondaryArchive]Item6B=True)$Item6B:="*"Else $Item6B:=" "End if $Item7:=" "*18$Item7:=Change string($Item7;[NBISSecondaryArchive]Item7;1)$Item9:=" "*25$Item9:=Change string($Item9;[NBISSecondaryArchive]Item9;1)$Item10:=String([NBISSecondaryArchive]Item10*100;"0000")$Item11:=String([NBISSecondaryArchive]Item11*1000;"0000000")$Item16:=String([NBISSecondaryArchive]Item16A;"00")+String([NBISSecondaryArchive]Item16B;"00")+String([NBISSecondaryArchive]Item16C*100;"0000")$Item17:=String([NBISSecondaryArchive]Item17A;"000")+String([NBISSecondaryArchive]Item17B;"00")+String([NBISSecondaryArchive]Item17C*100;"0000")$Item19:=String([NBISSecondaryArchive]Item19;"000")$Item27:=String([NBISSecondaryArchive]Item27;"0000")$Item28:=String([NBISSecondaryArchive]Item28A;"00")+String([NBISSecondaryArchive]Item28B;"00")$Item29:=String([NBISSecondaryArchive]Item29;"000000")$Item30:=String([NBISSecondaryArchive]Item30;"0000")$Item47:=String([NBISSecondaryArchive]Item47*10;"000")$Item48:=String([NBISSecondaryArchive]Item48*10;"00000")$Item49:=String([NBISSecondaryArchive]Item49*10;"000000")If ([NBISSecondaryArchive]Item103=True)$Item103:="T"Else $Item103:=" "End if If ([NBISSecondaryArchive]Item104=True)$Item104:="1"Else $Item104:="0"End if $Item109:=String([NBISSecondaryArchive]Item109;"00")If ([NBISSecondaryArchive]Item110=True)$Item110:="1"Else $Item110:="0"End if   `$t:="251"+$tab_c+[BridgeMHDNBISArchive]Item8+$tab_c+[NBISSecondaryArchive]Item5+$tab_c+(" "*2)+$tab_c  `$t:=$t+[NBISSecondaryArchive]Item3+$tab_c+[NBISSecondaryArchive]Item4+$tab_c+$Item6A+$Item6B+$tab_c+$Item7+$tab_c  `$t:=$t+$Item9+$tab_c+$Item10+$tab_c+$Item11+$tab_c+(" "*13)+$tab_c  `$t:=$t+$Item16+$tab_c+$Item17+$tab_c+$Item19+$tab_c+[NBISSecondaryArchive]Item20+$tab_c+(" "*4)  `$t:=$t+[NBISSecondaryArchive]Item26+$tab_c+$Item27+$tab_c+$Item28+$tab_c+$Item29+$tab_c+$Item30+$tab_c+(" "*5)  `$t:=$t+(" "*8)  `$t:=$t+(" "*12)+[NBISSecondaryArchive]Item42+$tab_c  `$t:=$t+[NBISSecondaryArchive]Item43+$tab_c+(" "*10)+$Item47+$tab_c+$Item48+$tab_c+$Item49+$tab_c  `$t:=$t+(" "*127)  `$t:=$t+[NBISSecondaryArchive]Item100+$tab_c+[NBISSecondaryArchive]Item101+$tab_c+[NBISSecondaryArchive]Item102+$tab_c+$Item103+$tab_c+$Item104+$tab_c  `$t:=$t+(" "*9)  `$t:=$t+$Item109+$tab_c+$Item110+$tab_c+(" "*17)+$fill+◊sCR+◊sLF$t:="251"+$tab_c+[BridgeMHDNBISArchive]Item8+$tab_c+[NBISSecondaryArchive]Item5+$tab_c+" "$t:=$t+$tab_c+[NBISSecondaryArchive]Item3+$tab_c+[NBISSecondaryArchive]Item4+$tab_c+$Item6A+$Item6B+$tab_c+$Item7$t:=$t+$tab_c+$Item9+$tab_c+$Item10+$tab_c+$Item11+$tab_c+" "+$tab_c+" "$t:=$t+$tab_c+$Item16+$tab_c+$Item17+$tab_c+$Item19+$tab_c+[NBISSecondaryArchive]Item20+$tab_c+" "+$tab_c+" "+$tab_c$t:=$t+$tab_c+[NBISSecondaryArchive]Item26+$tab_c+$Item27+$tab_c+$Item28+$tab_c+$Item29+$tab_c+$Item30+$tab_c+" "+$tab_c+" "+$tab_c$t:=$t+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+" "+" "+" "+$tab_c$t:=$t+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c+[NBISSecondaryArchive]Item42+$tab_c$t:=$t+[NBISSecondaryArchive]Item43+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c+$Item47+$tab_c+$Item48+$tab_c+$Item49+$tab_c$t:=$t+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c$t:=$t+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c$t:=$t+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c$t:=$t+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c$t:=$t+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+" "+" "+$tab_c$t:=$t+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+" "+$tab_c+" "+$tab_c$t:=$t+[NBISSecondaryArchive]Item100+$tab_c+[NBISSecondaryArchive]Item101+$tab_c+[NBISSecondaryArchive]Item102+$tab_c+$Item103+$tab_c+$Item104+$tab_c+" "+$tab_c$t:=$t+" "+$tab_c+" "+$tab_c+" "+" "+" "+$tab_c$t:=$t+$Item109+$tab_c+$Item110+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c+" "+$tab_c+$fill+◊sCR+◊sLFSEND PACKET($dExportFile;$t)$k:=$k+1NEXT RECORD([NBISSecondaryArchive])End for NEXT RECORD([BridgeMHDNBISArchive])If ($k%$Interval=0)  `Don't slow down things just to displayUpdateProgress ($i;$Recs)End if   ` check to see if aborted from the Progress windowIf (◊Abort)$i:=$Recs+1End if End for CALL PROCESS(◊ProgressPID)CLOSE DOCUMENT($dExportFile)CLOSE DOCUMENT($dErrFile)ALERT(String($k;"##,##0")+" total records (primary & secondary) exported successfully to "+$vsOutputFolder+$NBfile)If ($l>0)ALERT(String($l;"##,##0")+" total records (primary & secondary) with errors placed in "+$vsOutputFolder+$NBErrfile)ut_OpenDocument ($vsOutputFolder+$NBErrfile)End if End if End if   `NO TRACE3  `End ARCHIVE_ExportNBI  `End ARCHIVE_ExportNBItabDelim