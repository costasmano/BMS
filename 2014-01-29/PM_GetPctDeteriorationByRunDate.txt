  `Method: PM_GetPctDeteriorationByRunDate  `Description  `   ` Parameters  ` $0 : $PctDet  ` $1 : $RunDate_d (optional)  ` $2 : $BIN_s (Optional)  ` ----------------------------------------------------If (False)  ` ----------------------------------------------------  `User name (OS): Costas Manousakis  `User (4D) : Designer  `Date and time: 01/29/14, 10:26:53  ` ----------------------------------------------------  `Created : Mods_2014_01 End if   `C_REAL($0;$PctDet)$PctDet:=0C_DATE($RunDate_d)$RunDate_d:=[Pontis_Metrics]PM_ImportDate_dIf (Count parameters>0)C_DATE($1)If ($1#!00/00/00!)$RunDate_d:=$1End if End if C_STRING(3;$BIN_s)$BIN_s:=[Bridge MHD NBIS]BINIf (Count parameters>1)C_STRING(3;$2)$BIN_s:=$2End if C_REAL($StartHI_r;$EndHI_r)$StartHI_r:=0$EndHI_r:=0C_TEXT($uniqueKey_txt)QUERY([Pontis_Metrics];[Pontis_Metrics]PM_ImportDate_d=$RunDate_d)$uniqueKey_txt:=$BIN_s+"-"+String([Pontis_Metrics]PM_RunKey_l;"000000000")ARRAY REAL($HIs_ar;0)ARRAY LONGINT($Years_aL;0)QUERY([Pontis_Metric_Data];[Pontis_Metric_Data]PM_UNiqueKey_s=$uniqueKey_txt)ARRAY REAL($HIs_ar;Records in selection([Pontis_Metric_Data]))ARRAY LONGINT($Years_aL;Records in selection([Pontis_Metric_Data]))SELECTION TO ARRAY([Pontis_Metric_Data]PMD_Hindex_r;$HIs_ar;[Pontis_Metric_Data]PMD_YKey_l;$Years_aL)If (Size of array($HIs_ar)>0)SORT ARRAY($Years_aL;$HIs_ar)$StartHI_r:=$HIs_ar{1}$EndHI_r:=$HIs_ar{Size of array($HIs_ar)}End if If ($StartHI_r>0)$PctDet:=($StartHI_r-$EndHI_r)/$StartHI_rEnd if $0:=$PctDet  `End PM_GetPctDeteriorationByRunDate