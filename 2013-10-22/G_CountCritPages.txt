  `G_CountCritPages If (False)  ` Modified by: Costas Manousakis-(Designer)-(10/22/13 11:15:14)Mods_2013_10   `  `added flag that pages were counted -  count if the inspection is open for editing  `  `or is locked and it has not been counted yetEnd if If (Not(vbInspectionLocked) | (vbInspectionLocked & Not(INSP_PageCountDone_b)))C_LONGINT($recnum)SET QUERY DESTINATION(Into variable ;$recnum)QUERY SELECTION([ElementsSafety];[ElementsSafety]Rating#"N")SET QUERY DESTINATION(Into current selection )C_INTEGER(viNumPg1s)C_INTEGER(viNumCmtsPgs;viCmtsPgStart;viSkPgStart;viChPgStart;viPhPgStart)C_INTEGER(viNumSkPgs;viNumChPgs;viNumPhPgs)$recnum:=Records in selection([ElementsSafety])viNumPg1s:=-(Trunc(-($recnum/5);0))  `Comments pagesviNumCmtsPgs:=Print_Dive_Cmt_a_new (False)viCmtsPgStart:=viNumPg1s+1G_CountInspImagePgs vTotalPages:=viNumPg1s+viNumCmtsPgs+viNumSkPgs+viNumChPgs+viNumPhPgsINSP_PageCountDone_b:=TrueEnd if 