If (False)ÊÊ`Procedure: CheckDependenciesÊÊ`MHD Bridge InspectionÊÊ`Created By: Albert LeungÊÊ`Date:  7/10/2003ÊÊ`Purpose: checks differences between other reports and inspection report.ÊÊ`Uses: [Dialogs];"DependencyCheck"Mods_2005_CM01 Mods_2005_CM05 ÊÊ` Modified by: costasmanousakis-(Designer)-(11/3/2005 14:21:31)Mods_2005_CM18 ÊÊ` Modified by: costasmanousakis-(Designer)-(8/9/2007 14:31:28)Mods_2007_CM12_5301 ÊÊ` Modified by: costasmanousakis-(Designer)-(8/22/2007 15:44:51)Mods_2007_CM12_5301 Mods_2009_03 ÊÊ`CJM  r001   `03/06/09, 14:17:53`Upgrade from open form window to open windowÊÊ`ÊÊ` Modified by: Costas Manousakis-(Designer)-(2/7/14 12:27:56)Mods_2014_02ÊÊ`ÊÊ`need to add check for routine insp date if insp type is other than routine highway or tunnel !!!!!!End if C_STRING(255;vtxtStructTypeInsp;vtxtStructTypeSIA;vtxtItem107Insp;vtxtItem107SIA)C_STRING(255;vtxtItem21Insp;vtxtItem21SIA;vtxtItem22Insp;vtxtItem22SIA)C_STRING(255;vtxtItem26Insp;vtxtItem26SIA;vtxtItem106Insp;vtxtItem106SIA)C_STRING(10;vtxtWeightPosting;vtxtWeightPostingInsp)C_STRING(1;vItem43a_temp)C_STRING(2;vItem43b_temp)C_BOOLEAN(vblnChkItem43;vblnChkItem107;vblnWeightPosting;vblnRatingReport;vblnRatingDate)C_BOOLEAN(vblnRecomPostingH;vblnRecomPosting3;vblnRecomPosting3S2;vblnRecomPostingSgl)C_BOOLEAN(vblnEDJMTDate;vblnWaivedDate;vblnChkItem21;vblnChkItem22;vblnChkItem26;vblnChkItem106)C_BOOLEAN($blnDoCheck)C_STRING(255;vtxtRatingReportInsp;vtxtRatingReport)C_STRING(255;vtxtRatingDateInsp;vtxtRatingDate;vtxtRecomPostingHInsp;vtxtRecomPostingH)C_STRING(255;vtxtRecomPosting3Insp;vtxtRecomPosting3;vtxtRecomPosting3S2Insp;vtxtRecomPosting3S2)C_STRING(255;vtxtRecomPostingSglInsp;vtxtRecomPostingSgl)vtxtEDJMTDateInsp:=""vtxtEDJMTDate:=""vtxtWaivedDateInsp:=""vtxtWaivedDate:=""vtxtStructTypeInsp:=""vtxtStructTypeSIA:=""vtxtItem107Insp:=""vtxtItem107SIA:=""vtxtItem21Insp:=""vtxtItem21SIA:=""vtxtItem22Insp:=""vtxtItem22SIA:=""vtxtItem26Insp:=""vtxtItem26SIA:=""vtxtItem106Insp:=""vtxtItem106SIA:=""vtxtWeightPosting:=""vtxtWeightPostingInsp:=""vItem43a_temp:=""vItem43b_temp:=""vtxtRatingReportInsp:=""vtxtRatingReport:=""vtxtRatingDateInsp:=""vtxtRatingDate:=""vtxtRecomPostingHInsp:=""vtxtRecomPostingH:=""vtxtRecomPosting3Insp:=""vtxtRecomPosting3:=""vtxtRecomPosting3S2Insp:=""vtxtRecomPosting3S2:=""vtxtRecomPostingSglInsp:=""vtxtRecomPostingSgl:=""vItem43a_temp:=Substring([Inspections]Item 43;1;1)vItem43b_temp:=Substring([Inspections]Item 43;2;2)vtxtStructTypeInsp:=Get_Description (->×aMaterial;->×aMatCode;->vItem43a_temp)+" "+Get_Description (->×aDesign;->×aDesignCod;->vItem43b_temp)vItem43a_temp:=Substring([Bridge MHD NBIS]Item43;1;1)vItem43b_temp:=Substring([Bridge MHD NBIS]Item43;2;2)vtxtStructTypeSIA:=Get_Description (->×aMaterial;->×aMatCode;->vItem43a_temp)+" "+Get_Description (->×aDesign;->×aDesignCod;->vItem43b_temp)vtxtItem107Insp:=Get_Description (->×aDeck;->×aDeckCod;->[Inspections]Item 107)vtxtItem107SIA:=Get_Description (->×aDeck;->×aDeckCod;->[Bridge MHD NBIS]Item107)vtxtItem21Insp:=Get_Description (->×aMaintOwner;->×aMaintCod;->[Inspections]Item21)vtxtItem21SIA:=Get_Description (->×aMaintOwner;->×aMaintCod;->[Bridge MHD NBIS]Item21)vtxtItem22Insp:=Get_Description (->×aMaintOwner;->×aMaintCod;->[Inspections]Item22)vtxtItem22SIA:=Get_Description (->×aMaintOwner;->×aMaintCod;->[Bridge MHD NBIS]Item22)vtxtItem26Insp:=Get_Description (->×aFC;->×aFC_Cod;->[Inspections]Item26)vtxtItem26SIA:=Get_Description (->×aFC;->×aFC_Cod;->[Bridge MHD NBIS]Item26)vtxtItem106Insp:=String([Inspections]Item106;"0000")vtxtItem106SIA:=String([Bridge MHD NBIS]Item106;"0000")vblnChkItem43:=([Inspections]Item 43#[Bridge MHD NBIS]Item43)vblnChkItem107:=([Inspections]Item 107#[Bridge MHD NBIS]Item107)vblnChkItem106:=([Inspections]Item106#[Bridge MHD NBIS]Item106)vblnChkItem21:=([Inspections]Item21#[Bridge MHD NBIS]Item21)vblnChkItem22:=([Inspections]Item22#[Bridge MHD NBIS]Item22)vblnChkItem26:=([Inspections]Item26#[Bridge MHD NBIS]Item26)ÊÊ`Check ratingsIf ([Inspections]Rating Report)vtxtRatingReportInsp:="Rating report exists"Else vtxtRatingReportInsp:="No rating report available"End if vtxtRatingDateInsp:=f_Date2String ([Inspections]Rating Date;Internal date short ;"-")If ([Inspections]WeightPosting)vtxtWeightPostingInsp:="True"Else vtxtWeightPostingInsp:="False"End if vtxtRecomPostingHInsp:=String([Inspections]RecomPostingH;"00")vtxtRecomPosting3Insp:=String([Inspections]RecomPosting3;"00")vtxtRecomPosting3S2Insp:=String([Inspections]RecomPosting3S2;"00")vtxtRecomPostingSglInsp:=String([Inspections]RecomPostingSgl;"00")vtxtEDJMTDateInsp:=f_Date2String ([Inspections]EDJMT Date;Internal date short ;"-")vtxtWaivedDateInsp:=f_Date2String ([Inspections]WaivedDate;Internal date short ;"-")If ([Bridge MHD NBIS]PostingStatus="EJDMNT")vtxtEDJMTDate:=f_Date2String ([Bridge MHD NBIS]PostingDate;Internal date short ;"-")Else vtxtEDJMTDate:="-"End if If ([Bridge MHD NBIS]PostingStatus="WAIVED")vtxtWaivedDate:=f_Date2String ([Bridge MHD NBIS]PostingDate;Internal date short ;"-")Else vtxtWaivedDate:="-"End if vblnEDJMTDate:=(vtxtEDJMTDate#vtxtEDJMTDateInsp)vblnWaivedDate:=(vtxtWaivedDate#vtxtWaivedDateInsp)READ ONLY([RatingReports])QUERY([RatingReports];[RatingReports]BIN=[Inspections]BIN)C_INTEGER($vlLastYr)If ([Bridge MHD NBIS]Item106>0)$vlLastYr:=[Bridge MHD NBIS]Item106Else $vlLastYr:=[Bridge MHD NBIS]Item27End if C_DATE($vdLastDate)$vdLastDate:=Date("01/01/"+String($vlLastYr;"0000"))QUERY SELECTION([RatingReports];[RatingReports]ReportDate>=$vdLastDate)If (Records in selection([RatingReports])>0)vtxtRatingReport:="Rating report exists"ORDER BY([RatingReports];[RatingReports]ReportDate;<)FIRST RECORD([RatingReports])vtxtRatingDate:=f_Date2String ([RatingReports]ReportDate;Internal date short ;"-")vtxtRecomPostingH:=String([RatingReports]RecPostingH;"00")vtxtRecomPosting3:=String([RatingReports]RecPost3;"00")vtxtRecomPosting3S2:=String([RatingReports]RecPost3S2;"00")If (([RatingReports]RecPostingH=[RatingReports]RecPost3)Ê&Ê([RatingReports]RecPost3=[RatingReports]RecPost3S2))vtxtRecomPostingSgl:=String([RatingReports]RecPostingH;"00")Else vtxtRecomPostingSgl:="00"End if Else vtxtRatingReport:="No rating report available"vtxtRatingDate:="-"vtxtRecomPostingH:="00"vtxtRecomPosting3:="00"vtxtRecomPosting3S2:="00"vtxtRecomPostingSgl:="00"End if If ([Bridge MHD NBIS]PostingStatus="POSTED")ÊÊ`check to see what is in the NBI tablevtxtWeightPosting:="True"Else vtxtWeightPosting:="False"End if vblnRatingDate:=(vtxtRatingDate#vtxtRatingDateInsp)vblnRatingReport:=(vtxtRatingReport#vtxtRatingReportInsp)vblnWeightPosting:=(vtxtWeightPosting#vtxtWeightPostingInsp)vblnRecomPostingH:=(vtxtRecomPostingH#vtxtRecomPostingHInsp)vblnRecomPosting3:=(vtxtRecomPosting3#vtxtRecomPosting3Insp)vblnRecomPosting3S2:=(vtxtRecomPosting3S2#vtxtRecomPosting3S2Insp)vblnRecomPostingSgl:=(vtxtRecomPostingSgl#vtxtRecomPostingSglInsp)ÊÊ`Do the check$blnDoCheck:=(vblnChkItem43Ê|ÊvblnChkItem107Ê|ÊvblnWeightPostingÊ|ÊvblnRatingReport)$blnDoCheck:=($blnDoCheckÊ|ÊvblnRatingDateÊ|ÊvblnRecomPostingHÊ|ÊvblnRecomPosting3)$blnDoCheck:=($blnDoCheckÊ|ÊvblnRecomPosting3S2Ê|ÊvblnRecomPostingSglÊ|ÊvblnEDJMTDate)$blnDoCheck:=($blnDoCheckÊ|ÊvblnWaivedDate)$blnDoCheck:=($blnDoCheckÊ|ÊvblnChkItem106Ê|ÊvblnChkItem21Ê|ÊvblnChkItem22Ê|ÊvblnChkItem26)$blnDoCheck:=($blnDoCheckÊ&ÊNot([Inspections]DoNotShowDialogDependency))If ($blnDoCheck)C_LONGINT($Width_l;$Height_l;$Win_l;$Pages_l)C_BOOLEAN($FixedWidth_b;$FixedHeight_b)C_TEXT($Title_txt)GET FORM PROPERTIES([Dialogs];"DependencyCheck";$Width_l;$Height_l;$Pages_l;$FixedWidth_b;$FixedHeight_b;$Title_txt)$Win_l:=ut_OpenNewWindow ($Width_l;$Height_l;0;Plain no zoom box window ;$Title_txt;"ut_CloseCancel")ÊÊ`$FormWindow:=Open form window([Dialogs];"DependencyCheck";(Plain no zoom box window ))DIALOG([Dialogs];"DependencyCheck")CLOSE WINDOWIf (OK=1)If (blnStructureType=1)[Inspections]Item 43:=[Bridge MHD NBIS]Item43PushChange (1;->[Inspections]Item 43)INSP_Item43Desc End if If (blnItem107=1)[Inspections]Item 107:=[Bridge MHD NBIS]Item107PushChange (1;->[Inspections]Item 107)INSP_Item107Desc End if If (blnItem106=1)[Inspections]Item106:=[Bridge MHD NBIS]Item106PushChange (1;->[Inspections]Item106)End if If (blnItem21=1)[Inspections]Item21:=[Bridge MHD NBIS]Item21PushChange (1;->[Inspections]Item21)End if If (blnItem22=1)[Inspections]Item22:=[Bridge MHD NBIS]Item22PushChange (1;->[Inspections]Item22)End if If (blnItem26=1)[Inspections]Item26:=[Bridge MHD NBIS]Item26PushChange (1;->[Inspections]Item26)End if If (blnWeightPosting=1)G_CBWeightPosting (([Bridge MHD NBIS]PostingStatus#"POSTED"))End if If (blnRatingReport=1)[Inspections]Rating Report:=(Records in selection([RatingReports])>0)PushChange (1;->[Inspections]Rating Report)End if If (blnRatingDate=1)If (Records in selection([RatingReports])>0)[Inspections]Rating Date:=[RatingReports]ReportDateElse [Inspections]Rating Date:=!00/00/00!End if PushChange (1;->[Inspections]Rating Date)End if If (blnRecomPostingH=1)If (Records in selection([RatingReports])>0)[Inspections]RecomPostingH:=[RatingReports]RecPostingHElse [Inspections]RecomPostingH:=0End if PushChange (1;->[Inspections]RecomPostingH)End if If (blnRecomPosting3=1)If (Records in selection([RatingReports])>0)[Inspections]RecomPosting3:=[RatingReports]RecPost3Else [Inspections]RecomPosting3:=0End if PushChange (1;->[Inspections]RecomPosting3)End if If (blnRecomPosting3S2=1)If (Records in selection([RatingReports])>0)[Inspections]RecomPosting3S2:=[RatingReports]RecPost3S2Else [Inspections]RecomPosting3S2:=0End if PushChange (1;->[Inspections]RecomPosting3S2)End if If (blnRecomPostingSgl=1)If (Records in selection([RatingReports])>0)If (([RatingReports]RecPostingH=[RatingReports]RecPost3)Ê&Ê([RatingReports]RecPost3=[RatingReports]RecPost3S2))[Inspections]RecomPostingSgl:=[Inspections]RecomPostingHElse [Inspections]RecomPostingSgl:=0End if Else [Inspections]RecomPostingSgl:=0End if PushChange (1;->[Inspections]RecomPostingSgl)End if If (blnEDJMTDate=1)If ([Bridge MHD NBIS]PostingStatus="EJDMNT")[Inspections]EDJMT Date:=[Bridge MHD NBIS]PostingDateElse [Inspections]EDJMT Date:=!00/00/00!End if PushChange (1;->[Inspections]EDJMT Date)End if If (blnWaivedDate=1)If ([Bridge MHD NBIS]PostingStatus="WAIVED")[Inspections]WaivedDate:=[Bridge MHD NBIS]PostingDateElse [Inspections]WaivedDate:=!00/00/00!End if PushChange (1;->[Inspections]WaivedDate)End if If (blnDontAskAgain=1)[Inspections]DoNotShowDialogDependency:=TrueEnd if End if End if 