  ` Method: Form Method: [Inspections]FreezeThawA  ` Description  `   `   ` Parameters  ` ----------------------------------------------------If (False)  ` ----------------------------------------------------  ` User name (OS): Costas Manousakis  ` User name (4D): Designer  ` Date and time: 02/07/14, 12:26:03  ` ----------------------------------------------------  ` First ReleaseMods_2014_02End if C_STRING(255;vInspTitle;vInspDateLbl)C_STRING(3;CurCat)Case of : (Form event=On Load )Case of : ([Bridge MHD NBIS]InspResp="MBTA")SET VISIBLE(*;"MBTAText@";True)SET VISIBLE(*;"NonMBTAText@";False)Else SET VISIBLE(*;"MBTAText@";False)SET VISIBLE(*;"NonMBTAText@";True)End case START TRANSACTION  `## Initialize transfer dataInitChangeStack (1)C_LONGINT(FRZNoProblem_L;FRZNotAppl_L;FRZNoAction_L;$loop_L)C_BOOLEAN(bDiveFormValid)bDiveFormValid:=FalseC_TEXT(FRZFieldTests_txt)vInspTitle:=[Inspection Type]Description+" Inspection"vInspDateLbl:="Inspection Date"INSP_Item43Desc INSP_Item107Desc SET VISIBLE(*;"PrintPreviewPicture";False)G_Insp_RelateInsp (->[ElementsSafety]InspID;->[Standard Photos]InspID;->[Field Trip]InspID)ORDER BY([ElementsSafety]InspID;[ElementDict]ElementNo;>)CurCat:="ALL"ARRAY LONGINT(alElmtSftyPulldwnID;0)ARRAY INTEGER($elmtNo_ai;0)SELECTION TO ARRAY([ElementsSafety]ElmSafetyID;alElmtSftyPulldwnID;[ElementsSafety]ElementNo;$elmtNo_ai)ARRAY STRING(80;asElmtSftyPulldwnName;Size of array(alElmtSftyPulldwnID))For ($loop_L;1;Size of array(alElmtSftyPulldwnID))asElmtSftyPulldwnName{$loop_L}:=INSP_FRZElmtDesc ($elmtNo_ai{$loop_L})End for   `ImagesG_InitInspImages   `Check on security...G_SecureInspection If (vbInspectionLocked)  `disable entry if inspection is lockedG_Insp_LockFormOnOff (True)Else   `otherwise make sure they are enterable    G_Insp_LockFormOnOff (False)If ((([Inspections]InspReviewed=BMS Not Reviewed )) & ([Inspections]Item 93b=!00/00/00!))If ([Bridge MHD NBIS]Item92BB>0)[Inspections]Item 93b:=[Bridge MHD NBIS]Item93BEnd if If ([Inspections]Item 93b#!00/00/00!)PushChange (1;->[Inspections]Item 93b)End if End if   `Alert user to differences in dependent dataCheckDependencies G_ReplyBtnCfg End if G_Insp_SetPersUI End case 