ÊÊ` Method: LB_TasksÊÊ` DescriptionÊÊ` ÊÊ` ParametersÊÊ` $1 : $Task_txt ("SETWINDOWTITLE" | "SHOWALL" | "SHOWSELECTION" | "OMITSELECTION" | "CLEARHEADERS" | "QUERY" | "QUERYSELECTION"ÊÊ` "ORDER" | "DESELECTALL")ÊÊ` ----------------------------------------------------If (False)ÊÊ` User name (OS): Costas ManousakisÊÊ` User name (4D): DesignerÊÊ` Date and time: 01/14/14, 16:09:55ÊÊ` ----------------------------------------------------ÊÊ` First ReleaseMods_2014_01End if C_TEXT($1;$Task_txt)$Task_txt:=$1Case of : ($Task_txt="SHOWALL")ALL RECORDS(LB_Table_ptr->)LB_Tasks ("CLEARHEADERS")LB_Tasks ("DESELECTALL")LB_Tasks ("SETWINDOWTITLE"): ($Task_txt="SHOWSELECTION")If (Records in set(LB_HiliteSetName_txt)>0)USE SET(LB_HiliteSetName_txt)LB_Tasks ("CLEARHEADERS")LB_Tasks ("DESELECTALL")LB_Tasks ("SETWINDOWTITLE")Else ALERT("No Records have been Selected!")End if : ($Task_txt="OMITSELECTION")If (Records in set(LB_HiliteSetName_txt)>0)CREATE SET(LB_Table_ptr->;"MyLocalSet")DIFFERENCE("MyLocalSet";LB_HiliteSetName_txt;LB_HiliteSetName_txt)USE SET(LB_HiliteSetName_txt)CLEAR SET("MyLocalSet")ÊÊ`CLEAR SET("SelectedRecordsSet")LB_Tasks ("CLEARHEADERS")LB_Tasks ("DESELECTALL")LB_Tasks ("SETWINDOWTITLE")Else ALERT("No Records have been Selected to Omit!")End if : ($Task_txt="SORT")ORDER BY(LB_Table_ptr->)If (OK=1)LB_Tasks ("CLEARHEADERS")LB_Tasks ("DESELECTALL")End if : ($Task_txt="QUERY")COPY NAMED SELECTION(LB_Table_ptr->;"LBPREQUERYSELECTION")QUERY(LB_Table_ptr->)If (OK=1)If (Records in selection(LB_Table_ptr->)>0)LB_Tasks ("CLEARHEADERS")LB_Tasks ("DESELECTALL")LB_Tasks ("SETWINDOWTITLE")Else ALERT("No Records were found!!")USE NAMED SELECTION("LBPREQUERYSELECTION")End if CLEAR NAMED SELECTION("LBPREQUERYSELECTION")End if : ($Task_txt="QUERYSELECTION")COPY NAMED SELECTION(LB_Table_ptr->;"LBPREQUERYSELECTION")QUERY SELECTION(LB_Table_ptr->)If (OK=1)If (Records in selection(LB_Table_ptr->)>0)LB_Tasks ("CLEARHEADERS")LB_Tasks ("DESELECTALL")LB_Tasks ("SETWINDOWTITLE")Else ALERT("No Records were found!!")USE NAMED SELECTION("LBPREQUERYSELECTION")End if CLEAR NAMED SELECTION("LBPREQUERYSELECTION")End if : ($Task_txt="CLEARHEADERS")C_LONGINT($numcols)ARRAY TEXT($arrColNames_atxt;0)ARRAY TEXT($ColHdrNames_atxt;0)ARRAY POINTER($ColVars;0)ARRAY POINTER($HeaderVars;0)ARRAY BOOLEAN($colVis;0)ARRAY POINTER($ColStyles;0)GET LISTBOX ARRAYS(*;LB_ListboxName_txt;$arrColNames_atxt;$ColHdrNames_atxt;$ColVars;$HeaderVars;$colVis;$ColStyles)C_LONGINT($loop_L)For ($loop_L;1;Size of array($HeaderVars))$HeaderVars{$loop_L}->:=0End for : ($Task_txt="SETWINDOWTITLE")SET WINDOW TITLE(LB_WindowTitle_txt+" - Displaying ["+String(Records in selection(LB_Table_ptr->);"###,###,##0")+" out of "+String(Records in table(LB_Table_ptr->);"###,###,##0")+"] records"): ($Task_txt="DESELECTALL")CREATE EMPTY SET(LB_Table_ptr->;LB_HiliteSetName_txt)End case 