If (False)  `Form Method: [Inspections]TunnelInspection   ` Modified by: Costas Manousakis-(Designer)-(4/16/13 09:34:27)Mods_2013_04 End if C_STRING(255;vInspTitle)C_STRING(3;CurCat)C_INTEGER($i;$j;$k)C_INTEGER($pageClicked)Case of : (Form event=On Load )Case of : ([Bridge MHD NBIS]InspResp="MBTA")SET VISIBLE(*;"MBTAText@";True)SET VISIBLE(*;"NonMBTAText@";False)Else SET VISIBLE(*;"MBTAText@";False)SET VISIBLE(*;"NonMBTAText@";True)End case INSP_SetWPHeadings   `try transactions for data entered in include forms and updated via buttonsSTART TRANSACTION  `## Initialize transfer dataInitChangeStack (1)InitChangeStack (2)  `for sub-elementsInitChangeStack (3)  `for bms inspections recordInitChangeStack (4)  `for combined inspections recordInitChangeStack (5)  `for Tunnel inspections recordC_BOOLEAN(bDiveFormValid)bDiveFormValid:=FalseINSP_Item43Desc INSP_Item107Desc G_Insp_RelateInsp (->[ElementsSafety]InspID;->[Standard Photos]InspID;->[Field Trip]InspID)READ ONLY([TunnelInfo])QUERY([TunnelInfo];[TunnelInfo]BIN=[Bridge MHD NBIS]BIN)LOAD RECORD([TunnelInfo])QUERY([TunnelInspection];[TunnelInspection]InspID=[Inspections]InspID)INSP_LoadElmLabelsforReport ([Inspections]Insp Type)INSP_LoadaInspType_ G_InspElmtCatPopup   `Check boxesIf ([Inspections]WeightPosting=True)CBWeightPos:=0Else CBWeightPos:=1End if If ([Inspections]ClrPosting=True)CBClrPost:=0Else CBClrPost:=1End if POPUPMENUC (->aStreamFlow;->aStreamCode;->[Inspections]StreamFlowV)POPUPMENUC (->aPedTraffNE;->aPedTraffCode;->[Inspections]PedBarricadesNE)POPUPMENUC (->aPedTraffSW;->aPedTraffCode;->[Inspections]PedBarricadesSW)Case of : ([Inspections]RatingPriority="H")x1:=1: ([Inspections]RatingPriority="M")x2:=1: ([Inspections]RatingPriority="L")x3:=1End case   `ImagesG_InitInspImages   `set the titlevInspTitle:=G_Insp_SetTitle G_Insp_FormatInpTitle If (Position("Special";vInspTitle)>0)SET VISIBLE(*;"@Initial";True)Else SET VISIBLE(*;"@Initial";False)End if   `Check on security...G_SecureInspection   `2004-05-26 ASL  `This was saved before we startedRememberCombined INSP_PontisCTRL ("INIT")If ([Combined Inspections]BMSInspID>0)If ([BMS Inspections]Metric)tbMetric:=1tbEnglish:=0Else tbMetric:=0tbEnglish:=1End if End if If (vbInspectionLocked)  `disable entry if inspection is lockedG_Insp_LockFormOnOff (True)Else   `otherwise make sure they are enterable    G_Insp_LockFormOnOff (False)If (([Inspections]InspReviewed=BMS Not Reviewed ) & ([Inspections]Item 93b=!00/00/00!))If ([Bridge MHD NBIS]Item92BB>0)[Inspections]Item 93b:=[Bridge MHD NBIS]Item93BEnd if If ([Inspections]Item 93b#!00/00/00!)PushChange (1;->[Inspections]Item 93b)End if End if INSP_SetUpButtons SET ENTERABLE(*;"DE Clr@";((CBClrPost=0)))If (CBClrPost=0)SET COLOR(*;"DE Clr@";◊Color_Editable)Else SET COLOR(*;"DE Clr@";◊Color_Not_Editable)End if   `ASL 7-8-2003  `Alert user to differences in dependent dataCheckDependencies   `Re-do Check boxes if weight posting changed.If ([Inspections]WeightPosting=True)CBWeightPos:=0Else CBWeightPos:=1End if SET ENTERABLE(*;"DE Wt@";((CBWeightPos=0)))If (CBWeightPos=0)SET COLOR(*;"DE Wt@";◊Color_Editable)Else SET COLOR(*;"DE Wt@";◊Color_Not_Editable)End if G_ReplyBtnCfg G_Insp_InitPontis End if   `If Inspection locked.G_Insp_SetPersUI : ((Form event=On Close Detail ) | (Form event=On Clicked ))Case of : (vTabRoutingPages{Current form page}="Element@")  `on elementssafety pageG_Insp_ElmtArray_setup vInspTitle:=G_Insp_SetTitle G_Insp_FormatInpTitle If (Position("Special";vInspTitle)>0)SET VISIBLE(*;"@Initial";True)Else SET VISIBLE(*;"@Initial";False)End if : (vTabRoutingPages{Current form page}="Pontis")  `Pontis pageIf (Form event=On Close Detail )INSP_PontisCTRL ("CLOSEDETAIL")End if End case : (Form event=On Unload )End case 