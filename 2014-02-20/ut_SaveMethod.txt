ÊÊ`----------------------------------------------------ÊÊ`User name (OS): Charles MillerÊÊ`Date and time: 11/21/11, 14:44:10ÊÊ`----------------------------------------------------ÊÊ`Method: ut_SaveMethodÊÊ`DescriptionÊÊ`ÊÊ` ParametersÊÊ` ----------------------------------------------------If (False)ÊÊ` Modified by: Costas Manousakis-(Designer)-(2/19/14 16:52:11)Mods_2014_02_bug ÊÊ`ÊÊ`added check if vars are definedEnd if C_TEXT($methodName;$1;$DirectorySymbol_txt)C_TEXT($text;$structurePath_txt)C_TIME($vDocRef)If (Type(×SavedMethodFolder_txt)#Is Text )ALERT("Must Complete Startup!!  Method "+$1+" has not been saved to disk!")Else If (×SavedMethodFolder_txt="")$structurePath_txt:=Structure fileElse $structurePath_txt:=×SavedMethodFolder_txtEnd if C_LONGINT($Loop_l)If (×PL_DirectorySep_s="")C_LONGINT($Platform_l)PLATFORM PROPERTIES($Platform_l)C_TEXT($DirectorySymbol_txt)Case of : ($Platform_l=Windows )$DirectorySymbol_txt:="\\"Else $DirectorySymbol_txt:=":"End case Else $DirectorySymbol_txt:=×PL_DirectorySep_sEnd if $Loop_l:=Length($structurePath_txt)If (Position($DirectorySymbol_txt;$structurePath_txt)>0)Repeat $Loop_l:=$Loop_l-1Until ($structurePath_txt²$Loop_l³=$DirectorySymbol_txt)$structurePath_txt:=Substring($structurePath_txt;$Loop_l+1)End if $structurePath_txt:=Replace string($structurePath_txt;".4db";"")$structurePath_txt:=Replace string($structurePath_txt;" ";"_")$structurePath_txt:=ut_ReturnUserDocFolder ($structurePath_txt)If (Test path name($structurePath_txt)=Is a directory )Else CREATE FOLDER($structurePath_txt)End if $structurePath_txt:=$structurePath_txt+"Changed_Methods"If (Test path name($structurePath_txt)=Is a directory )Else CREATE FOLDER($structurePath_txt)End if C_TEXT($TimeStamp_txt)$TimeStamp_txt:=Substring(ut_ReturnTimeStampFromDate (Current date);1;8)$TimeStamp_txt:=Substring($TimeStamp_txt;1;4)+"-"+Substring($TimeStamp_txt;5;2)+"-"+Substring($TimeStamp_txt;7;2)$structurePath_txt:=$structurePath_txt+×PL_DirectorySep_s+$TimeStamp_txtÊÊ`String(Year of(Current date);"0000")+String(Month of(Current date);"00")+String(Day of(Current date);"00")If (Test path name($structurePath_txt)=Is a directory )Else CREATE FOLDER($structurePath_txt)End if $methodName:=$1GET MACRO PARAMETER(Full method text ;$text)$methodName:=Replace string($methodName;"Object Method: ";"")$methodName:=Replace string($methodName;":";"-")$methodName:=Replace string($methodName;" ";"-")$methodName:=Replace string($methodName;".";"_")$structurePath_txt:=$structurePath_txt+×PL_DirectorySep_s+$methodName+".txt"$vDocRef:=Create document($structurePath_txt)If (OK=1)SEND PACKET($vDocRef;$text)CLOSE DOCUMENT($vDocRef)End if End if ÊÊ`End ut_SaveMethod