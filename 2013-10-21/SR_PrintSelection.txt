If (False)ÊÊ` ----------------------------------------------------ÊÊ` User name (OS): costasmanousakisÊÊ` User name (4D): DesignerÊÊ` Date and time: 12/23/09, 09:25:24ÊÊ` ----------------------------------------------------ÊÊ` Method: SR_PrintSelectionÊÊ` DescriptionÊÊ` ÊÊ` ÊÊ` ParametersDIALOG([Status Report];"P_StatusReport_MDOT_5D")DIALOG([Status Report];"P_StatusReport_HI")DIALOG([Status Report];"P_StatusReport_MDOT")ÊÊ` ----------------------------------------------------Mods_2009_12 ÊÊ` Modified by: costasmanousakis-(Designer)-(3/7/11 18:05:33)Mods_2011_03 ÊÊ`ÊÊ`use method STATREP_DefaultPrintFormEnd if C_INTEGER($i)C_LONGINT($Recs;$RecsHiLighted;$RecsToPrint)C_TEXT($text)$Recs:=Records in selection([Status Report])$RecsHiLighted:=Records in set("UserSet")If ($RecsHiLighted>0)$RecsToPrint:=$RecsHiLightedElse $RecsToPrint:=$RecsEnd if If ($RecsToPrint>0)If ($RecsToPrint>10)$text:="Do you really want to print "+String($RecsToPrint)+" Bridge Status Reports?"CONFIRM($text)End if If (Ok=1)C_STRING(40;$printform)$printform:="P_StatusReport_HI"If (×CurrentUser_Name="Designer")CONFIRM("choose form";"NEW";"OLD")If (OK=1)$printform:="P_StatusReport_HI"End if End if C_BOOLEAN($printRec_b)PAGE SETUP([Status Report];$printform)READ ONLY([Status Report])PRINT SETTINGSFIRST RECORD([Status Report])For ($i;1;$Recs)ÊÊ`PrepStatusRep ` removed this call - is called in form method$printRec_b:=TrueIf ($RecsHiLighted>0)If (Is in set("UserSet"))Else $printRec_b:=FalseEnd if End if If ($printRec_b)$printform:=STATREP_DefaultPrintForm (STATREP_ReportType ;[Status Report]Date_Created)Print form([Status Report];$printform)If ($i<$Recs)PAGE BREAK(>)End if End if NEXT RECORD([Status Report])End for PAGE BREAKREAD WRITE([Status Report])End if Else BEEPALERT("No records have been selected!")End if 