If (False)  `GP: M_PrintRecords  `Copyright © 1995-1996,  Albert S. Leung, All Rights Reserved.  `Prints SIA's for current selection  ` Modified by: costasmanousakis-(Designer)-(1/18/11 16:27:12)Mods_2011_01   ``RR  ` Modified by: costasmanousakis-(Designer)-(5/13/11 15:47:44)Mods_2011_05   `  `Made dialog window movable dialog box. (avoid problems in v11)  ` Modified by: Costas Manousakis-(Designer)-(5/17/13 16:39:49)Mods_2013_05   `  `added redraw window  `  `check to see if there are only rail over or tunnel bridges in the list and avoid showing the form selection dialog  `  `Added tunnel SIA  ` Modified by: manousakisc (10/21/2013)Mods_2013_10   `  `Added call to G_PrintOptionsEnd if C_INTEGER($i)C_LONGINT($Recs)C_TEXT($text)$Recs:=Records in selection([Bridge MHD NBIS])If ($Recs>0)C_LONGINT($RegBridgeRecs_L)SET QUERY DESTINATION(Into variable ;$RegBridgeRecs_L)QUERY SELECTION([Bridge MHD NBIS];[Bridge MHD NBIS]Item8 BridgeCat#"@RO";*)QUERY SELECTION([Bridge MHD NBIS]; & ;[Bridge MHD NBIS]Item8 BridgeCat#"TNL";*)QUERY SELECTION([Bridge MHD NBIS];[Bridge MHD NBIS]Item8 BridgeCat#"BTS")SET QUERY DESTINATION(Into current selection )If ($RegBridgeRecs_L>0)CENTER_WINDOW (250;200;Movable dialog box )DIALOG([Dialogs];"PrBridgeSel")CLOSE WINDOWEnd if If ((Ok=1) & ($Recs>10))$text:="Do you really want to print SI&A's for "+String($Recs;"###,##0")+"  bridges?"CONFIRM($text)End if If (Ok=1)G_PrintOptions If (◊ShowPrint)PRINT SETTINGSEnd if If (OK=1)FIRST RECORD([Bridge MHD NBIS])For ($i;1;$Recs)Case of : ([Bridge MHD NBIS]Item8 BridgeCat="@RO")READ ONLY([RAILBridgeInfo])QUERY([RAILBridgeInfo];[RAILBridgeInfo]BIN=[Bridge MHD NBIS]BIN)Print form([Bridge MHD NBIS];"RailTransitSIA"): (([Bridge MHD NBIS]Item8 BridgeCat="TNL") | ([Bridge MHD NBIS]Item8 BridgeCat="BTS"))READ ONLY([TunnelInfo])QUERY([TunnelInfo];[TunnelInfo]BIN=[Bridge MHD NBIS]BIN)Print form([Bridge MHD NBIS];"TunnelSIA")Else If (CBSIANormal=1)If ([Bridge MHD NBIS]InspResp="MBTA")READ ONLY([RAILBridgeInfo])QUERY([RAILBridgeInfo];[RAILBridgeInfo]BIN=[Bridge MHD NBIS]BIN)Print form([Bridge MHD NBIS];"RailTransitSIA")Else Print form([Bridge MHD NBIS];"SI & A (Normal)")End if End if   `PAGE BREAK(>)If (CBSIAInsp=1)If ([Bridge MHD NBIS]InspResp="MBTA")READ ONLY([RAILBridgeInfo])QUERY([RAILBridgeInfo];[RAILBridgeInfo]BIN=[Bridge MHD NBIS]BIN)Print form([Bridge MHD NBIS];"RailTransitSIA")Else Print form([Bridge MHD NBIS];"SI & A (Insp)")End if End if If (CBSIAMA=1)Print form([Bridge MHD NBIS];"MHD Specific Items")End if End case NEXT RECORD([Bridge MHD NBIS])End for PAGE BREAKEnd if   `if OK from print settings      End if   `if OK from DialogElse BEEPALERT("No records have been selected!")End if REDRAW WINDOW