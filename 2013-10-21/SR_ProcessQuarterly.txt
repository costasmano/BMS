  ` ----------------------------------------------------  ` SR_ProcessQuarterly  ` User name (OS): charlesmiller  ` Date and time: 11/24/09, 12:01:23  ` ----------------------------------------------------  ` Description  ` This method will process and print the report for all records passed in   `  ` Parameters  `$1 pointer to record number array  ` ----------------------------------------------------If (False)Mods_2009_11   ` r003 CJ Miller`11/24/09, 12:01:48     `Quarterly status reportMods_2009_12   ` r001 CJ Miller`12/10/09, 17:07:20     `Integrate new status reportMods_2009_12   ` r001 CJ Miller`12/17/09, 14:31:21        `Make changes to new status report  `Add Legacy status reportMods_2010_02   `r001 CJ Miller`02/11/10, 15:25:05      `Add new server processing of monthly reportsMods_2011_04   `r002 CJ Miller`04/12/11, 11:59:39      `Change from  `Get indexed string to substring of date;5 to get 3 character monthMods_2011_05   `r002 CJ Miller`05/20/11, 11:27:48       `Change directory where reports are stored to the users documents folderMods_2011_06   ` CJ Miller`06/14/11, 13:25:05      ` Type all local variables for v11End if C_POINTER($1;$RecordArray_aptr)$RecordArray_aptr:=$1vsDate:=String(Current date(*);7)C_LONGINT($Loop_l)C_TEXT($ReportToProcess_txt)REDUCE SELECTION([Status Report];0)C_BOOLEAN($Processreport_b)$Processreport_b:=TrueC_TEXT($LegacyFormName_txt;$DOTFormName_txt;$FormName_txt;$FileName_txt)$LegacyFormName_txt:="LegacyStatusReport"$DOTFormName_txt:="QuarterlyStatusReport"C_BOOLEAN($PrintRecord_b)For ($Loop_l;1;Size of array($RecordArray_aptr->))$PrintRecord_b:=TrueCompiler_SR GOTO RECORD([Status Report];$RecordArray_aptr->{$Loop_l})Case of : (Position("Legacy";[Status Report]Comments)>0)$FormName_txt:=$LegacyFormName_txt$FileName_txt:="Quarterly Status (MHD)_": (Position("Report";[Status Report]Comments)>0)$FormName_txt:=$DOTFormName_txt$FileName_txt:="Quarterly Status_"Else $PrintRecord_b:=FalseEnd case If ($PrintRecord_b)SRQ_SetUpPrint ($FormName_txt)SET PRINT OPTION(Orientation option ;2)If (Application type=4D Server )C_TEXT($FileName_txt;$Date_txt;$Path_txt;$ReportMonth_txt)$ReportMonth_txt:=Substring(String([Status Report]Date_Created;Internal date long );1;3)$Path_txt:=ut_ReturnUserDocFolder ("Monthly_Reports")GOTO RECORD([Status Report];$RecordArray_aptr->{1})$Date_txt:=String(Day of([Status Report]Date_Created);"00")+"-"+$ReportMonth_txt+"-"+String(Year of([Status Report]Date_Created))$FileName_txt:=$FileName_txt+$Date_txt+"_"+String($Loop_l)$FileName_txt:=$Path_txt+$FileName_txt+".pdf"  `TRACESET PRINT OPTION(Destination option ;3;$FileName_txt)Print form([Status Report];$FormName_txt)PAGE BREAKAPPEND TO ARRAY(MAILAttachments_atxt;$FileName_txt)Else If ($Loop_l=1)PRINT SETTINGSEnd if Print form([Status Report];$FormName_txt)If ($Loop_l<Size of array($RecordArray_aptr->))PAGE BREAK(>)End if End if End if End for If (Application type#4D Server )PAGE BREAKEnd if UNLOAD RECORD([Status Report])  `End SR_ProcessQuarterly