If (False)ÊÊ`procedure: [Dialogs];"InspectConfig"ÊÊ`by: Albert LeungÊÊ`created: 5/9/2001ÊÊ`modified:ÊÊ`purpose: initialize radio button stateÊÊ`Copyright © 1995-2001,  Albert S. Leung, All Rights Reserved.Mods_2005_CM12 Mods_2005_VN01 ÊÊ` Modified by: costasmanousakis-(Designer)-(1/2/08 10:40:07)Mods_2007_CM_5401 ÊÊ`ÊÊ`Added MTA usersÊÊ` Modified by: costasmanousakis-(Designer)-(2/16/09 11:41:50)Mods_2009_CM_5404 ÊÊ` --- "FREEZETHAW"ÊÊÊ` Modified by: costasmanousakis-(Designer)-(3/19/09 23:08:15)Mods_2009_CM_5404 ÊÊ`Copied to Server on : 03/20/09, 08:31:54ÊÊ`("FREEZETHAW - bug fix")ÊÊ`modified fvariable names and objec names and resizable of form propertiesÊÊ`made form fixed sizeÊÊ` Modified by: costasmanousakis-(Designer)-(4/13/09 10:28:18)Mods_2009_04 ÊÊ`Allow consultant inspectors to created Freeze Thaw inspectionsÊÊ` Modified by: costasmanousakis-(Designer)-(4/8/10 15:52:58)Mods_2010_04 ÊÊ`ÊÊ`Converted the filter for District inspectors to MHDInspectors group.ÊÊ` Modified by: costasmanousakis-(Designer)-(1/19/11 09:01:50)Mods_2011_01 ÊÊ`RRÊÊ` Modified by: costasmanousakis-(Designer)-(9/6/11 14:05:26)Mods_2011_09 ÊÊ`ÊÊ`Added  "OTHER" inspection to the dive groupÊÊ` Modified by: Costas Manousakis-(Designer)-(5/9/12 16:00:52)Mods_2012_05 ÊÊ`ÊÊ`Added "UWFloodBtn"ÊÊ` Modified by: Costas Manousakis-(Designer)-(6/8/12 13:20:05)Mods_2012_06 ÊÊ`ÊÊ`Changed title of  "UWFloodBtn" to "UW Divers Activity"ÊÊ` Modified by: Costas Manousakis-(Designer)-(11/2/12 19:07:32)Mods_2012_11 ÊÊ`ÊÊ`Added page 2 for new method of setting the insp type - test ibkt for Design usersÊÊ` Modified by: Costas Manousakis-(Designer)-(12/26/12 11:39:57)Mods_2012_12 ÊÊ`ÊÊ`More mods for the use of Page 2 both in On Load and On Clicked eventsÊÊ` Modified by: Costas Manousakis-(Designer)-(12/28/12 15:44:24)Mods_2012_12 ÊÊ`ÊÊ`Added separators between the different  categories of inspection typesÊÊ` Modified by: Costas Manousakis-(Designer)-(1/8/13 11:21:02)Mods_2013_01 ÊÊ`ÊÊ`Changed behavior so that default page is page 2 : Changed WindowSize property of dialog to "NoConstraints"; Automatic size based on obj TitleLabel;ÊÊ`ÊÊ`Added code in form method to adjust window and buttons when using Page 1 of the form.ÊÊ` Modified by: Costas Manousakis-(Designer)-(4/10/13 16:55:59)Mods_2013_04 ÊÊ`ÊÊ`Added code to consider Tunnel inspectionsÊÊ` Modified by: Costas Manousakis-(Designer)-(10/21/13 16:28:58)Mods_2013_10 ÊÊ`ÊÊ`Include BLD bridge cat to tunnel type inspectionsÊÊ` Modified by: Costas Manousakis-(Designer)-(10/30/13 )Mods_2013_10 ÊÊ`ÊÊ`Use new method (page 2) for all usersEnd if Case of : (Form event=On Load )C_TEXT($CurrUser_txt)$CurrUser_txt:=×CurrentUser_NameÊÊ`Disable all buttons to startDISABLE BUTTON(*;"@Btn")If (User in group($CurrUser_txt;"DiveGroup"))ENABLE BUTTON(*;"UnderWaterBtn")ENABLE BUTTON(*;"UWLowClrBtn")ENABLE BUTTON(*;"UWSpecMemberBtn")ENABLE BUTTON(*;"FreezeThawBtn")ENABLE BUTTON(*;"OtherMemBtn")ENABLE BUTTON(*;"UWFloodBtn")End if C_BOOLEAN($DistrictUser_b)$DistrictUser_b:=User in group($CurrUser_txt;"MHDInspectors")If ($DistrictUser_b)ENABLE BUTTON(*;"RoutineBtn")ENABLE BUTTON(*;"RoutineArchBtn")ENABLE BUTTON(*;"CulvertBtn")ENABLE BUTTON(*;"FracCritBtn")ENABLE BUTTON(*;"SpecMemBtn")ENABLE BUTTON(*;"OtherMemBtn")ENABLE BUTTON(*;"ClosedBtn")ENABLE BUTTON(*;"DamageBtn")ENABLE BUTTON(*;"FreezeThawBtn")End if If (User in group($CurrUser_txt;"ExternalInspectors"))ENABLE BUTTON(*;"RoutineBtn")ENABLE BUTTON(*;"RoutineArchBtn")ENABLE BUTTON(*;"CulvertBtn")ENABLE BUTTON(*;"FracCritBtn")ENABLE BUTTON(*;"SpecMemBtn")ENABLE BUTTON(*;"OtherMemBtn")ENABLE BUTTON(*;"ClosedBtn")ENABLE BUTTON(*;"DamageBtn")ENABLE BUTTON(*;"FreezeThawBtn")End if If (User in group($CurrUser_txt;"MDC"))ENABLE BUTTON(*;"RoutineBtn")ENABLE BUTTON(*;"RoutineArchBtn")ENABLE BUTTON(*;"CulvertBtn")ENABLE BUTTON(*;"FracCritBtn")ENABLE BUTTON(*;"SpecMemBtn")ENABLE BUTTON(*;"OtherMemBtn")ENABLE BUTTON(*;"ClosedBtn")ENABLE BUTTON(*;"DamageBtn")ENABLE BUTTON(*;"FreezeThawBtn")End if If (User in group($CurrUser_txt;"MTA"))ENABLE BUTTON(*;"RoutineBtn")ENABLE BUTTON(*;"RoutineArchBtn")ENABLE BUTTON(*;"CulvertBtn")ENABLE BUTTON(*;"FracCritBtn")ENABLE BUTTON(*;"SpecMemBtn")ENABLE BUTTON(*;"OtherMemBtn")ENABLE BUTTON(*;"ClosedBtn")ENABLE BUTTON(*;"DamageBtn")ENABLE BUTTON(*;"FreezeThawBtn")End if If ([Bridge MHD NBIS]Item8 BridgeCat="@RO")SET VISIBLE(*;"RoutineArchBtn";False)SET VISIBLE(*;"FracCritBtn";False)SET VISIBLE(*;"SpecMemBtn";False)SET VISIBLE(*;"CulvertBtn";False)SET VISIBLE(*;"ClosedBtn";False)SET VISIBLE(*;"DamageBtn";False)SET VISIBLE(*;"OtherMemBtn";False)SET VISIBLE(*;"FreezeThawBtn";False)SET VISIBLE(*;"UnderWaterBtn";False)SET VISIBLE(*;"UWLowClrBtn";False)SET VISIBLE(*;"UWSpecMemberBtn";False)SET VISIBLE(*;"UWFloodBtn";False)End if If ($CurrUser_txt="Designer")ÊÊ`This for testing purposes      ENABLE BUTTON(*;"@Btn")End if DISABLE BUTTON(*;"bSelectType")ARRAY TEXT($objNames_atxt;0)ARRAY POINTER($object_aptr;0)GET FORM OBJECTS($objNames_atxt;$object_aptr)C_LONGINT($loop_L)For ($loop_L;1;Size of array($objNames_atxt))If ($objNames_atxt{$loop_L}="@btn")$object_aptr{$loop_L}->:=0End if End for C_BOOLEAN($doNew_b)$doNew_b:=TrueIf ($doNew_b)READ ONLY([Inspection Type])C_TEXT($TypeList_txt)C_STRING(1;$itm42a_s)C_STRING(3;$itm8C_s)$itm42a_s:=Substring([Bridge MHD NBIS]Item42;1;1)$itm8C_s:=[Bridge MHD NBIS]Item8 BridgeCatC_BOOLEAN($itm42aNum_b;$addHWY_b;$addPed_b;$addRail_b;$addUW_b;$addTnl_b;$AboveWater_b;$UnderWater_b)$itm42aNum_b:=bIsNumeric ($itm42a_s)$addHWY_b:=False$addPed_b:=False$addRail_b:=False$addUW_b:=False$addTnl_b:=False$AboveWater_b:=$DistrictUser_bÊ|ÊUser in group($CurrUser_txt;"ExternalInspectors")$AboveWater_b:=$AboveWater_bÊ|ÊUser in group($CurrUser_txt;"MDC")$AboveWater_b:=$AboveWater_bÊ|ÊUser in group($CurrUser_txt;"MTA")$AboveWater_b:=$AboveWater_bÊ|ÊUser in group($CurrUser_txt;"MBTA")$AboveWater_b:=$AboveWater_bÊ|ÊUser in group($CurrUser_txt;"Design Access Group")$UnderWater_b:=User in group(Current user;"Design Access Group")Ê|ÊUser in group($CurrUser_txt;"DiveGroup")$addUW_b:=$UnderWater_bIf ($AboveWater_b)If (Not($itm42aNum_b))ÊÊ`Add All - higway,$addHWY_b:=True$addPed_b:=True$addRail_b:=TrueElse If (Position("-"+$itm42a_s+"-";"-1-5-6-7-8-9-0-")>0)$addHWY_b:=TrueEnd if If (Position("-"+$itm42a_s+"-";"-3-0-")>0)$addPed_b:=TrueEnd if If (Position("-"+$itm42a_s+"-";"-2-4-0-")>0)$addRail_b:=TrueEnd if End if If (Position("-"+$itm8C_s+"-";"-TNL-BTS-XXX-BLD-")>0)$addTnl_b:=TrueElse If (Position("-"+$itm8C_s+"-";"-634-BLD-BRI-BTS-CLO-CLP-CUL-NBI-NBP-TMP-UTL-TNL-XXX-")>0)$addHWY_b:=TrueEnd if If (Position("-"+$itm8C_s+"-";"-PED-BKY-CLP-XXX-")>0)$addPed_b:=TrueEnd if If (Position("-"+$itm8C_s+"-";"-TRO-RRO-XXX-")>0)$addRail_b:=TrueEnd if End if End if Case of : ([Bridge MHD NBIS]InspResp="MBTA")$TypeList_txt:=INSP_InspTypesUtil ("LOADTYPES";[Bridge MHD NBIS]InspResp)Else $TypeList_txt:=INSP_InspTypesUtil ("LOADTYPES")End case ARRAY TEXT(INSP_SelType_atxt;0)ARRAY TEXT(INSP_SelTypeCode_atxt;0)INSP_InspTypesUtil ("LOADFROMDATA")ÊÊ`ÊÊ`INSP_Inspection_list_txt : defines whether we are in a Bridge or Tunnel inspection buttonCase of : (INSP_Inspection_list_txt="BRIDGE")If ($addHWY_b)$TypeList_txt:=INSP_InspTypesUtil ("LOADTYPES";"HWY")ut_TextToArray ($TypeList_txt;->INSP_SelTypeCode_atxt;";")End if If ($addPed_b)$TypeList_txt:=INSP_InspTypesUtil ("LOADTYPES";"PED")If (Size of array(INSP_SelTypeCode_atxt)>0)APPEND TO ARRAY(INSP_SelTypeCode_atxt;"")End if ut_TextToArray ($TypeList_txt;->INSP_SelTypeCode_atxt;";")End if If ($addRail_b)$TypeList_txt:=INSP_InspTypesUtil ("LOADTYPES";"RAIL")If (Size of array(INSP_SelTypeCode_atxt)>0)APPEND TO ARRAY(INSP_SelTypeCode_atxt;"")End if ut_TextToArray ($TypeList_txt;->INSP_SelTypeCode_atxt;";")End if If ($addUW_b)$TypeList_txt:=INSP_InspTypesUtil ("LOADTYPES";"UW")If (Size of array(INSP_SelTypeCode_atxt)>0)APPEND TO ARRAY(INSP_SelTypeCode_atxt;"")End if ut_TextToArray ($TypeList_txt;->INSP_SelTypeCode_atxt;";")End if : (INSP_Inspection_list_txt="TUNNEL")If ($addTnl_b)$TypeList_txt:=INSP_InspTypesUtil ("LOADTYPES";"TNL")If (Size of array(INSP_SelTypeCode_atxt)>0)APPEND TO ARRAY(INSP_SelTypeCode_atxt;"")End if ut_TextToArray ($TypeList_txt;->INSP_SelTypeCode_atxt;";")End if End case C_LONGINT($loop_L)For ($loop_L;Size of array(INSP_SelTypeCode_atxt);1;-1)If (INSP_SelTypeCode_atxt{$loop_L}#"")If (Find in array(INSP_SelTypeCode_atxt;INSP_SelTypeCode_atxt{$loop_L})<$loop_L)DELETE FROM ARRAY(INSP_SelTypeCode_atxt;$loop_L;1)End if End if End for For ($loop_L;1;Size of array(INSP_SelTypeCode_atxt))QUERY([Inspection Type];[Inspection Type]Code=INSP_SelTypeCode_atxt{$loop_L})If (Records in selection([Inspection Type])=1)APPEND TO ARRAY(INSP_SelType_atxt;[Inspection Type]Description)Else If (INSP_SelTypeCode_atxt{$loop_L}#"")APPEND TO ARRAY(INSP_SelType_atxt;INSP_SelTypeCode_atxt{$loop_L})Else APPEND TO ARRAY(INSP_SelType_atxt;"----")End if End if End for APPEND TO ARRAY(INSP_SelType_atxt;".. Clear Selection ..")APPEND TO ARRAY(INSP_SelTypeCode_atxt;"")C_TEXT(INSP_SelectedNewInspType_txt)INSP_SelectedNewInspType_txt:=""INSP_SelType_atxt:=0INSP_SelTypeCode_atxt:=0GOTO PAGE(2)Else C_LONGINT($OL;$OT;$OR;$OB;$NewPos)GET OBJECT RECT(*;"RadioGroup";$OL;$OT;$OR;$OB)$NewPos:=$OB+25GET OBJECT RECT(*;"bSelectType";$OL;$OT;$OR;$OB)MOVE OBJECT(*;"bSelectType";0;($NewPos-$OT))MOVE OBJECT(*;"Cancel button";0;($NewPos-$OT))GET OBJECT RECT(*;"Cancel button";$OL;$OT;$OR;$OB)$NewPos:=$OB+20GET WINDOW RECT($OL;$OT;$OR;$OB)SET WINDOW RECT($OL;$OT;$OR;($OT+$NewPos))End if : (Form event=On Clicked )ARRAY TEXT($objNames_atxt;0)ARRAY POINTER($object_aptr;0)GET FORM OBJECTS($objNames_atxt;$object_aptr)C_LONGINT($check_L)$check_L:=0C_LONGINT($loop_L)For ($loop_L;1;Size of array($objNames_atxt))If ($objNames_atxt{$loop_L}="@btn")$check_L:=$check_L+$object_aptr{$loop_L}->End if End for If ($check_L>0)ENABLE BUTTON(*;"bSelectType")End if End case 